[0m14:56:13.035395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb01a435e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb0296f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb0296fa30>]}


============================== 14:56:13.041198 | 3424eda6-b4d2-4635-81c1-303597a496b3 ==============================
[0m14:56:13.041198 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:56:13.045555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:56:13.063851 [info ] [MainThread]: dbt version: 1.9.1
[0m14:56:13.067826 [info ] [MainThread]: python version: 3.10.6
[0m14:56:13.071177 [info ] [MainThread]: python path: /root/.pyenv/versions/3.10.6/envs/home-exchange/bin/python
[0m14:56:13.072500 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m14:56:15.272619 [info ] [MainThread]: Using profiles dir at /root/home_exchange/home_exchange
[0m14:56:15.274811 [info ] [MainThread]: Using profiles.yml file at /root/home_exchange/home_exchange/profiles.yml
[0m14:56:15.281592 [info ] [MainThread]: Using dbt_project.yml file at /root/home_exchange/home_exchange/dbt_project.yml
[0m14:56:15.283695 [info ] [MainThread]: adapter type: bigquery
[0m14:56:15.284983 [info ] [MainThread]: adapter version: 1.9.1
[0m14:56:15.807647 [info ] [MainThread]: Configuration:
[0m14:56:15.816048 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:56:15.831608 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:56:15.834052 [info ] [MainThread]: Required dependencies:
[0m14:56:15.836134 [debug] [MainThread]: Executing "git --help"
[0m14:56:15.841502 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:56:15.843522 [debug] [MainThread]: STDERR: "b''"
[0m14:56:15.845005 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:56:15.847001 [info ] [MainThread]: Connection:
[0m14:56:15.850946 [info ] [MainThread]:   method: service-account
[0m14:56:15.852370 [info ] [MainThread]:   database: mywagon-445720
[0m14:56:15.854462 [info ] [MainThread]:   execution_project: mywagon-445720
[0m14:56:15.857319 [info ] [MainThread]:   schema: home_exchange
[0m14:56:15.860137 [info ] [MainThread]:   location: EU
[0m14:56:15.863124 [info ] [MainThread]:   priority: interactive
[0m14:56:15.870514 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:56:15.872145 [info ] [MainThread]:   impersonate_service_account: None
[0m14:56:15.874181 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:56:15.875836 [info ] [MainThread]:   job_retries: 1
[0m14:56:15.877406 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:56:15.880122 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m14:56:15.881901 [info ] [MainThread]:   timeout_seconds: 300
[0m14:56:15.884619 [info ] [MainThread]:   client_id: None
[0m14:56:15.886217 [info ] [MainThread]:   token_uri: None
[0m14:56:15.888298 [info ] [MainThread]:   dataproc_region: None
[0m14:56:15.892848 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:56:15.894200 [info ] [MainThread]:   gcs_bucket: None
[0m14:56:15.895605 [info ] [MainThread]:   dataproc_batch: None
[0m14:56:15.898044 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:56:16.335885 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:56:16.336739 [debug] [MainThread]: On debug: select 1 as id
[0m14:56:16.337817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:20.492914 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:be8defc9-3e39-4826-9290-0918f7991715&page=queryresults
[0m14:56:20.894104 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:56:20.895302 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:56:20.900143 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 8.10572, "process_in_blocks": "0", "process_kernel_time": 0.472264, "process_mem_max_rss": "209644", "process_out_blocks": "24", "process_user_time": 8.343332}
[0m14:56:20.902493 [debug] [MainThread]: Command `dbt debug` succeeded at 14:56:20.901827 after 8.11 seconds
[0m14:56:20.904362 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:56:20.907772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb01a435e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffae6f434c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb0296d630>]}
[0m14:56:20.910331 [debug] [MainThread]: Flushing usage events
[0m14:56:21.514722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:54.013769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b51d7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b425ef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b425eec0>]}


============================== 14:56:54.032038 | 780fee3c-197c-4ca8-9c39-4dbdfd430e11 ==============================
[0m14:56:54.032038 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:56:54.034676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:57:15.646120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '780fee3c-197c-4ca8-9c39-4dbdfd430e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969a6a8820>]}
[0m14:57:15.910165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '780fee3c-197c-4ca8-9c39-4dbdfd430e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969a786b90>]}
[0m14:57:15.912914 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:57:20.483724 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:57:20.485604 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:57:20.487169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '780fee3c-197c-4ca8-9c39-4dbdfd430e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969a6a8af0>]}
[0m14:57:30.372493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '780fee3c-197c-4ca8-9c39-4dbdfd430e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96997a9a50>]}
[0m14:57:30.716750 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m14:57:30.722681 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m14:57:31.254770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '780fee3c-197c-4ca8-9c39-4dbdfd430e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969956a950>]}
[0m14:57:31.256410 [info ] [MainThread]: Found 2 models, 4 data tests, 489 macros
[0m14:57:31.270945 [info ] [MainThread]: 
[0m14:57:31.274203 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:57:31.283153 [info ] [MainThread]: 
[0m14:57:31.285772 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:57:31.310778 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m14:57:31.312722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:32.036113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m14:57:32.037355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:32.533092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780fee3c-197c-4ca8-9c39-4dbdfd430e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b4abab90>]}
[0m14:57:32.534484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:32.544233 [debug] [Thread-1 (]: Began running node model.home_exchange.my_first_dbt_model
[0m14:57:32.545579 [info ] [Thread-1 (]: 1 of 6 START sql table model home_exchange.my_first_dbt_model .................. [RUN]
[0m14:57:32.547358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.my_first_dbt_model)
[0m14:57:32.550317 [debug] [Thread-1 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m14:57:32.572059 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m14:57:32.574068 [debug] [Thread-1 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m14:57:32.692843 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m14:57:32.695074 [debug] [Thread-1 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "dev", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:57:32.696140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:33.962446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:5a2f02bd-1cd6-4bb9-8268-7302b1801968&page=queryresults
[0m14:57:36.864683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780fee3c-197c-4ca8-9c39-4dbdfd430e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969a7badd0>]}
[0m14:57:36.866691 [info ] [Thread-1 (]: 1 of 6 OK created sql table model home_exchange.my_first_dbt_model ............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.31s]
[0m14:57:36.869281 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m14:57:36.880719 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:57:36.882410 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m14:57:36.883844 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:57:36.892168 [info ] [Thread-1 (]: 3 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:57:36.894519 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:57:36.896235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m14:57:36.897667 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:57:36.900186 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m14:57:36.993426 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m14:57:36.995458 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:57:36.998776 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m14:57:37.000651 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:57:37.112943 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:57:37.110091 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m14:57:37.115848 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "dev", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:57:37.116988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:37.126099 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "dev", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m14:57:37.189734 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:57:38.074394 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:f7382ab5-22ad-44f5-a35b-577b9705f6a3&page=queryresults
[0m14:57:38.176050 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:7fcf8098-76ea-4122-831d-b31a1aa8e659&page=queryresults
[0m14:57:38.563738 [error] [Thread-2 (]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.67s]
[0m14:57:38.570978 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:57:38.573740 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m14:57:38.638012 [info ] [Thread-1 (]: 3 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.74s]
[0m14:57:38.640772 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m14:57:38.644716 [debug] [Thread-2 (]: Began running node model.home_exchange.my_second_dbt_model
[0m14:57:38.646307 [info ] [Thread-2 (]: 4 of 6 SKIP relation home_exchange.my_second_dbt_model ......................... [[33mSKIP[0m]
[0m14:57:38.648506 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m14:57:38.651096 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m14:57:38.654682 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m14:57:38.656613 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m14:57:38.658632 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m14:57:38.660908 [info ] [Thread-2 (]: 6 of 6 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m14:57:38.662758 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m14:57:38.664804 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m14:57:38.666041 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m14:57:38.668803 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m14:57:38.674416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:38.679654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:38.681602 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:57:38.685239 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:57:38.689719 [info ] [MainThread]: 
[0m14:57:38.691636 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 view model in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m14:57:38.696676 [debug] [MainThread]: Command end result
[0m14:57:38.965819 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m14:57:38.972920 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m14:57:38.996672 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m14:57:38.997648 [info ] [MainThread]: 
[0m14:57:38.999791 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:57:39.002393 [info ] [MainThread]: 
[0m14:57:39.005579 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:57:39.007794 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:57:39.009733 [info ] [MainThread]: 
[0m14:57:39.011264 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:57:39.012947 [info ] [MainThread]: 
[0m14:57:39.014262 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 TOTAL=6
[0m14:57:39.020057 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 45.46287, "process_in_blocks": "0", "process_kernel_time": 2.682357, "process_mem_max_rss": "251020", "process_out_blocks": "3648", "process_user_time": 41.634014}
[0m14:57:39.021448 [debug] [MainThread]: Command `dbt build` failed at 14:57:39.021025 after 45.47 seconds
[0m14:57:39.023091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b51d7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b513c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969956aa10>]}
[0m14:57:39.024479 [debug] [MainThread]: Flushing usage events
[0m14:57:39.551615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:55.488447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8689b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d868373a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d85922da0>]}


============================== 15:18:55.492633 | 9fabb93c-d11b-4c48-a1a3-c11306ba7845 ==============================
[0m15:18:55.492633 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:18:55.493806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/home_exchange/home_exchange', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:18:55.769961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fabb93c-d11b-4c48-a1a3-c11306ba7845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8591b8b0>]}
[0m15:18:55.807166 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:18:55.809321 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:18:55.817687 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4391227, "process_in_blocks": "96", "process_kernel_time": 0.149376, "process_mem_max_rss": "89836", "process_out_blocks": "16", "process_user_time": 3.403657}
[0m15:18:55.819657 [debug] [MainThread]: Command `cli deps` succeeded at 15:18:55.819285 after 0.44 seconds
[0m15:18:55.821265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8689b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8591b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d8591ad70>]}
[0m15:18:55.823247 [debug] [MainThread]: Flushing usage events
[0m15:18:56.443128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:17.676760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3f3136d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e39ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e39ae00>]}


============================== 15:19:17.681776 | 38a0871f-7277-45cd-8dd7-ac2dec35f3af ==============================
[0m15:19:17.681776 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:19:17.683134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:17.706573 [info ] [MainThread]: dbt version: 1.9.0
[0m15:19:17.707523 [info ] [MainThread]: python version: 3.10.6
[0m15:19:17.708471 [info ] [MainThread]: python path: /root/.pyenv/versions/3.10.6/bin/python
[0m15:19:17.710439 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:19:19.288312 [info ] [MainThread]: Using profiles dir at /root/home_exchange/home_exchange
[0m15:19:19.289629 [info ] [MainThread]: Using profiles.yml file at /root/home_exchange/home_exchange/profiles.yml
[0m15:19:19.290625 [info ] [MainThread]: Using dbt_project.yml file at /root/home_exchange/home_exchange/dbt_project.yml
[0m15:19:19.292792 [info ] [MainThread]: adapter type: bigquery
[0m15:19:19.295250 [info ] [MainThread]: adapter version: 1.9.1
[0m15:19:19.555865 [info ] [MainThread]: Configuration:
[0m15:19:19.556957 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:19:19.559768 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:19:19.565020 [info ] [MainThread]: Required dependencies:
[0m15:19:19.567982 [debug] [MainThread]: Executing "git --help"
[0m15:19:19.579807 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:19:19.581828 [debug] [MainThread]: STDERR: "b''"
[0m15:19:19.583210 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:19:19.584911 [info ] [MainThread]: Connection:
[0m15:19:19.587454 [info ] [MainThread]:   method: service-account
[0m15:19:19.597706 [info ] [MainThread]:   database: mywagon-445720
[0m15:19:19.600580 [info ] [MainThread]:   execution_project: mywagon-445720
[0m15:19:19.602905 [info ] [MainThread]:   schema: home_exchange
[0m15:19:19.604691 [info ] [MainThread]:   location: EU
[0m15:19:19.611134 [info ] [MainThread]:   priority: interactive
[0m15:19:19.613657 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:19:19.615685 [info ] [MainThread]:   impersonate_service_account: None
[0m15:19:19.618482 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:19:19.620679 [info ] [MainThread]:   job_retries: 1
[0m15:19:19.628935 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:19:19.630645 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:19:19.632692 [info ] [MainThread]:   timeout_seconds: 300
[0m15:19:19.634109 [info ] [MainThread]:   client_id: None
[0m15:19:19.635810 [info ] [MainThread]:   token_uri: None
[0m15:19:19.637745 [info ] [MainThread]:   dataproc_region: None
[0m15:19:19.641728 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:19:19.650111 [info ] [MainThread]:   gcs_bucket: None
[0m15:19:19.652538 [info ] [MainThread]:   dataproc_batch: None
[0m15:19:19.655383 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:19:19.894391 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:19:19.895238 [debug] [MainThread]: On debug: select 1 as id
[0m15:19:19.896105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:19.899122 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 2] No such file or directory: './keyfile.json''
[0m15:19:19.900101 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m15:19:19.900803 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: './keyfile.json'
[0m15:19:19.901494 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:19:19.902355 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:19:19.903235 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:19:19.907491 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 2.3512094, "process_in_blocks": "0", "process_kernel_time": 0.277735, "process_mem_max_rss": "203568", "process_out_blocks": "16", "process_user_time": 4.999236}
[0m15:19:19.909967 [debug] [MainThread]: Command `cli debug` failed at 15:19:19.909261 after 2.35 seconds
[0m15:19:19.911920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3f3136d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e39add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2880a260>]}
[0m15:19:19.913453 [debug] [MainThread]: Flushing usage events
[0m15:19:20.428537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:44.229930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25ba75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c267d34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c267d2ce0>]}


============================== 15:39:44.233898 | 1fa4d4a1-4f62-4c9c-a9b3-5367c41b3496 ==============================
[0m15:39:44.233898 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:39:44.236596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:39:45.468728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fa4d4a1-4f62-4c9c-a9b3-5367c41b3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0adbfa90>]}
[0m15:39:45.630859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fa4d4a1-4f62-4c9c-a9b3-5367c41b3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2517ac80>]}
[0m15:39:45.633191 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:39:45.861895 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:39:46.136068 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:39:46.137421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fa4d4a1-4f62-4c9c-a9b3-5367c41b3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2517b7c0>]}
[0m15:39:48.647247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fa4d4a1-4f62-4c9c-a9b3-5367c41b3496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0a15caf0>]}
[0m15:39:48.656004 [info ] [MainThread]: Performance info: /root/home_exchange/home_exchange/target/perf_info.json
[0m15:39:48.866359 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m15:39:48.870754 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m15:39:48.872300 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 4.741409, "process_in_blocks": "344", "process_kernel_time": 0.240225, "process_mem_max_rss": "217144", "process_out_blocks": "2008", "process_user_time": 6.916493}
[0m15:39:48.873157 [debug] [MainThread]: Command `dbt parse` succeeded at 15:39:48.872955 after 4.74 seconds
[0m15:39:48.873890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25ba75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2517ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0a12c340>]}
[0m15:39:48.874653 [debug] [MainThread]: Flushing usage events
[0m15:39:49.455891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:13.045988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8281d3f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8281a081c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8280cbb160>]}


============================== 15:41:13.054546 | 2236c48d-2039-4599-b6a7-5798bca2db8b ==============================
[0m15:41:13.054546 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:41:13.056067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:41:14.424201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2236c48d-2039-4599-b6a7-5798bca2db8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82670ab580>]}
[0m15:41:14.551994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2236c48d-2039-4599-b6a7-5798bca2db8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8267052950>]}
[0m15:41:14.553193 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m15:41:14.858201 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:41:15.260840 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m15:41:15.262589 [debug] [MainThread]: Partial parsing: added file: home_exchange://models/base/base_bigquery_subscriptions.sql
[0m15:41:15.263410 [debug] [MainThread]: Partial parsing: added file: home_exchange://models/base/base_bigquery_exchanges.sql
[0m15:41:15.747002 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.home_exchange.base_bigquery_subscriptions' (models/base/base_bigquery_subscriptions.sql) depends on a source named 'bigquery.subscriptions' which was not found
[0m15:41:15.749439 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.8200972, "process_in_blocks": "0", "process_kernel_time": 0.378652, "process_mem_max_rss": "208996", "process_out_blocks": "16", "process_user_time": 5.629965}
[0m15:41:15.751160 [debug] [MainThread]: Command `cli build` failed at 15:41:15.750760 after 2.82 seconds
[0m15:41:15.752088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8281d3f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8266ae5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8266fd8f70>]}
[0m15:41:15.752964 [debug] [MainThread]: Flushing usage events
[0m15:41:16.398166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:34.722182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb3bdb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb301a800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb301a8f0>]}


============================== 16:41:34.726484 | b180e502-23c0-4117-9f4c-c2c79d60bf73 ==============================
[0m16:41:34.726484 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:41:34.728700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/home_exchange/home_exchange', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m16:41:36.046121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b180e502-23c0-4117-9f4c-c2c79d60bf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9d252ce0>]}
[0m16:41:36.163742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b180e502-23c0-4117-9f4c-c2c79d60bf73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9d239fc0>]}
[0m16:41:36.164886 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:41:36.388348 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:41:36.773523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:41:36.774805 [debug] [MainThread]: Partial parsing: updated file: home_exchange://models/example/test.sql
[0m16:41:37.142120 [error] [MainThread]: Encountered an error:
Compilation Error in model test (models/example/test.sql)
  source() takes exactly two arguments (1 given)
[0m16:41:37.144133 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.539642, "process_in_blocks": "0", "process_kernel_time": 0.251907, "process_mem_max_rss": "208548", "process_out_blocks": "8", "process_user_time": 4.735866}
[0m16:41:37.145651 [debug] [MainThread]: Command `dbt build` failed at 16:41:37.145137 after 2.54 seconds
[0m16:41:37.146520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffbb3bdb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9cf1c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9cbf7850>]}
[0m16:41:37.147673 [debug] [MainThread]: Flushing usage events
[0m16:41:37.780527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:10.211788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b2844f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b290ff1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b290ff160>]}


============================== 16:43:10.216519 | 01a10644-6f06-48ab-80b1-c94023a23c80 ==============================
[0m16:43:10.216519 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:43:10.218172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:43:11.403102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0d7c1630>]}
[0m16:43:11.517632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0d92d6c0>]}
[0m16:43:11.518740 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:43:11.742137 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:43:12.077719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:12.078447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:12.211067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0d294130>]}
[0m16:43:12.419391 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:43:12.424477 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:43:12.476344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0d2ae110>]}
[0m16:43:12.477387 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 489 macros
[0m16:43:12.484132 [info ] [MainThread]: 
[0m16:43:12.485098 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m16:43:12.486029 [info ] [MainThread]: 
[0m16:43:12.487300 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:43:12.495272 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m16:43:12.496376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:12.900421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m16:43:12.902020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:13.329037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0d7a2b00>]}
[0m16:43:13.332815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:13.347328 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m16:43:13.350075 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m16:43:13.352274 [info ] [Thread-1 (]: 1 of 9 START sql view model home_exchange.base_bigquery_exchanges .............. [RUN]
[0m16:43:13.356044 [info ] [Thread-2 (]: 2 of 9 START sql view model home_exchange.base_bigquery_subscriptions .......... [RUN]
[0m16:43:13.360232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m16:43:13.362121 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m16:43:13.363968 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m16:43:13.366580 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m16:43:13.420273 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m16:43:13.424999 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m16:43:13.426990 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m16:43:13.428165 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m16:43:13.542604 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m16:43:13.549206 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m16:43:13.556305 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m16:43:13.557535 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m16:43:13.558674 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:13.560581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:14.278213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:2ed64bdc-1f34-46a2-9c90-5586ab40318e&page=queryresults
[0m16:43:14.368971 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:b851239b-66df-4421-8c3a-500b8cc2030f&page=queryresults
[0m16:43:14.741181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b290b2b30>]}
[0m16:43:14.742875 [info ] [Thread-1 (]: 1 of 9 OK created sql view model home_exchange.base_bigquery_exchanges ......... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m16:43:14.746032 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m16:43:14.747716 [debug] [Thread-1 (]: Began running node model.home_exchange.my_first_dbt_model
[0m16:43:14.749571 [info ] [Thread-1 (]: 3 of 9 START sql table model home_exchange.my_first_dbt_model .................. [RUN]
[0m16:43:14.752199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.my_first_dbt_model)
[0m16:43:14.753810 [debug] [Thread-1 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m16:43:14.761448 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m16:43:14.765443 [debug] [Thread-1 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m16:43:14.791019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:14.846477 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c7e94b0>]}
[0m16:43:14.850199 [info ] [Thread-2 (]: 2 of 9 OK created sql view model home_exchange.base_bigquery_subscriptions ..... [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m16:43:14.853885 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m16:43:14.856679 [debug] [Thread-2 (]: Began running node model.home_exchange.test
[0m16:43:14.858367 [info ] [Thread-2 (]: 4 of 9 START sql table model home_exchange.test ................................ [RUN]
[0m16:43:14.860050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.test)
[0m16:43:14.861459 [debug] [Thread-2 (]: Began compiling node model.home_exchange.test
[0m16:43:14.874961 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.test"
[0m16:43:14.876943 [debug] [Thread-2 (]: Began executing node model.home_exchange.test
[0m16:43:14.937199 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.test"
[0m16:43:14.939782 [debug] [Thread-2 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:43:14.941802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:15.243086 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m16:43:15.245103 [debug] [Thread-1 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:43:15.659752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:f16cadb5-58f4-46ab-b894-63565e00df50&page=queryresults
[0m16:43:15.876325 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a3e4903e-5c79-428d-9e2a-7977e6470dd8&page=queryresults
[0m16:43:16.010449 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a3e4903e-5c79-428d-9e2a-7977e6470dd8&page=queryresults
[0m16:43:16.028844 [debug] [Thread-2 (]: Database Error in model test (models/example/test.sql)
  Unrecognized name: subscription_id; Did you mean subscription_date? at [31:12]
  compiled code at target/run/home_exchange/models/example/test.sql
[0m16:43:16.030208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c79d540>]}
[0m16:43:16.031607 [error] [Thread-2 (]: 4 of 9 ERROR creating sql table model home_exchange.test ....................... [[31mERROR[0m in 1.17s]
[0m16:43:16.034101 [debug] [Thread-2 (]: Finished running node model.home_exchange.test
[0m16:43:16.035357 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.test' to be skipped because of status 'error'.  Reason: Database Error in model test (models/example/test.sql)
  Unrecognized name: subscription_id; Did you mean subscription_date? at [31:12]
  compiled code at target/run/home_exchange/models/example/test.sql.
[0m16:43:18.169617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01a10644-6f06-48ab-80b1-c94023a23c80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0c8058d0>]}
[0m16:43:18.174325 [info ] [Thread-1 (]: 3 of 9 OK created sql table model home_exchange.my_first_dbt_model ............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.42s]
[0m16:43:18.181500 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m16:43:18.194985 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:18.200328 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:18.210348 [info ] [Thread-2 (]: 5 of 9 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:43:18.222673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:43:18.220113 [info ] [Thread-1 (]: 6 of 9 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:43:18.225110 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:18.227644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m16:43:18.240085 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:18.279207 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:43:18.277606 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m16:43:18.282197 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:18.283337 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:18.328805 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m16:43:18.338479 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:43:18.340028 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m16:43:18.341115 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:18.342207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:18.343345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:19.173140 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:3dccbb4d-dec4-49df-a967-21664edfd9fb&page=queryresults
[0m16:43:19.276729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:5feeb31d-909f-405d-8af7-37e7f7edb0b3&page=queryresults
[0m16:43:19.611190 [error] [Thread-2 (]: 5 of 9 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.39s]
[0m16:43:19.616675 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:19.627087 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m16:43:19.789375 [info ] [Thread-1 (]: 6 of 9 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.56s]
[0m16:43:19.794086 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:19.797952 [debug] [Thread-2 (]: Began running node model.home_exchange.my_second_dbt_model
[0m16:43:19.800446 [info ] [Thread-2 (]: 7 of 9 SKIP relation home_exchange.my_second_dbt_model ......................... [[33mSKIP[0m]
[0m16:43:19.802791 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m16:43:19.804470 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m16:43:19.810066 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:19.813876 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:19.814865 [info ] [Thread-1 (]: 8 of 9 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m16:43:19.816656 [info ] [Thread-2 (]: 9 of 9 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m16:43:19.818231 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:19.819298 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:19.820586 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m16:43:19.822153 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m16:43:19.826787 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:19.829611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:19.830332 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:43:19.831042 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m16:43:19.832197 [info ] [MainThread]: 
[0m16:43:19.833212 [info ] [MainThread]: Finished running 2 table models, 4 data tests, 3 view models in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m16:43:19.836489 [debug] [MainThread]: Command end result
[0m16:43:19.900299 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:43:19.903401 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:43:19.918217 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m16:43:19.919274 [info ] [MainThread]: 
[0m16:43:19.921511 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:43:19.923954 [info ] [MainThread]: 
[0m16:43:19.925370 [error] [MainThread]:   Database Error in model test (models/example/test.sql)
  Unrecognized name: subscription_id; Did you mean subscription_date? at [31:12]
  compiled code at target/run/home_exchange/models/example/test.sql
[0m16:43:19.926408 [info ] [MainThread]: 
[0m16:43:19.927877 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:43:19.929488 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:43:19.930418 [info ] [MainThread]: 
[0m16:43:19.931523 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:43:19.932441 [info ] [MainThread]: 
[0m16:43:19.933435 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=3 TOTAL=9
[0m16:43:19.935373 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 9.8498745, "process_in_blocks": "1784", "process_kernel_time": 0.313841, "process_mem_max_rss": "221436", "process_out_blocks": "2216", "process_user_time": 6.023731}
[0m16:43:19.937167 [debug] [MainThread]: Command `dbt build` failed at 16:43:19.936807 after 9.85 seconds
[0m16:43:19.938163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b2844f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0d2ac280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b0d2ad810>]}
[0m16:43:19.939392 [debug] [MainThread]: Flushing usage events
[0m16:43:20.508464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:40.699703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5d9f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f50e2800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f50e28f0>]}


============================== 16:43:40.704685 | 34715f4c-a3f6-43f5-816c-cd97cc75ecf3 ==============================
[0m16:43:40.704685 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:43:40.705960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'version_check': 'True', 'profiles_dir': '/root/home_exchange/home_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:43:41.913752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dafa9090>]}
[0m16:43:42.027415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5397eb0>]}
[0m16:43:42.028504 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:43:42.259797 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:43:42.592123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:42.592850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:42.703939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dac23eb0>]}
[0m16:43:42.907811 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:43:42.912306 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:43:42.956345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dac35480>]}
[0m16:43:42.957366 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 489 macros
[0m16:43:42.962904 [info ] [MainThread]: 
[0m16:43:42.964103 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m16:43:42.965827 [info ] [MainThread]: 
[0m16:43:42.967449 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:43:42.976812 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m16:43:42.978114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:43.408215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m16:43:43.409866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:43.799267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5394ca0>]}
[0m16:43:43.802976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:43.821357 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m16:43:43.824749 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m16:43:43.828106 [info ] [Thread-1 (]: 1 of 9 START sql view model home_exchange.base_bigquery_exchanges .............. [RUN]
[0m16:43:43.833328 [info ] [Thread-2 (]: 2 of 9 START sql view model home_exchange.base_bigquery_subscriptions .......... [RUN]
[0m16:43:43.836432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m16:43:43.838636 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m16:43:43.840488 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m16:43:43.842210 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m16:43:43.908051 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m16:43:43.913195 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m16:43:43.915331 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m16:43:43.916792 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m16:43:44.035268 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m16:43:44.032211 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m16:43:44.038086 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m16:43:44.039447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.040560 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m16:43:44.082903 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:44.755510 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:51fb7af2-821a-45ed-a97a-006c7952f2f4&page=queryresults
[0m16:43:44.770873 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:33f0666d-1ad0-4346-be3e-e80e9656f442&page=queryresults
[0m16:43:45.140166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f6a06b60>]}
[0m16:43:45.141297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5e0aa10>]}
[0m16:43:45.142731 [info ] [Thread-2 (]: 2 of 9 OK created sql view model home_exchange.base_bigquery_subscriptions ..... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m16:43:45.144839 [info ] [Thread-1 (]: 1 of 9 OK created sql view model home_exchange.base_bigquery_exchanges ......... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m16:43:45.147191 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m16:43:45.148762 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m16:43:45.149974 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m16:43:45.152242 [info ] [Thread-2 (]: 3 of 9 START sql table model home_exchange.my_first_dbt_model .................. [RUN]
[0m16:43:45.153563 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m16:43:45.154781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m16:43:45.156326 [info ] [Thread-1 (]: 4 of 9 START sql table model home_exchange.test ................................ [RUN]
[0m16:43:45.157890 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m16:43:45.158998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.test)
[0m16:43:45.166561 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m16:43:45.167402 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m16:43:45.174641 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m16:43:45.176131 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m16:43:45.187644 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m16:43:45.210829 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:45.282865 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m16:43:45.284222 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:43:45.285219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:45.671775 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m16:43:45.672898 [debug] [Thread-2 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:43:46.052358 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:f0838c44-cfe0-4851-a97a-9bccae95a8ed&page=queryresults
[0m16:43:46.137865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:6ea351d3-bbdf-4a7e-8ebf-fbb7dd6524d7&page=queryresults
[0m16:43:48.865663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5c3f32aa0>]}
[0m16:43:48.868412 [info ] [Thread-1 (]: 4 of 9 OK created sql table model home_exchange.test ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.71s]
[0m16:43:48.870525 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m16:43:49.420736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34715f4c-a3f6-43f5-816c-cd97cc75ecf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5e9b3d0>]}
[0m16:43:49.422256 [info ] [Thread-2 (]: 3 of 9 OK created sql table model home_exchange.my_first_dbt_model ............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.27s]
[0m16:43:49.425250 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m16:43:49.429114 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:49.430264 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:49.434459 [info ] [Thread-1 (]: 5 of 9 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:43:49.438449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:43:49.440095 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:49.436534 [info ] [Thread-2 (]: 6 of 9 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:43:49.466920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m16:43:49.473196 [debug] [Thread-2 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:49.479023 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:43:49.495976 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m16:43:49.497978 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:49.509595 [debug] [Thread-2 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:49.561215 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:43:49.563787 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m16:43:49.566444 [debug] [Thread-1 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m16:43:49.568264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:49.569340 [debug] [Thread-2 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:49.570812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:50.365845 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:b989ffb1-5d6e-4d8a-ba87-222babac61b2&page=queryresults
[0m16:43:50.488832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:2be21d36-f71a-4e43-b9cc-c12de5cc526f&page=queryresults
[0m16:43:50.854351 [info ] [Thread-2 (]: 6 of 9 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.39s]
[0m16:43:50.863215 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:43:50.947291 [error] [Thread-1 (]: 5 of 9 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.51s]
[0m16:43:50.952498 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:43:50.956318 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m16:43:50.963630 [debug] [Thread-2 (]: Began running node model.home_exchange.my_second_dbt_model
[0m16:43:50.965201 [info ] [Thread-2 (]: 7 of 9 SKIP relation home_exchange.my_second_dbt_model ......................... [[33mSKIP[0m]
[0m16:43:50.966978 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m16:43:50.968371 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m16:43:50.970793 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:50.972781 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:50.975209 [info ] [Thread-1 (]: 8 of 9 SKIP test not_null_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m16:43:50.979498 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:50.977721 [info ] [Thread-2 (]: 9 of 9 SKIP test unique_my_second_dbt_model_id ................................. [[33mSKIP[0m]
[0m16:43:50.981460 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m16:43:50.982801 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:50.984486 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m16:43:50.989484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:50.993869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:50.995443 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m16:43:50.996969 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:43:50.998253 [info ] [MainThread]: 
[0m16:43:50.999398 [info ] [MainThread]: Finished running 2 table models, 4 data tests, 3 view models in 0 hours 0 minutes and 8.03 seconds (8.03s).
[0m16:43:51.008490 [debug] [MainThread]: Command end result
[0m16:43:51.066069 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:43:51.068959 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:43:51.083004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m16:43:51.083818 [info ] [MainThread]: 
[0m16:43:51.084888 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:43:51.086838 [info ] [MainThread]: 
[0m16:43:51.089044 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:43:51.091337 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:43:51.092595 [info ] [MainThread]: 
[0m16:43:51.093799 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:43:51.094820 [info ] [MainThread]: 
[0m16:43:51.096498 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=3 TOTAL=9
[0m16:43:51.098869 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 10.500423, "process_in_blocks": "0", "process_kernel_time": 0.387783, "process_mem_max_rss": "219212", "process_out_blocks": "2216", "process_user_time": 6.082083}
[0m16:43:51.099826 [debug] [MainThread]: Command `dbt build` failed at 16:43:51.099570 after 10.50 seconds
[0m16:43:51.100663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5d9f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f5a378b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dac3f1f0>]}
[0m16:43:51.101471 [debug] [MainThread]: Flushing usage events
[0m16:43:51.801358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:48.207893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515de7f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515cf031c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515cf03160>]}


============================== 16:44:48.212241 | ae14284d-f827-4b6c-a96a-8b37a8301821 ==============================
[0m16:44:48.212241 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:44:48.213715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:49.389201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51433465c0>]}
[0m16:44:49.511277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515d732170>]}
[0m16:44:49.513135 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:44:49.756334 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:44:50.163580 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m16:44:50.696041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514273ce80>]}
[0m16:44:50.861440 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:44:50.869004 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:44:50.926442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51426fda50>]}
[0m16:44:50.927462 [info ] [MainThread]: Found 5 models, 2 sources, 489 macros
[0m16:44:50.931234 [info ] [MainThread]: 
[0m16:44:50.932216 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m16:44:50.933132 [info ] [MainThread]: 
[0m16:44:50.934823 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:44:50.945460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m16:44:50.946653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.487368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m16:44:51.489140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.905219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515d5641f0>]}
[0m16:44:51.907140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:51.920445 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m16:44:51.923055 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m16:44:51.925177 [info ] [Thread-1 (]: 1 of 5 START sql view model home_exchange.base_bigquery_exchanges .............. [RUN]
[0m16:44:51.929752 [info ] [Thread-2 (]: 2 of 5 START sql view model home_exchange.base_bigquery_subscriptions .......... [RUN]
[0m16:44:51.931593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m16:44:51.933249 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m16:44:51.934386 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m16:44:51.935740 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m16:44:51.983319 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m16:44:51.984861 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m16:44:52.009055 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m16:44:52.054977 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m16:44:52.229746 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m16:44:52.231912 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m16:44:52.244481 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m16:44:52.246801 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m16:44:52.249033 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:44:52.250986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:53.197761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:2950b372-5b49-4d4d-b995-b44252b8984e&page=queryresults
[0m16:44:53.252988 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:b01acace-5c57-4997-9008-0529d90ca7dd&page=queryresults
[0m16:44:53.592041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514344f760>]}
[0m16:44:53.593564 [info ] [Thread-1 (]: 1 of 5 OK created sql view model home_exchange.base_bigquery_exchanges ......... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m16:44:53.595091 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m16:44:53.596722 [debug] [Thread-1 (]: Began running node model.home_exchange.my_first_dbt_model
[0m16:44:53.598747 [info ] [Thread-1 (]: 3 of 5 START sql table model home_exchange.my_first_dbt_model .................. [RUN]
[0m16:44:53.600074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.my_first_dbt_model)
[0m16:44:53.600859 [debug] [Thread-1 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m16:44:53.606847 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m16:44:53.619081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5141c335e0>]}
[0m16:44:53.620684 [info ] [Thread-2 (]: 2 of 5 OK created sql view model home_exchange.base_bigquery_subscriptions ..... [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m16:44:53.623183 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m16:44:53.624715 [debug] [Thread-1 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m16:44:53.642354 [debug] [Thread-2 (]: Began running node model.home_exchange.test
[0m16:44:53.650671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:53.649334 [info ] [Thread-2 (]: 4 of 5 START sql table model home_exchange.test ................................ [RUN]
[0m16:44:53.699107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.test)
[0m16:44:53.700993 [debug] [Thread-2 (]: Began compiling node model.home_exchange.test
[0m16:44:53.709851 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.test"
[0m16:44:53.711189 [debug] [Thread-2 (]: Began executing node model.home_exchange.test
[0m16:44:53.716421 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:54.165501 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m16:44:54.166919 [debug] [Thread-1 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:44:54.183767 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.test"
[0m16:44:54.185167 [debug] [Thread-2 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:44:54.577628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:606b1bbc-0f78-4247-a6d1-e9cfce0833b9&page=queryresults
[0m16:44:54.878643 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:bfc2d729-1c46-4817-bfde-a49f4c35d364&page=queryresults
[0m16:44:57.580110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51426ffa90>]}
[0m16:44:57.581662 [info ] [Thread-1 (]: 3 of 5 OK created sql table model home_exchange.my_first_dbt_model ............. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.98s]
[0m16:44:57.586716 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m16:44:57.589070 [debug] [Thread-1 (]: Began running node model.home_exchange.my_second_dbt_model
[0m16:44:57.590136 [info ] [Thread-1 (]: 5 of 5 START sql view model home_exchange.my_second_dbt_model .................. [RUN]
[0m16:44:57.591248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now model.home_exchange.my_second_dbt_model)
[0m16:44:57.592489 [debug] [Thread-1 (]: Began compiling node model.home_exchange.my_second_dbt_model
[0m16:44:57.598039 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.my_second_dbt_model"
[0m16:44:57.599053 [debug] [Thread-1 (]: Began executing node model.home_exchange.my_second_dbt_model
[0m16:44:57.610790 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.my_second_dbt_model"
[0m16:44:57.615824 [debug] [Thread-1 (]: On model.home_exchange.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_second_dbt_model"} */


  create or replace view `mywagon-445720`.`home_exchange`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id = 1;


[0m16:44:57.617263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:57.891023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513b5bd840>]}
[0m16:44:57.892546 [info ] [Thread-2 (]: 4 of 5 OK created sql table model home_exchange.test ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.19s]
[0m16:44:57.894115 [debug] [Thread-2 (]: Finished running node model.home_exchange.test
[0m16:44:58.315035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a9c0eb09-24e0-4db3-89c4-1ba73ded86d9&page=queryresults
[0m16:44:58.684787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae14284d-f827-4b6c-a96a-8b37a8301821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51426ffa90>]}
[0m16:44:58.687178 [info ] [Thread-1 (]: 5 of 5 OK created sql view model home_exchange.my_second_dbt_model ............. [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m16:44:58.693315 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m16:44:58.698090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:58.702585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:58.703291 [debug] [MainThread]: Connection 'model.home_exchange.my_second_dbt_model' was properly closed.
[0m16:44:58.704078 [debug] [MainThread]: Connection 'model.home_exchange.test' was properly closed.
[0m16:44:58.705522 [info ] [MainThread]: 
[0m16:44:58.707459 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 7.77 seconds (7.77s).
[0m16:44:58.711581 [debug] [MainThread]: Command end result
[0m16:44:58.773579 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:44:58.776798 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:44:58.790931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m16:44:58.791778 [info ] [MainThread]: 
[0m16:44:58.793297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:58.794759 [info ] [MainThread]: 
[0m16:44:58.795816 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:44:58.797590 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.690888, "process_in_blocks": "0", "process_kernel_time": 0.389666, "process_mem_max_rss": "224268", "process_out_blocks": "3168", "process_user_time": 6.514421}
[0m16:44:58.798486 [debug] [MainThread]: Command `dbt build` succeeded at 16:44:58.798250 after 10.69 seconds
[0m16:44:58.799562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515de7f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514344f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51433465c0>]}
[0m16:44:58.801439 [debug] [MainThread]: Flushing usage events
[0m16:44:59.549781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:13.972252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1798f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b172713c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b172708e0>]}


============================== 16:45:13.977563 | f3b9933c-9d7c-4a63-b4dc-ded2bdf18826 ==============================
[0m16:45:13.977563 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:45:13.979132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m16:45:15.342705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b9933c-9d7c-4a63-b4dc-ded2bdf18826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b01013a60>]}
[0m16:45:15.474915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3b9933c-9d7c-4a63-b4dc-ded2bdf18826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b16dc9330>]}
[0m16:45:15.476086 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:45:15.722037 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:45:16.015670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:45:16.016776 [debug] [MainThread]: Partial parsing: added file: home_exchange://models/example/schema.yml
[0m16:45:16.581873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3b9933c-9d7c-4a63-b4dc-ded2bdf18826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b008b4100>]}
[0m16:45:16.603764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3b9933c-9d7c-4a63-b4dc-ded2bdf18826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b17a331c0>]}
[0m16:45:16.604794 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 489 macros
[0m16:45:16.605786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3b9933c-9d7c-4a63-b4dc-ded2bdf18826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b17a612a0>]}
[0m16:45:16.609458 [info ] [MainThread]: 
[0m16:45:16.610465 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m16:45:16.612189 [info ] [MainThread]: 
[0m16:45:16.614591 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:45:16.624736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720_home_exchange'
[0m16:45:16.625989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:17.080578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3b9933c-9d7c-4a63-b4dc-ded2bdf18826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b18d004c0>]}
[0m16:45:17.083387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:17.104211 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m16:45:17.108220 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m16:45:17.110298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m16:45:17.112550 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m16:45:17.114509 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m16:45:17.116465 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m16:45:17.158345 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m16:45:17.165784 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m16:45:17.167189 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m16:45:17.168291 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m16:45:17.169151 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:45:17.170113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:17.173621 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m16:45:17.177186 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m16:45:17.179080 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m16:45:17.181246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m16:45:17.182302 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m16:45:17.183095 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m16:45:17.184181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.test)
[0m16:45:17.189769 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m16:45:17.191055 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m16:45:17.198473 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m16:45:17.200033 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m16:45:17.201315 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:17.202355 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m16:45:17.205936 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m16:45:17.207077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:17.211951 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m16:45:17.213259 [debug] [Thread-1 (]: Began running node model.home_exchange.my_second_dbt_model
[0m16:45:17.215148 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:45:17.216263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now model.home_exchange.my_second_dbt_model)
[0m16:45:17.217293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:45:17.218256 [debug] [Thread-1 (]: Began compiling node model.home_exchange.my_second_dbt_model
[0m16:45:17.219206 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:45:17.224273 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.my_second_dbt_model"
[0m16:45:17.249283 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:45:17.250441 [debug] [Thread-1 (]: Began executing node model.home_exchange.my_second_dbt_model
[0m16:45:17.251895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:17.256877 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m16:45:17.258787 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:45:17.260888 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:45:17.264221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_second_dbt_model, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m16:45:17.265526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:17.267578 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:45:17.272337 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:45:17.286317 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m16:45:17.287352 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:45:17.289211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710, now test.home_exchange.not_null_my_second_dbt_model_id.151b76d778)
[0m16:45:17.290337 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:45:17.298597 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_second_dbt_model_id.151b76d778"
[0m16:45:17.299701 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:45:17.301015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:17.305007 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:45:17.306218 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:45:17.307228 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:45:17.308526 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:45:17.309630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.home_exchange.unique_my_first_dbt_model_id.16e066b321, now test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:45:17.313355 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:45:17.314147 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:45:17.322635 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:45:17.323689 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:45:17.324501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:17.327653 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:45:17.330062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:17.330828 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:45:17.331492 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:45:17.335030 [debug] [MainThread]: Command end result
[0m16:45:17.539436 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:45:17.543887 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:45:17.557182 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m16:45:17.568698 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m16:45:17.569392 [info ] [MainThread]: Building catalog
[0m16:45:17.581292 [debug] [ThreadPool]: Acquiring new bigquery connection 'mywagon-445720.information_schema'
[0m16:45:17.632936 [debug] [ThreadPool]: On mywagon-445720.information_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "connection_name": "mywagon-445720.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `mywagon-445720`.`home_exchange`.__TABLES__ tables
    left join `mywagon-445720`.`home_exchange`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `mywagon-445720`.`home_exchange`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('home_exchange')
                            and upper(table_name) = upper('base_bigquery_exchanges')
                            ) or (
                                upper(table_schema) = upper('home_exchange')
                            and upper(table_name) = upper('subscriptions')
                            ) or (
                                upper(table_schema) = upper('home_exchange')
                            and upper(table_name) = upper('my_second_dbt_model')
                            ) or (
                                upper(table_schema) = upper('home_exchange')
                            and upper(table_name) = upper('exchanges')
                            ) or (
                                upper(table_schema) = upper('home_exchange')
                            and upper(table_name) = upper('base_bigquery_subscriptions')
                            ) or (
                                upper(table_schema) = upper('home_exchange')
                            and upper(table_name) = upper('my_first_dbt_model')
                            ) or (
                                upper(table_schema) = upper('home_exchange')
                            and upper(table_name) = upper('test')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `mywagon-445720`.`home_exchange`.INFORMATION_SCHEMA.COLUMNS columns
    join `mywagon-445720`.`home_exchange`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m16:45:17.634571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.321898 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a8aba056-d598-4fe9-a9d1-34bcefebb490&page=queryresults
[0m16:45:20.468878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:20.501180 [debug] [MainThread]: Wrote artifact CatalogArtifact to /root/home_exchange/home_exchange/target/catalog.json
[0m16:45:20.564594 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:45:20.567599 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:45:20.568889 [info ] [MainThread]: Catalog written to /root/home_exchange/home_exchange/target/catalog.json
[0m16:45:20.571788 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.786874, "process_in_blocks": "3376", "process_kernel_time": 0.231126, "process_mem_max_rss": "218884", "process_out_blocks": "6576", "process_user_time": 6.632324}
[0m16:45:20.572927 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:45:20.572651 after 6.79 seconds
[0m16:45:20.573645 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:45:20.574382 [debug] [MainThread]: Connection 'mywagon-445720.information_schema' was properly closed.
[0m16:45:20.575202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1798f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b17a331c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b17cf5bd0>]}
[0m16:45:20.577387 [debug] [MainThread]: Flushing usage events
[0m16:45:21.138201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:28.537157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34c5af5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34d4ce920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34d4ce680>]}


============================== 16:45:28.541396 | f3325144-9966-4b88-975f-90792db89453 ==============================
[0m16:45:28.541396 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:45:28.542865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:29.813433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3325144-9966-4b88-975f-90792db89453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb331aabeb0>]}
[0m16:45:29.928290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3325144-9966-4b88-975f-90792db89453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34bcd8fd0>]}
[0m16:47:09.614226 [error] [MainThread]: Encountered an error:

[0m16:47:09.653057 [error] [MainThread]: Traceback (most recent call last):
  File "/root/.pyenv/versions/3.10.6/envs/home-exchange/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.6/envs/home-exchange/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.6/envs/home-exchange/lib/python3.10/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.6/envs/home-exchange/lib/python3.10/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.6/envs/home-exchange/lib/python3.10/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.6/envs/home-exchange/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/root/.pyenv/versions/3.10.6/envs/home-exchange/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/root/.pyenv/versions/3.10.6/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/root/.pyenv/versions/3.10.6/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m16:47:09.657391 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 101.22235, "process_in_blocks": "224", "process_kernel_time": 0.13074, "process_mem_max_rss": "202008", "process_out_blocks": "3360", "process_user_time": 3.972512}
[0m16:47:09.660900 [debug] [MainThread]: Command `dbt docs serve` failed at 16:47:09.660284 after 101.23 seconds
[0m16:47:09.663110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34c5af5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34d4cc2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34d4ce8f0>]}
[0m16:47:09.664256 [debug] [MainThread]: Flushing usage events
[0m16:47:10.296882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:16.738419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09050ef5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090417b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f090417b160>]}


============================== 16:47:16.742672 | 49ebf921-4877-4244-9adf-3bfd45c96625 ==============================
[0m16:47:16.742672 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:47:16.744237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:17.950566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ebf921-4877-4244-9adf-3bfd45c96625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ea5d83d0>]}
[0m16:47:18.063987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ebf921-4877-4244-9adf-3bfd45c96625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0904528490>]}
[0m16:47:18.065713 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m16:47:18.284795 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:47:18.620909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:18.621623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:18.724958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ebf921-4877-4244-9adf-3bfd45c96625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ea24c130>]}
[0m16:47:18.939320 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:47:18.944312 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:47:18.978262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ebf921-4877-4244-9adf-3bfd45c96625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ea24af50>]}
[0m16:47:18.979512 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 489 macros
[0m16:47:18.980830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ebf921-4877-4244-9adf-3bfd45c96625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08eaaa57e0>]}
[0m16:47:18.984484 [info ] [MainThread]: 
[0m16:47:18.985492 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m16:47:18.986473 [info ] [MainThread]: 
[0m16:47:18.987760 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:47:18.995867 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720_home_exchange'
[0m16:47:18.997147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:19.405264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ebf921-4877-4244-9adf-3bfd45c96625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0905646e30>]}
[0m16:47:19.406327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:19.412520 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:47:19.413586 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:47:19.415260 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:47:19.417128 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:47:19.419538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:47:19.420818 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778'
[0m16:47:19.421787 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:47:19.422800 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:47:19.481216 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_second_dbt_model_id.151b76d778"
[0m16:47:19.483116 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:47:19.484611 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:47:19.485491 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:47:19.547925 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:47:19.550303 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_second_dbt_model_id.151b76d778"
[0m16:47:19.551931 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m16:47:19.553079 [debug] [Thread-1 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m16:47:19.554201 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:47:19.555240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:20.409535 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:33a47a4b-0f6c-46b5-8944-33b24f08515b&page=queryresults
[0m16:47:20.660911 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:85e8c8b9-7bdc-4574-8a5f-47537a622357&page=queryresults
[0m16:47:20.917915 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.50s]
[0m16:47:20.921566 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:47:20.922780 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:47:20.924070 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:47:20.925384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m16:47:20.926404 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:47:20.943672 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m16:47:20.946863 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:47:20.957110 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m16:47:20.958417 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:47:20.959626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:21.148672 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.73s]
[0m16:47:21.151433 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m16:47:21.153892 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:47:21.155532 [info ] [Thread-2 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:47:21.157713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_my_second_dbt_model_id.151b76d778, now test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:47:21.158853 [debug] [Thread-2 (]: Began compiling node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:47:21.168150 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:47:21.170853 [debug] [Thread-2 (]: Began executing node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:47:21.176386 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:47:21.177569 [debug] [Thread-2 (]: On test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:47:21.179089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:47:21.810888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:37de585d-f900-4468-91c0-c9d16a2bf71f&page=queryresults
[0m16:47:22.151937 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:ada2ede7-2422-4cc9-bf40-bd5fc88d813b&page=queryresults
[0m16:47:22.254803 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.32s]
[0m16:47:22.263165 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m16:47:22.648026 [info ] [Thread-2 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.49s]
[0m16:47:22.657692 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m16:47:22.663114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:22.669306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:22.670552 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:47:22.672312 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:47:22.673812 [info ] [MainThread]: 
[0m16:47:22.675214 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m16:47:22.681006 [debug] [MainThread]: Command end result
[0m16:47:22.748865 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m16:47:22.751933 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m16:47:22.768159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m16:47:22.769316 [info ] [MainThread]: 
[0m16:47:22.770983 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:47:22.773313 [info ] [MainThread]: 
[0m16:47:22.775130 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:47:22.776966 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:47:22.778873 [info ] [MainThread]: 
[0m16:47:22.781356 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:47:22.783432 [info ] [MainThread]: 
[0m16:47:22.785772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:47:22.787647 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.154382, "process_in_blocks": "0", "process_kernel_time": 0.211601, "process_mem_max_rss": "218980", "process_out_blocks": "2144", "process_user_time": 5.541951}
[0m16:47:22.788586 [debug] [MainThread]: Command `dbt test` failed at 16:47:22.788347 after 6.16 seconds
[0m16:47:22.789976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09050ef5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0904528490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09050570d0>]}
[0m16:47:22.791160 [debug] [MainThread]: Flushing usage events
[0m16:47:23.246010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:15.432559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbd7ef610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbcc2e800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbcc2e8f0>]}


============================== 23:50:15.438189 | 3437d15a-d5b9-4503-86db-d93652f62ced ==============================
[0m23:50:15.438189 [info ] [MainThread]: Running with dbt=1.9.1
[0m23:50:15.440201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'version_check': 'True', 'profiles_dir': '/root/home_exchange/home_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:50:16.812005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba2c8ece0>]}
[0m23:50:16.933933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba2c75fc0>]}
[0m23:50:16.935390 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m23:50:17.175604 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m23:50:17.537807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:50:17.538621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:50:17.649747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba2964130>]}
[0m23:50:17.878281 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m23:50:17.888073 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m23:50:17.938861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba28dd480>]}
[0m23:50:17.939994 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 489 macros
[0m23:50:17.945676 [info ] [MainThread]: 
[0m23:50:17.946878 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m23:50:17.947763 [info ] [MainThread]: 
[0m23:50:17.949020 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:50:17.959216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m23:50:17.960559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:23.015382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m23:50:23.018297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:24.421915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba2c768f0>]}
[0m23:50:24.423086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:24.431214 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m23:50:24.432964 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m23:50:24.434199 [info ] [Thread-1 (]: 1 of 10 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m23:50:24.437149 [info ] [Thread-2 (]: 2 of 10 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m23:50:24.439580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m23:50:24.441420 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m23:50:24.443340 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m23:50:24.444943 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m23:50:24.520784 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m23:50:24.527716 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m23:50:24.529907 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m23:50:24.530884 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m23:50:24.711400 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m23:50:24.712668 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m23:50:24.715617 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m23:50:24.718000 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m23:50:24.719892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:24.721450 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:50:25.897987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:c0324a0e-0e8f-47ae-b9dd-e226d347b50a&page=queryresults
[0m23:50:25.995901 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:76702fc2-74a2-4d6c-a8d1-23b3022d10f5&page=queryresults
[0m23:50:26.593668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbd9bf3d0>]}
[0m23:50:26.594978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbe756b60>]}
[0m23:50:26.598246 [info ] [Thread-2 (]: 2 of 10 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m23:50:26.604421 [info ] [Thread-1 (]: 1 of 10 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m23:50:26.610741 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m23:50:26.613447 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m23:50:26.615591 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m23:50:26.618522 [info ] [Thread-2 (]: 3 of 10 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m23:50:26.620786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m23:50:26.622267 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m23:50:26.623607 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m23:50:26.634009 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m23:50:26.635844 [info ] [Thread-1 (]: 4 of 10 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m23:50:26.638475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.exchanges_cleaning)
[0m23:50:26.639697 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m23:50:26.651706 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m23:50:26.652743 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m23:50:26.680528 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:50:26.728789 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m23:50:26.749363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:26.767889 [debug] [Thread-1 (]: Runtime Error in model exchanges_cleaning (models/cleaning/exchanges_cleaning.sql)
  Could not parse partition config
[0m23:50:26.769566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba2776ef0>]}
[0m23:50:26.771168 [error] [Thread-1 (]: 4 of 10 ERROR creating sql table model home_exchange.exchanges_cleaning ........ [[31mERROR[0m in 0.13s]
[0m23:50:26.773947 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m23:50:26.775712 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m23:50:26.778147 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Runtime Error in model exchanges_cleaning (models/cleaning/exchanges_cleaning.sql)
  Could not parse partition config.
[0m23:50:26.779467 [info ] [Thread-1 (]: 5 of 10 START sql table model home_exchange.test ............................... [RUN]
[0m23:50:26.781861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.test)
[0m23:50:26.782907 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m23:50:26.790341 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m23:50:26.793930 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m23:50:26.799532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:27.497872 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m23:50:27.500811 [debug] [Thread-2 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:50:27.518656 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m23:50:27.520886 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m23:50:28.078640 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:4e18cf53-2c35-4e21-9937-039024110cab&page=queryresults
[0m23:50:28.325467 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:430c4cbb-68eb-450e-9a5f-065fb2aad60a&page=queryresults
[0m23:50:30.768750 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbe756b60>]}
[0m23:50:30.773957 [info ] [Thread-2 (]: 3 of 10 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.15s]
[0m23:50:30.780690 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m23:50:30.785587 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:50:30.788980 [info ] [Thread-2 (]: 6 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m23:50:30.792618 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m23:50:30.795254 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:50:30.835757 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:50:30.837705 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:50:30.875866 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:50:30.877328 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m23:50:30.880039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:50:31.230849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3437d15a-d5b9-4503-86db-d93652f62ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba2775a80>]}
[0m23:50:31.234520 [info ] [Thread-1 (]: 5 of 10 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.45s]
[0m23:50:31.239898 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m23:50:31.242200 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m23:50:31.245941 [info ] [Thread-1 (]: 7 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m23:50:31.248246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m23:50:31.250494 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m23:50:31.279082 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m23:50:31.283587 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m23:50:31.293482 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m23:50:31.295232 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m23:50:31.296837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:32.189140 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:296b285f-2999-4292-a4a9-0f4103563599&page=queryresults
[0m23:50:32.351863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:24a95dc8-00d9-4ffd-abfd-ddabc87b2de8&page=queryresults
[0m23:50:32.957063 [error] [Thread-2 (]: 6 of 10 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 2.16s]
[0m23:50:32.963563 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:50:32.967655 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m23:50:33.130288 [info ] [Thread-1 (]: 7 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.88s]
[0m23:50:33.142322 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m23:50:33.150858 [debug] [Thread-2 (]: Began running node model.home_exchange.my_second_dbt_model
[0m23:50:33.156603 [info ] [Thread-2 (]: 8 of 10 SKIP relation home_exchange.my_second_dbt_model ........................ [[33mSKIP[0m]
[0m23:50:33.160546 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m23:50:33.164172 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m23:50:33.172391 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m23:50:33.175897 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m23:50:33.178714 [info ] [Thread-1 (]: 9 of 10 SKIP test not_null_my_second_dbt_model_id .............................. [[33mSKIP[0m]
[0m23:50:33.184370 [info ] [Thread-2 (]: 10 of 10 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m23:50:33.193547 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m23:50:33.200038 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m23:50:33.206999 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m23:50:33.214805 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m23:50:33.233674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:33.244935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:33.247985 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:50:33.250528 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:50:33.256469 [info ] [MainThread]: 
[0m23:50:33.260817 [info ] [MainThread]: Finished running 3 table models, 4 data tests, 3 view models in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m23:50:33.287433 [debug] [MainThread]: Command end result
[0m23:50:33.448386 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m23:50:33.452935 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m23:50:33.475702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m23:50:33.477018 [info ] [MainThread]: 
[0m23:50:33.479213 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:50:33.481837 [info ] [MainThread]: 
[0m23:50:33.484872 [error] [MainThread]:   Runtime Error in model exchanges_cleaning (models/cleaning/exchanges_cleaning.sql)
  Could not parse partition config
[0m23:50:33.487412 [info ] [MainThread]: 
[0m23:50:33.489062 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m23:50:33.491595 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:50:33.493118 [info ] [MainThread]: 
[0m23:50:33.494603 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m23:50:33.495924 [info ] [MainThread]: 
[0m23:50:33.497370 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=3 TOTAL=10
[0m23:50:33.507198 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 18.235546, "process_in_blocks": "4520", "process_kernel_time": 0.514577, "process_mem_max_rss": "220480", "process_out_blocks": "2264", "process_user_time": 8.939521}
[0m23:50:33.508263 [debug] [MainThread]: Command `dbt build` failed at 23:50:33.507999 after 18.24 seconds
[0m23:50:33.509246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbd7ef610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba28dd480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba2965240>]}
[0m23:50:33.510152 [debug] [MainThread]: Flushing usage events
[0m23:50:34.770880 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:22.157677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa5067670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa40f3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa40f31c0>]}


============================== 00:12:22.161964 | d06bbb96-49dc-40ab-9ccd-be150aa41da6 ==============================
[0m00:12:22.161964 [info ] [MainThread]: Running with dbt=1.9.1
[0m00:12:22.163490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:23.385014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8a549240>]}
[0m00:12:23.497288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa44a44f0>]}
[0m00:12:23.498546 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:12:23.718205 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m00:12:24.082100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:24.082916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:24.183606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8a1c8130>]}
[0m00:12:24.387711 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m00:12:24.392925 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m00:12:24.432379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8a145150>]}
[0m00:12:24.433532 [info ] [MainThread]: Found 6 models, 4 data tests, 2 sources, 489 macros
[0m00:12:24.438828 [info ] [MainThread]: 
[0m00:12:24.439959 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m00:12:24.440792 [info ] [MainThread]: 
[0m00:12:24.442050 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:12:24.451286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m00:12:24.452485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:25.140471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m00:12:25.143846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:25.860839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa53a0be0>]}
[0m00:12:25.864000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:25.883212 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m00:12:25.886685 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m00:12:25.890756 [info ] [Thread-1 (]: 1 of 10 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m00:12:25.896086 [info ] [Thread-2 (]: 2 of 10 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m00:12:25.900549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m00:12:25.904066 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m00:12:25.907170 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m00:12:25.911992 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m00:12:26.076605 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m00:12:26.094958 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m00:12:26.099032 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m00:12:26.113449 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m00:12:26.288005 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m00:12:26.289487 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m00:12:26.291239 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m00:12:26.292835 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:12:26.294483 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m00:12:26.340665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:27.388055 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:f2268867-2a6b-446b-9e79-3d121c3ff315&page=queryresults
[0m00:12:27.394429 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:54b1b415-e650-4566-b48d-4b56fe048aba&page=queryresults
[0m00:12:27.961046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa5fcebc0>]}
[0m00:12:27.963477 [info ] [Thread-2 (]: 2 of 10 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m00:12:27.970988 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m00:12:27.972594 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m00:12:27.982580 [info ] [Thread-2 (]: 3 of 10 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m00:12:27.984595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m00:12:27.986249 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m00:12:27.981119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba89ecd2a0>]}
[0m00:12:28.000706 [info ] [Thread-1 (]: 1 of 10 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 2.08s]
[0m00:12:28.002926 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m00:12:28.004935 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m00:12:28.012107 [info ] [Thread-1 (]: 4 of 10 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m00:12:28.014488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.exchanges_cleaning)
[0m00:12:28.015992 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m00:12:27.998719 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m00:12:28.029404 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m00:12:28.038272 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m00:12:28.054169 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m00:12:28.118977 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:28.210084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:28.221098 [debug] [Thread-1 (]: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m00:12:28.223106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba881266b0>]}
[0m00:12:28.224758 [error] [Thread-1 (]: 4 of 10 ERROR creating sql table model home_exchange.exchanges_cleaning ........ [[31mERROR[0m in 0.21s]
[0m00:12:28.228032 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m00:12:28.230153 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m00:12:28.232532 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config.
[0m00:12:28.235044 [info ] [Thread-1 (]: 5 of 10 START sql table model home_exchange.test ............................... [RUN]
[0m00:12:28.238222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.test)
[0m00:12:28.239410 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m00:12:28.247927 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m00:12:28.249630 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m00:12:28.254150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:28.809849 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m00:12:28.812311 [debug] [Thread-2 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m00:12:28.825690 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m00:12:28.828017 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m00:12:29.266471 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:9ba8dd0b-b137-4155-a1fe-0876f54954a4&page=queryresults
[0m00:12:29.491471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:937c742c-1647-49c0-8418-b07a33536676&page=queryresults
[0m00:12:32.271860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8a1df460>]}
[0m00:12:32.277538 [info ] [Thread-2 (]: 3 of 10 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.29s]
[0m00:12:32.283238 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m00:12:32.289527 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:12:32.292127 [info ] [Thread-2 (]: 6 of 10 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m00:12:32.295397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m00:12:32.297944 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:12:32.374648 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:12:32.376699 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:12:32.418708 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:12:32.419969 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m00:12:32.421121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:12:32.469640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06bbb96-49dc-40ab-9ccd-be150aa41da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7afa2350>]}
[0m00:12:32.471491 [info ] [Thread-1 (]: 5 of 10 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.23s]
[0m00:12:32.473172 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m00:12:32.474786 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:12:32.476188 [info ] [Thread-1 (]: 7 of 10 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m00:12:32.477496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m00:12:32.478431 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:12:32.493097 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m00:12:32.494305 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:12:32.500073 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m00:12:32.502096 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m00:12:32.504051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:33.427399 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:da15b212-4181-4f67-a860-b08935ae9252&page=queryresults
[0m00:12:33.501115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:3be10054-f921-4135-b8b0-ed126b5ce82a&page=queryresults
[0m00:12:34.060090 [error] [Thread-2 (]: 6 of 10 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.76s]
[0m00:12:34.065843 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:12:34.071672 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m00:12:34.121710 [info ] [Thread-1 (]: 7 of 10 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.64s]
[0m00:12:34.129458 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:12:34.137343 [debug] [Thread-2 (]: Began running node model.home_exchange.my_second_dbt_model
[0m00:12:34.141908 [info ] [Thread-2 (]: 8 of 10 SKIP relation home_exchange.my_second_dbt_model ........................ [[33mSKIP[0m]
[0m00:12:34.148512 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m00:12:34.154471 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m00:12:34.160346 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m00:12:34.166341 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m00:12:34.162993 [info ] [Thread-1 (]: 9 of 10 SKIP test not_null_my_second_dbt_model_id .............................. [[33mSKIP[0m]
[0m00:12:34.170915 [info ] [Thread-2 (]: 10 of 10 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m00:12:34.174004 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m00:12:34.176026 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m00:12:34.178159 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m00:12:34.180566 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m00:12:34.188102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:34.195823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:34.197419 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m00:12:34.198734 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m00:12:34.201176 [info ] [MainThread]: 
[0m00:12:34.203750 [info ] [MainThread]: Finished running 3 table models, 4 data tests, 3 view models in 0 hours 0 minutes and 9.76 seconds (9.76s).
[0m00:12:34.215921 [debug] [MainThread]: Command end result
[0m00:12:34.428653 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m00:12:34.436408 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m00:12:34.492007 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m00:12:34.493403 [info ] [MainThread]: 
[0m00:12:34.495816 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:12:34.497942 [info ] [MainThread]: 
[0m00:12:34.499799 [error] [MainThread]:   Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m00:12:34.502058 [info ] [MainThread]: 
[0m00:12:34.503473 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m00:12:34.504918 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:12:34.506043 [info ] [MainThread]: 
[0m00:12:34.507501 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m00:12:34.509004 [info ] [MainThread]: 
[0m00:12:34.510735 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=3 TOTAL=10
[0m00:12:34.513419 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 12.454466, "process_in_blocks": "0", "process_kernel_time": 0.285183, "process_mem_max_rss": "220664", "process_out_blocks": "2264", "process_user_time": 7.037926}
[0m00:12:34.515220 [debug] [MainThread]: Command `dbt build` failed at 00:12:34.514836 after 12.46 seconds
[0m00:12:34.519664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaa5067670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8a1cb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba8a1476d0>]}
[0m00:12:34.521518 [debug] [MainThread]: Flushing usage events
[0m00:12:35.472927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:10.600059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccf05c75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccf1529ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccf1529bd0>]}


============================== 00:15:10.604330 | 3a125702-9551-4b79-91fb-74c7c31f779c ==============================
[0m00:15:10.604330 [info ] [MainThread]: Running with dbt=1.9.1
[0m00:15:10.606053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:15:11.841665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd5a97ca0>]}
[0m00:15:11.954000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd5ba12d0>]}
[0m00:15:11.955228 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m00:15:12.187336 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m00:15:12.598595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:15:12.599325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:15:12.703088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd571ffa0>]}
[0m00:15:12.926778 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m00:15:12.932065 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m00:15:12.972506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd571c040>]}
[0m00:15:12.973668 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m00:15:12.979493 [info ] [MainThread]: 
[0m00:15:12.980546 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m00:15:12.981498 [info ] [MainThread]: 
[0m00:15:12.982771 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:15:12.991454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m00:15:12.992841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:13.690423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m00:15:13.693546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:14.510156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccefcac370>]}
[0m00:15:14.513251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:15:14.539341 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m00:15:14.543482 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m00:15:14.547122 [info ] [Thread-1 (]: 1 of 16 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m00:15:14.552724 [info ] [Thread-2 (]: 2 of 16 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m00:15:14.558153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m00:15:14.562917 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m00:15:14.566810 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m00:15:14.569793 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m00:15:14.719475 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m00:15:14.738387 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m00:15:14.741484 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m00:15:14.754665 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m00:15:14.857647 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m00:15:14.860315 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m00:15:14.862147 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m00:15:14.863358 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m00:15:14.864335 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:15:14.865327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:15.729919 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:4e62b7a4-838e-488e-af01-2b45a8ff948a&page=queryresults
[0m00:15:15.777368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:90886f33-8098-41c5-b7bc-759faa49c510&page=queryresults
[0m00:15:16.263164 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd5ba20b0>]}
[0m00:15:16.264129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd5a9dc60>]}
[0m00:15:16.266034 [info ] [Thread-2 (]: 2 of 16 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m00:15:16.268339 [info ] [Thread-1 (]: 1 of 16 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m00:15:16.271355 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m00:15:16.272997 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m00:15:16.275828 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m00:15:16.278137 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m00:15:16.279992 [info ] [Thread-2 (]: 3 of 16 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m00:15:16.282492 [info ] [Thread-1 (]: 4 of 16 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m00:15:16.284279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m00:15:16.285968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.exchanges_cleaning)
[0m00:15:16.287298 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m00:15:16.288783 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m00:15:16.299542 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m00:15:16.306715 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m00:15:16.309013 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m00:15:16.330526 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m00:15:16.363262 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:15:16.433359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:16.439196 [debug] [Thread-1 (]: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m00:15:16.440314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd4233880>]}
[0m00:15:16.441552 [error] [Thread-1 (]: 4 of 16 ERROR creating sql table model home_exchange.exchanges_cleaning ........ [[31mERROR[0m in 0.15s]
[0m00:15:16.443320 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m00:15:16.444965 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m00:15:16.447200 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config.
[0m00:15:16.449441 [info ] [Thread-1 (]: 5 of 16 START sql table model home_exchange.test ............................... [RUN]
[0m00:15:16.452931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.test)
[0m00:15:16.453960 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m00:15:16.461547 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m00:15:16.462743 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m00:15:16.467159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:17.197822 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m00:15:17.199261 [debug] [Thread-2 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m00:15:17.228078 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m00:15:17.229232 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m00:15:17.829175 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:d3ae2831-fa1e-45bf-b74b-76fe202010db&page=queryresults
[0m00:15:17.879635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:59327f51-a615-4be9-974f-907adcc12b9d&page=queryresults
[0m00:15:20.614042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccd4232800>]}
[0m00:15:20.618434 [info ] [Thread-1 (]: 5 of 16 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.16s]
[0m00:15:20.624399 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m00:15:20.628295 [debug] [Thread-1 (]: Began running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m00:15:20.631899 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_range_exchanges_cleaning_calculated_night_count__365__0  [[33mSKIP[0m]
[0m00:15:20.638599 [debug] [Thread-1 (]: Finished running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m00:15:20.642431 [debug] [Thread-1 (]: Began running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m00:15:20.643953 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee' to be skipped because of status 'skipped'. 
[0m00:15:20.646731 [info ] [Thread-1 (]: 7 of 16 SKIP test accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [[33mSKIP[0m]
[0m00:15:20.661075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a125702-9551-4b79-91fb-74c7c31f779c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccce631690>]}
[0m00:15:20.664490 [debug] [Thread-1 (]: Finished running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m00:15:20.668958 [info ] [Thread-2 (]: 3 of 16 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.38s]
[0m00:15:20.672977 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m00:15:20.675251 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b' to be skipped because of status 'skipped'. 
[0m00:15:20.677685 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m00:15:20.680040 [info ] [Thread-1 (]: 8 of 16 SKIP test not_null_exchanges_cleaning_conversation_id .................. [[33mSKIP[0m]
[0m00:15:20.683572 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m00:15:20.686079 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m00:15:20.690442 [info ] [Thread-2 (]: 9 of 16 SKIP test not_null_exchanges_cleaning_end_on ........................... [[33mSKIP[0m]
[0m00:15:20.694371 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m00:15:20.697092 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21' to be skipped because of status 'skipped'. 
[0m00:15:20.700658 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m00:15:20.705593 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_exchanges_cleaning_start_on ........................ [[33mSKIP[0m]
[0m00:15:20.715024 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m00:15:20.717868 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59' to be skipped because of status 'skipped'. 
[0m00:15:20.721475 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m00:15:20.725100 [info ] [Thread-2 (]: 11 of 16 SKIP test unique_exchanges_cleaning_conversation_id ................... [[33mSKIP[0m]
[0m00:15:20.728376 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:15:20.729729 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' to be skipped because of status 'skipped'. 
[0m00:15:20.730880 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m00:15:20.732104 [info ] [Thread-1 (]: 12 of 16 START test not_null_my_first_dbt_model_id ............................. [RUN]
[0m00:15:20.734209 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:15:20.737330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m00:15:20.739334 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' to be skipped because of status 'skipped'. 
[0m00:15:20.740547 [info ] [Thread-2 (]: 13 of 16 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m00:15:20.742174 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:15:20.743945 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m00:15:20.756773 [debug] [Thread-2 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:15:20.790300 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m00:15:20.803539 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:15:20.805768 [debug] [Thread-2 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:15:20.818511 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:15:20.871321 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m00:15:20.878949 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:15:20.880523 [debug] [Thread-2 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m00:15:20.881844 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:15:20.925996 [debug] [Thread-1 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m00:15:20.928425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:21.874207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:68cecc8a-ed76-4eb5-9b10-3dcd2cae1470&page=queryresults
[0m00:15:22.001724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:f4485f64-7aa0-4097-b988-976c07d8eed2&page=queryresults
[0m00:15:22.441472 [error] [Thread-1 (]: 12 of 16 FAIL 1 not_null_my_first_dbt_model_id ................................. [[31mFAIL 1[0m in 1.70s]
[0m00:15:22.448624 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:15:22.453664 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m00:15:22.611027 [info ] [Thread-2 (]: 13 of 16 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.87s]
[0m00:15:22.618027 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m00:15:22.625597 [debug] [Thread-1 (]: Began running node model.home_exchange.my_second_dbt_model
[0m00:15:22.630769 [info ] [Thread-1 (]: 14 of 16 SKIP relation home_exchange.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m00:15:22.640272 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m00:15:22.645879 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m00:15:22.657614 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m00:15:22.662115 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m00:15:22.667689 [info ] [Thread-2 (]: 15 of 16 SKIP test not_null_my_second_dbt_model_id ............................. [[33mSKIP[0m]
[0m00:15:22.674526 [info ] [Thread-1 (]: 16 of 16 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m00:15:22.678826 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m00:15:22.681326 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m00:15:22.686089 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m00:15:22.690531 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m00:15:22.695657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:15:22.700167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:22.704038 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m00:15:22.705660 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m00:15:22.707512 [info ] [MainThread]: 
[0m00:15:22.709255 [info ] [MainThread]: Finished running 3 table models, 10 data tests, 3 view models in 0 hours 0 minutes and 9.72 seconds (9.72s).
[0m00:15:22.720517 [debug] [MainThread]: Command end result
[0m00:15:22.819804 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m00:15:22.822553 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m00:15:22.836238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m00:15:22.837384 [info ] [MainThread]: 
[0m00:15:22.838915 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:15:22.840854 [info ] [MainThread]: 
[0m00:15:22.841937 [error] [MainThread]:   Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m00:15:22.842790 [info ] [MainThread]: 
[0m00:15:22.843884 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m00:15:22.844946 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:15:22.846148 [info ] [MainThread]: 
[0m00:15:22.847633 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m00:15:22.848681 [info ] [MainThread]: 
[0m00:15:22.850568 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=9 TOTAL=16
[0m00:15:22.853160 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 12.352969, "process_in_blocks": "0", "process_kernel_time": 0.395572, "process_mem_max_rss": "220168", "process_out_blocks": "2384", "process_user_time": 6.887011}
[0m00:15:22.854170 [debug] [MainThread]: Command `dbt build` failed at 00:15:22.853890 after 12.35 seconds
[0m00:15:22.854947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccf05c75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccf14e7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccce7cab90>]}
[0m00:15:22.855756 [debug] [MainThread]: Flushing usage events
[0m00:15:24.021618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:18.427209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb654b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb71fafe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb71faf80>]}


============================== 19:02:18.434023 | 6fe48125-6248-450c-a9ef-a85a10c93f8c ==============================
[0m19:02:18.434023 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:02:18.437571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:02:19.724205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b71e8f0>]}
[0m19:02:19.914201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b815690>]}
[0m19:02:19.915522 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:02:20.156617 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:02:20.540034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:20.540805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:20.646555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b3856f0>]}
[0m19:02:20.873943 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:02:20.884228 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:02:20.944048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b41cd00>]}
[0m19:02:20.945265 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:02:20.951262 [info ] [MainThread]: 
[0m19:02:20.952243 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:02:20.953191 [info ] [MainThread]: 
[0m19:02:20.954399 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:20.966594 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:02:20.968525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:21.461153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:02:21.464204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:22.075060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b882f50>]}
[0m19:02:22.082195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:22.101568 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m19:02:22.105272 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m19:02:22.111009 [info ] [Thread-1 (]: 1 of 16 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m19:02:22.125561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m19:02:22.119357 [info ] [Thread-2 (]: 2 of 16 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m19:02:22.132322 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m19:02:22.135944 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m19:02:22.160906 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m19:02:22.243762 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:02:22.253417 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m19:02:22.257085 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m19:02:22.259927 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m19:02:22.438404 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:02:22.440009 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m19:02:22.444099 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:02:22.446211 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:02:22.447260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:22.448396 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:02:23.201462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:1a02adf9-f9f1-44a2-8a88-dc31356f0bf5&page=queryresults
[0m19:02:23.255137 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:d7354b1f-e95e-4cb6-b2d6-ff742b9492d0&page=queryresults
[0m19:02:23.800489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb6640340>]}
[0m19:02:23.803295 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb71aeb00>]}
[0m19:02:23.808577 [info ] [Thread-1 (]: 1 of 16 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m19:02:23.815347 [info ] [Thread-2 (]: 2 of 16 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m19:02:23.819914 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m19:02:23.825869 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m19:02:23.829244 [debug] [Thread-1 (]: Began running node model.home_exchange.my_first_dbt_model
[0m19:02:23.837696 [debug] [Thread-2 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:02:23.835672 [info ] [Thread-1 (]: 3 of 16 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m19:02:23.846119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.my_first_dbt_model)
[0m19:02:23.842184 [info ] [Thread-2 (]: 4 of 16 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m19:02:23.849221 [debug] [Thread-1 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m19:02:23.851819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.exchanges_cleaning)
[0m19:02:23.865568 [debug] [Thread-2 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:02:23.871808 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m19:02:23.908130 [debug] [Thread-1 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m19:02:23.905945 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:02:23.961593 [debug] [Thread-2 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:02:23.997201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:24.127258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:24.157139 [debug] [Thread-2 (]: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m19:02:24.158686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b39ee60>]}
[0m19:02:24.160380 [error] [Thread-2 (]: 4 of 16 ERROR creating sql table model home_exchange.exchanges_cleaning ........ [[31mERROR[0m in 0.31s]
[0m19:02:24.162882 [debug] [Thread-2 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:02:24.164278 [debug] [Thread-2 (]: Began running node model.home_exchange.test
[0m19:02:24.165749 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config.
[0m19:02:24.167459 [info ] [Thread-2 (]: 5 of 16 START sql table model home_exchange.test ............................... [RUN]
[0m19:02:24.171440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.test)
[0m19:02:24.173850 [debug] [Thread-2 (]: Began compiling node model.home_exchange.test
[0m19:02:24.185064 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.test"
[0m19:02:24.186621 [debug] [Thread-2 (]: Began executing node model.home_exchange.test
[0m19:02:24.197823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:24.701435 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m19:02:24.704561 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.test"
[0m19:02:24.707271 [debug] [Thread-2 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:02:24.708795 [debug] [Thread-1 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:02:25.134181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:342d8e49-0202-4eec-8eb6-b79aa3b25ec4&page=queryresults
[0m19:02:25.407189 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:fc04951d-bbba-4357-967e-201c2622c885&page=queryresults
[0m19:02:28.642138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b39de70>]}
[0m19:02:28.648000 [info ] [Thread-1 (]: 3 of 16 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.80s]
[0m19:02:28.661971 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m19:02:28.673702 [debug] [Thread-1 (]: Began running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:02:28.679840 [info ] [Thread-1 (]: 6 of 16 SKIP test accepted_range_exchanges_cleaning_calculated_night_count__365__0  [[33mSKIP[0m]
[0m19:02:28.682830 [debug] [Thread-1 (]: Finished running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:02:28.686711 [debug] [Thread-1 (]: Began running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:02:28.688621 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee' to be skipped because of status 'skipped'. 
[0m19:02:28.690472 [info ] [Thread-1 (]: 7 of 16 SKIP test accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [[33mSKIP[0m]
[0m19:02:28.693970 [debug] [Thread-1 (]: Finished running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:02:28.695839 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:02:28.697782 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b' to be skipped because of status 'skipped'. 
[0m19:02:28.699790 [info ] [Thread-1 (]: 8 of 16 SKIP test not_null_exchanges_cleaning_conversation_id .................. [[33mSKIP[0m]
[0m19:02:28.705853 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:02:28.707780 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:02:28.709652 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21' to be skipped because of status 'skipped'. 
[0m19:02:28.711402 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_exchanges_cleaning_end_on ........................... [[33mSKIP[0m]
[0m19:02:28.714847 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:02:28.716584 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:02:28.719519 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59' to be skipped because of status 'skipped'. 
[0m19:02:28.722131 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_exchanges_cleaning_start_on ........................ [[33mSKIP[0m]
[0m19:02:28.730070 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:02:28.733732 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:02:28.737000 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' to be skipped because of status 'skipped'. 
[0m19:02:28.741410 [info ] [Thread-1 (]: 11 of 16 SKIP test unique_exchanges_cleaning_conversation_id ................... [[33mSKIP[0m]
[0m19:02:28.748653 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:02:28.750944 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:02:28.753813 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' to be skipped because of status 'skipped'. 
[0m19:02:28.756782 [info ] [Thread-1 (]: 12 of 16 START test not_null_my_first_dbt_model_id ............................. [RUN]
[0m19:02:28.765789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:02:28.776063 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:02:28.837366 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:02:28.839730 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:02:28.883089 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:02:28.885582 [debug] [Thread-1 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:02:28.886970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:29.060193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fe48125-6248-450c-a9ef-a85a10c93f8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b39edd0>]}
[0m19:02:29.063084 [info ] [Thread-2 (]: 5 of 16 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.89s]
[0m19:02:29.067168 [debug] [Thread-2 (]: Finished running node model.home_exchange.test
[0m19:02:29.069676 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:02:29.072123 [info ] [Thread-2 (]: 13 of 16 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m19:02:29.074723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m19:02:29.076477 [debug] [Thread-2 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:02:29.111174 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:02:29.122653 [debug] [Thread-2 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:02:29.141376 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:02:29.144384 [debug] [Thread-2 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:02:29.146975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:02:29.656399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:e5241d6a-c8a2-4e0d-ae4a-42d211911df2&page=queryresults
[0m19:02:30.048735 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:c3ecf8bb-f69f-424e-9bcb-92f374c8ceb5&page=queryresults
[0m19:02:30.211232 [error] [Thread-1 (]: 12 of 16 FAIL 1 not_null_my_first_dbt_model_id ................................. [[31mFAIL 1[0m in 1.45s]
[0m19:02:30.215221 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:02:30.220147 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m19:02:30.669012 [info ] [Thread-2 (]: 13 of 16 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.59s]
[0m19:02:30.675594 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:02:30.682351 [debug] [Thread-1 (]: Began running node model.home_exchange.my_second_dbt_model
[0m19:02:30.687227 [info ] [Thread-1 (]: 14 of 16 SKIP relation home_exchange.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m19:02:30.692906 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m19:02:30.697313 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m19:02:30.708495 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:02:30.711308 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:02:30.714520 [info ] [Thread-2 (]: 15 of 16 SKIP test not_null_my_second_dbt_model_id ............................. [[33mSKIP[0m]
[0m19:02:30.726208 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:02:30.719769 [info ] [Thread-1 (]: 16 of 16 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m19:02:30.730759 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m19:02:30.736070 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:02:30.741987 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m19:02:30.753170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:30.763246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:30.766943 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m19:02:30.770542 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:02:30.775015 [info ] [MainThread]: 
[0m19:02:30.778127 [info ] [MainThread]: Finished running 3 table models, 10 data tests, 3 view models in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m19:02:30.802906 [debug] [MainThread]: Command end result
[0m19:02:30.927015 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:02:30.930860 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:02:30.953485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:02:30.954591 [info ] [MainThread]: 
[0m19:02:30.955991 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:02:30.957827 [info ] [MainThread]: 
[0m19:02:30.959287 [error] [MainThread]:   Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m19:02:30.960360 [info ] [MainThread]: 
[0m19:02:30.961631 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:02:30.963121 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:02:30.964242 [info ] [MainThread]: 
[0m19:02:30.966803 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m19:02:30.969841 [info ] [MainThread]: 
[0m19:02:30.971041 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=9 TOTAL=16
[0m19:02:30.975964 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 12.667157, "process_in_blocks": "2584", "process_kernel_time": 0.538412, "process_mem_max_rss": "219460", "process_out_blocks": "2392", "process_user_time": 7.954289}
[0m19:02:30.977297 [debug] [MainThread]: Command `dbt build` failed at 19:02:30.976971 after 12.67 seconds
[0m19:02:30.978326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb654b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bb61def80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b984a8670>]}
[0m19:02:30.979401 [debug] [MainThread]: Flushing usage events
[0m19:02:32.212376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:36.154513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002627640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001a6a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001a6a800>]}


============================== 19:04:36.168362 | 6b221f4b-7ef5-4054-895f-77562a698d72 ==============================
[0m19:04:36.168362 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:04:36.170811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:04:38.197045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9003709810>]}
[0m19:04:38.376941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe7bca500>]}
[0m19:04:38.379471 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:04:38.813041 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:04:39.397157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:39.398317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:39.587565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe7a1c8e0>]}
[0m19:04:39.977695 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:04:39.987505 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:04:40.072359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe76f3f70>]}
[0m19:04:40.073585 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:04:40.084765 [info ] [MainThread]: 
[0m19:04:40.086194 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:04:40.087531 [info ] [MainThread]: 
[0m19:04:40.090283 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:04:40.109984 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:04:40.112723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:41.123270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:04:41.124721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:42.607345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9001d12d10>]}
[0m19:04:42.609200 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:04:42.619756 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m19:04:42.621555 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m19:04:42.623011 [info ] [Thread-1 (]: 1 of 16 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m19:04:42.625112 [info ] [Thread-2 (]: 2 of 16 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m19:04:42.627439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m19:04:42.629279 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m19:04:42.631468 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m19:04:42.633272 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m19:04:42.716058 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:04:42.722922 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m19:04:42.725534 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m19:04:42.727727 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m19:04:42.988349 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:04:42.990598 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m19:04:42.994139 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:04:42.996059 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:04:42.997668 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:04:42.999595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:44.964855 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:c688e5b1-3d9a-472b-aa39-6b623bb9884c&page=queryresults
[0m19:04:45.108952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:7ae55974-ded9-4e90-9676-45b1a851112e&page=queryresults
[0m19:04:45.763624 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe7b55900>]}
[0m19:04:45.765254 [info ] [Thread-2 (]: 2 of 16 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 3.13s]
[0m19:04:45.767469 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m19:04:45.770430 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m19:04:45.772684 [info ] [Thread-2 (]: 3 of 16 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m19:04:45.774382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m19:04:45.775379 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m19:04:45.781661 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m19:04:45.784783 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m19:04:45.836263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe73f9ab0>]}
[0m19:04:45.844809 [info ] [Thread-1 (]: 1 of 16 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 3.21s]
[0m19:04:45.868170 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m19:04:45.877682 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:04:45.887400 [info ] [Thread-1 (]: 4 of 16 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m19:04:45.896441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:04:45.898404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.exchanges_cleaning)
[0m19:04:45.982702 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:04:46.002400 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:04:46.009165 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:04:46.072587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:46.094079 [debug] [Thread-1 (]: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m19:04:46.095722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe4797970>]}
[0m19:04:46.099058 [error] [Thread-1 (]: 4 of 16 ERROR creating sql table model home_exchange.exchanges_cleaning ........ [[31mERROR[0m in 0.20s]
[0m19:04:46.104306 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:04:46.105263 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m19:04:46.106513 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config.
[0m19:04:46.107523 [info ] [Thread-1 (]: 5 of 16 START sql table model home_exchange.test ............................... [RUN]
[0m19:04:46.111275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.test)
[0m19:04:46.113488 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m19:04:46.138737 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m19:04:46.145292 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m19:04:46.157532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:47.743893 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m19:04:47.746280 [debug] [Thread-2 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:04:47.758465 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m19:04:47.772954 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:04:48.456341 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:fdd72f2d-24ed-4b32-85b1-7c8e87f1931a&page=queryresults
[0m19:04:48.603010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8cf2973a-1b35-4a2f-b658-10251f602690&page=queryresults
[0m19:04:52.386966 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe47bace0>]}
[0m19:04:52.393300 [info ] [Thread-2 (]: 3 of 16 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 6.61s]
[0m19:04:52.399266 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m19:04:52.406686 [debug] [Thread-2 (]: Began running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:04:52.410025 [info ] [Thread-2 (]: 6 of 16 SKIP test accepted_range_exchanges_cleaning_calculated_night_count__365__0  [[33mSKIP[0m]
[0m19:04:52.419169 [debug] [Thread-2 (]: Finished running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:04:52.421512 [debug] [Thread-2 (]: Began running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:04:52.423776 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee' to be skipped because of status 'skipped'. 
[0m19:04:52.441555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b221f4b-7ef5-4054-895f-77562a698d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe76367a0>]}
[0m19:04:52.445320 [info ] [Thread-2 (]: 7 of 16 SKIP test accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [[33mSKIP[0m]
[0m19:04:52.458186 [info ] [Thread-1 (]: 5 of 16 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 6.33s]
[0m19:04:52.471786 [debug] [Thread-2 (]: Finished running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:04:52.475863 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m19:04:52.482283 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:04:52.485165 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b' to be skipped because of status 'skipped'. 
[0m19:04:52.487836 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:04:52.490794 [info ] [Thread-2 (]: 8 of 16 SKIP test not_null_exchanges_cleaning_conversation_id .................. [[33mSKIP[0m]
[0m19:04:52.505475 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_exchanges_cleaning_end_on ........................... [[33mSKIP[0m]
[0m19:04:52.517314 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:04:52.520890 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:04:52.522995 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:04:52.524855 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21' to be skipped because of status 'skipped'. 
[0m19:04:52.531503 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:04:52.533629 [info ] [Thread-2 (]: 10 of 16 SKIP test not_null_exchanges_cleaning_start_on ........................ [[33mSKIP[0m]
[0m19:04:52.535466 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59' to be skipped because of status 'skipped'. 
[0m19:04:52.536919 [info ] [Thread-1 (]: 11 of 16 SKIP test unique_exchanges_cleaning_conversation_id ................... [[33mSKIP[0m]
[0m19:04:52.540111 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:04:52.542977 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:04:52.548359 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:04:52.549959 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' to be skipped because of status 'skipped'. 
[0m19:04:52.552622 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:04:52.555602 [info ] [Thread-2 (]: 12 of 16 START test not_null_my_first_dbt_model_id ............................. [RUN]
[0m19:04:52.558370 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' to be skipped because of status 'skipped'. 
[0m19:04:52.561890 [info ] [Thread-1 (]: 13 of 16 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m19:04:52.566457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:04:52.570956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m19:04:52.574384 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:04:52.578174 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:04:52.672653 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:04:52.681269 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:04:52.683995 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:04:52.686041 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:04:52.794009 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:04:52.795459 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:04:52.798415 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:04:52.800236 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:04:52.802784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:52.804578 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:04:54.803495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:d8c80ebe-c5e1-4b47-abe8-61c7fb02735f&page=queryresults
[0m19:04:54.853491 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:544d8fb6-047e-4fee-bc50-c87005065720&page=queryresults
[0m19:04:55.936583 [info ] [Thread-1 (]: 13 of 16 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 3.37s]
[0m19:04:55.940283 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:04:56.036705 [error] [Thread-2 (]: 12 of 16 FAIL 1 not_null_my_first_dbt_model_id ................................. [[31mFAIL 1[0m in 3.47s]
[0m19:04:56.041249 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:04:56.048720 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m19:04:56.057870 [debug] [Thread-1 (]: Began running node model.home_exchange.my_second_dbt_model
[0m19:04:56.060436 [info ] [Thread-1 (]: 14 of 16 SKIP relation home_exchange.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m19:04:56.062851 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m19:04:56.064815 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m19:04:56.067476 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:04:56.069501 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:04:56.071739 [info ] [Thread-2 (]: 15 of 16 SKIP test not_null_my_second_dbt_model_id ............................. [[33mSKIP[0m]
[0m19:04:56.078230 [info ] [Thread-1 (]: 16 of 16 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m19:04:56.081883 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:04:56.083639 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:04:56.085361 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m19:04:56.088164 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m19:04:56.103518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:56.118622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:56.121007 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:04:56.122606 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m19:04:56.125214 [info ] [MainThread]: 
[0m19:04:56.138028 [info ] [MainThread]: Finished running 3 table models, 10 data tests, 3 view models in 0 hours 0 minutes and 16.04 seconds (16.04s).
[0m19:04:56.163149 [debug] [MainThread]: Command end result
[0m19:04:56.341439 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:04:56.346405 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:04:56.372107 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:04:56.373146 [info ] [MainThread]: 
[0m19:04:56.376292 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:04:56.377976 [info ] [MainThread]: 
[0m19:04:56.379885 [error] [MainThread]:   Runtime Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Could not parse partition config
[0m19:04:56.381592 [info ] [MainThread]: 
[0m19:04:56.383695 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:04:56.386109 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:04:56.394319 [info ] [MainThread]: 
[0m19:04:56.395962 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m19:04:56.397289 [info ] [MainThread]: 
[0m19:04:56.399067 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=9 TOTAL=16
[0m19:04:56.451796 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 20.49778, "process_in_blocks": "2576", "process_kernel_time": 0.604861, "process_mem_max_rss": "219660", "process_out_blocks": "2384", "process_user_time": 11.270581}
[0m19:04:56.454707 [debug] [MainThread]: Command `dbt build` failed at 19:04:56.454107 after 20.50 seconds
[0m19:04:56.465673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9002627640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900257e830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fe45998d0>]}
[0m19:04:56.467781 [debug] [MainThread]: Flushing usage events
[0m19:04:58.144455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:44.898194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276fe976a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276f77e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276f77d330>]}


============================== 19:09:44.903029 | efa807ad-5217-487f-9d2f-a76cef267581 ==============================
[0m19:09:44.903029 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:09:44.904832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m19:09:46.322641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f275951ab60>]}
[0m19:09:46.476230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276f2d4190>]}
[0m19:09:46.477430 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:09:46.800922 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:09:47.193410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:47.194182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:47.314410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2758e28d60>]}
[0m19:09:47.578747 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:09:47.584235 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:09:47.628774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2758faebc0>]}
[0m19:09:47.630299 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:09:47.635977 [info ] [MainThread]: 
[0m19:09:47.637120 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:09:47.638308 [info ] [MainThread]: 
[0m19:09:47.641651 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:09:47.653071 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:09:47.654753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:48.392209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:09:48.393277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:49.013089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f277057bf10>]}
[0m19:09:49.014254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:09:49.027800 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m19:09:49.029121 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m19:09:49.030513 [info ] [Thread-1 (]: 1 of 16 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m19:09:49.032262 [info ] [Thread-2 (]: 2 of 16 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m19:09:49.033979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m19:09:49.035316 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m19:09:49.036411 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m19:09:49.037695 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m19:09:49.104035 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:09:49.116171 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m19:09:49.120368 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m19:09:49.133703 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m19:09:49.287965 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m19:09:49.282835 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:09:49.291365 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:09:49.292982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:49.294135 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:09:49.340867 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:09:50.357243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:50ba1b44-3c3a-4cf0-89de-679d3fb894d3&page=queryresults
[0m19:09:50.366033 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a048ec10-cc77-4fea-bd4b-0232e1256b93&page=queryresults
[0m19:09:50.885314 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2770dfebf0>]}
[0m19:09:50.886409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27583371f0>]}
[0m19:09:50.888399 [info ] [Thread-2 (]: 2 of 16 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 1.85s]
[0m19:09:50.890892 [info ] [Thread-1 (]: 1 of 16 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 1.85s]
[0m19:09:50.893062 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m19:09:50.894564 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m19:09:50.895657 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m19:09:50.899168 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:09:50.898285 [info ] [Thread-2 (]: 3 of 16 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m19:09:50.901428 [info ] [Thread-1 (]: 4 of 16 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m19:09:50.903606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m19:09:50.907921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.exchanges_cleaning)
[0m19:09:50.909181 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m19:09:50.911273 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:09:50.917816 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m19:09:50.935092 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:09:50.937857 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m19:09:50.952081 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:09:51.021607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:09:51.135900 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:09:51.142731 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      



WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- Column renaming and handling
        COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
    WHERE
        -- Basic data validation
        created_at IS NOT NULL
        AND start_on IS NOT NULL
        AND end_on IS NOT NULL
),

-- Conversation count analysis
conversation_counts AS (
    SELECT
        conversation_id,
        COUNT(*) AS conversation_count
    FROM cleaned_exchanges
    GROUP BY conversation_id
),

-- Advanced filtering
filtered_exchanges AS (
    SELECT e.*
    FROM cleaned_exchanges e
    LEFT JOIN conversation_counts cc
        ON e.conversation_id = cc.conversation_id
    WHERE
        -- Cancellation logic
        NOT (
            (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
            (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
            (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
        )

        -- Date range validation
        AND e.start_on < e.end_on

        -- Conversation filtering
        AND NOT (
            (cc.conversation_count = 3) OR
            (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
            (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
        )
),

-- Final transformations
final_exchanges AS (
    SELECT
        *,
        -- Night count calculation
        DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

        -- Optional: Validate existing night_count
        CASE
            WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
            THEN DATE_DIFF(end_on, start_on, DAY)
            ELSE night_count
        END AS corrected_night_count

    FROM filtered_exchanges
)

SELECT * FROM final_exchanges
    );
  
[0m19:09:51.144662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:51.779959 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m19:09:51.781447 [debug] [Thread-2 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:09:52.272113 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:87c2068e-b2b3-43b2-9f43-61b8a2a4d918&page=queryresults
[0m19:09:52.419022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:e68bef50-390e-4fa2-ab73-6c1f8d33f5f4&page=queryresults
[0m19:09:52.560022 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:e68bef50-390e-4fa2-ab73-6c1f8d33f5f4&page=queryresults
[0m19:09:52.577131 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [33:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:09:52.578745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2758337a00>]}
[0m19:09:52.580352 [error] [Thread-1 (]: 4 of 16 ERROR creating sql table model home_exchange.exchanges_cleaning ........ [[31mERROR[0m in 1.67s]
[0m19:09:52.581926 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:09:52.583095 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m19:09:52.585541 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [33:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:09:52.589740 [info ] [Thread-1 (]: 5 of 16 START sql table model home_exchange.test ............................... [RUN]
[0m19:09:52.593713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.test)
[0m19:09:52.594779 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m19:09:52.605066 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m19:09:52.612908 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m19:09:52.624257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:54.630014 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2758335c90>]}
[0m19:09:54.632666 [info ] [Thread-2 (]: 3 of 16 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.73s]
[0m19:09:54.634556 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m19:09:54.635535 [debug] [Thread-2 (]: Began running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:09:54.637069 [info ] [Thread-2 (]: 6 of 16 SKIP test accepted_range_exchanges_cleaning_calculated_night_count__365__0  [[33mSKIP[0m]
[0m19:09:54.638564 [debug] [Thread-2 (]: Finished running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:09:54.639616 [debug] [Thread-2 (]: Began running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:09:54.641055 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee' to be skipped because of status 'skipped'. 
[0m19:09:54.642412 [info ] [Thread-2 (]: 7 of 16 SKIP test accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [[33mSKIP[0m]
[0m19:09:54.644625 [debug] [Thread-2 (]: Finished running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:09:54.645620 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:09:54.646432 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b' to be skipped because of status 'skipped'. 
[0m19:09:54.648949 [info ] [Thread-2 (]: 8 of 16 SKIP test not_null_exchanges_cleaning_conversation_id .................. [[33mSKIP[0m]
[0m19:09:54.653364 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:09:54.655488 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:09:54.658227 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21' to be skipped because of status 'skipped'. 
[0m19:09:54.660286 [info ] [Thread-2 (]: 9 of 16 SKIP test not_null_exchanges_cleaning_end_on ........................... [[33mSKIP[0m]
[0m19:09:54.663366 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:09:54.664521 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:09:54.665884 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59' to be skipped because of status 'skipped'. 
[0m19:09:54.668723 [info ] [Thread-2 (]: 10 of 16 SKIP test not_null_exchanges_cleaning_start_on ........................ [[33mSKIP[0m]
[0m19:09:54.674733 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:09:54.685424 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:09:54.687531 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' to be skipped because of status 'skipped'. 
[0m19:09:54.693389 [info ] [Thread-2 (]: 11 of 16 SKIP test unique_exchanges_cleaning_conversation_id ................... [[33mSKIP[0m]
[0m19:09:54.697111 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:09:54.701680 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:09:54.704188 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' to be skipped because of status 'skipped'. 
[0m19:09:54.711225 [info ] [Thread-2 (]: 12 of 16 START test not_null_my_first_dbt_model_id ............................. [RUN]
[0m19:09:54.715901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:09:54.717954 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:09:54.836403 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:09:54.844918 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:09:54.925481 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:09:54.929706 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:09:54.931982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:09:56.040134 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:6d2855b1-f7a7-47c8-9720-7aa4469f10e4&page=queryresults
[0m19:09:56.628873 [error] [Thread-2 (]: 12 of 16 FAIL 1 not_null_my_first_dbt_model_id ................................. [[31mFAIL 1[0m in 1.91s]
[0m19:09:56.631549 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:09:56.632610 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:09:56.633986 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m19:09:56.634979 [info ] [Thread-2 (]: 13 of 16 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m19:09:56.637007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m19:09:56.638092 [debug] [Thread-2 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:09:56.655327 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:09:56.656474 [debug] [Thread-2 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:09:56.663748 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:09:56.665383 [debug] [Thread-2 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:09:56.673505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:09:57.792646 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:74cf3a52-eaa6-469c-a128-cbc9a5130d1d&page=queryresults
[0m19:09:58.429254 [info ] [Thread-2 (]: 13 of 16 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.79s]
[0m19:09:58.439304 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:09:58.441226 [debug] [Thread-2 (]: Began running node model.home_exchange.my_second_dbt_model
[0m19:09:58.442157 [info ] [Thread-2 (]: 14 of 16 SKIP relation home_exchange.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m19:09:58.443219 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m19:09:58.445016 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m19:09:58.447913 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:09:58.453626 [info ] [Thread-2 (]: 15 of 16 SKIP test not_null_my_second_dbt_model_id ............................. [[33mSKIP[0m]
[0m19:09:58.455836 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:09:58.457771 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:09:58.458641 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m19:09:58.461739 [info ] [Thread-2 (]: 16 of 16 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m19:09:58.468059 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:09:58.470592 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m19:10:08.305045 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m19:10:08.306457 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:10:08.978441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:4497b8a2-7099-44fc-b255-1db400c79a8f&page=queryresults
[0m19:10:12.446849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa807ad-5217-487f-9d2f-a76cef267581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2751ee7eb0>]}
[0m19:10:12.451049 [info ] [Thread-1 (]: 5 of 16 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 19.85s]
[0m19:10:12.454209 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m19:10:12.461684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:10:12.470371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:10:12.472952 [debug] [MainThread]: Connection 'model.home_exchange.test' was properly closed.
[0m19:10:12.475129 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:10:12.478232 [info ] [MainThread]: 
[0m19:10:12.481371 [info ] [MainThread]: Finished running 3 table models, 10 data tests, 3 view models in 0 hours 0 minutes and 24.84 seconds (24.84s).
[0m19:10:12.496257 [debug] [MainThread]: Command end result
[0m19:10:12.610965 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:10:12.614243 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:10:12.634355 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:10:12.635240 [info ] [MainThread]: 
[0m19:10:12.636831 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:10:12.639709 [info ] [MainThread]: 
[0m19:10:12.641608 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [33:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:10:12.642846 [info ] [MainThread]: 
[0m19:10:12.644030 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:10:12.645128 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:10:12.646335 [info ] [MainThread]: 
[0m19:10:12.652804 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m19:10:12.654838 [info ] [MainThread]: 
[0m19:10:12.656402 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=9 TOTAL=16
[0m19:10:12.659632 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 27.900936, "process_in_blocks": "296", "process_kernel_time": 0.501544, "process_mem_max_rss": "221100", "process_out_blocks": "2400", "process_user_time": 8.195229}
[0m19:10:12.661528 [debug] [MainThread]: Command `dbt build` failed at 19:10:12.661160 after 27.90 seconds
[0m19:10:12.665173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276fe976a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2759398be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276fe00c70>]}
[0m19:10:12.668607 [debug] [MainThread]: Flushing usage events
[0m19:10:13.639002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:49.428880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d75f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d046140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d045330>]}


============================== 19:11:49.433509 | a74df59d-2bdc-4175-90c2-f7d18076357d ==============================
[0m19:11:49.433509 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:11:49.435300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:51.455657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3772be74f0>]}
[0m19:11:51.598825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3772d6d750>]}
[0m19:11:51.600435 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:11:51.873570 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:11:52.281429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:11:52.282279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:11:52.406073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37726f97b0>]}
[0m19:11:52.680644 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:11:52.686607 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:11:52.734066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37726f8ca0>]}
[0m19:11:52.735287 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:11:52.741526 [info ] [MainThread]: 
[0m19:11:52.742560 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:11:52.743505 [info ] [MainThread]: 
[0m19:11:52.744826 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:11:52.755318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:11:52.759126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:54.030529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:11:54.032174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:55.361726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378e440e50>]}
[0m19:11:55.362869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:55.369947 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m19:11:55.370961 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m19:11:55.372352 [info ] [Thread-1 (]: 1 of 16 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m19:11:55.374575 [info ] [Thread-2 (]: 2 of 16 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m19:11:55.376347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m19:11:55.378220 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m19:11:55.379708 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m19:11:55.381081 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m19:11:55.472403 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m19:11:55.474081 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:11:55.475908 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m19:11:55.482321 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m19:11:55.596172 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:11:55.600251 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m19:11:55.603028 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:11:55.604769 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:11:55.606098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:55.607581 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:11:57.325744 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:655bd159-fc2d-49f3-aff1-ab4c36cf102b&page=queryresults
[0m19:11:57.348707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a8e55879-14df-4603-8409-27fcbb33a47f&page=queryresults
[0m19:11:58.606515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378e6c6bf0>]}
[0m19:11:58.608233 [info ] [Thread-2 (]: 2 of 16 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 3.23s]
[0m19:11:58.611400 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m19:11:58.612579 [debug] [Thread-2 (]: Began running node model.home_exchange.my_first_dbt_model
[0m19:11:58.614001 [info ] [Thread-2 (]: 3 of 16 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m19:11:58.617590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.my_first_dbt_model)
[0m19:11:58.621417 [debug] [Thread-2 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m19:11:58.627288 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m19:11:58.628562 [debug] [Thread-2 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m19:11:58.688417 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:11:58.741180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37637529e0>]}
[0m19:11:58.745123 [info ] [Thread-1 (]: 1 of 16 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 3.36s]
[0m19:11:58.748564 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m19:11:58.749926 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:11:58.752458 [info ] [Thread-1 (]: 4 of 16 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m19:11:58.753953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.exchanges_cleaning)
[0m19:11:58.755066 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:11:58.763111 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:11:58.764444 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:11:58.848385 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:11:58.850407 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      



WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- Column renaming and handling
        COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
    WHERE
        -- Basic data validation
        created_at IS NOT NULL
        AND start_on IS NOT NULL
        AND end_on IS NOT NULL
),

-- Conversation count analysis
conversation_counts AS (
    SELECT
        conversation_id,
        COUNT(*) AS conversation_count
    FROM cleaned_exchanges
    GROUP BY conversation_id
),

-- Advanced filtering
filtered_exchanges AS (
    SELECT e.*
    FROM cleaned_exchanges e
    LEFT JOIN conversation_counts cc
        ON e.conversation_id = cc.conversation_id
    WHERE
        -- Cancellation logic
        NOT (
            (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
            (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
            (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
        )

        -- Date range validation
        AND e.start_on < e.end_on

        -- Conversation filtering
        AND NOT (
            (cc.conversation_count = 3) OR
            (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
            (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
        )
),

-- Final transformations
final_exchanges AS (
    SELECT
        *,
        -- Night count calculation
        DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

        -- Optional: Validate existing night_count
        CASE
            WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
            THEN DATE_DIFF(end_on, start_on, DAY)
            ELSE night_count
        END AS corrected_night_count

    FROM filtered_exchanges
)

SELECT * FROM final_exchanges
    );
  
[0m19:11:58.852026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:00.437388 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m19:12:00.438907 [debug] [Thread-2 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:12:01.057351 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:9336cd75-14f0-462d-96c1-e099b10fdf03&page=queryresults
[0m19:12:01.062439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8236965b-ef6b-49c7-bf9a-9fd1514ab592&page=queryresults
[0m19:12:01.306198 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8236965b-ef6b-49c7-bf9a-9fd1514ab592&page=queryresults
[0m19:12:01.322067 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [33:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:12:01.323424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376373fdc0>]}
[0m19:12:01.324819 [error] [Thread-1 (]: 4 of 16 ERROR creating sql table model home_exchange.exchanges_cleaning ........ [[31mERROR[0m in 2.57s]
[0m19:12:01.326732 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:12:01.328060 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m19:12:01.331358 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [33:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:12:01.336670 [info ] [Thread-1 (]: 5 of 16 START sql table model home_exchange.test ............................... [RUN]
[0m19:12:01.349871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.test)
[0m19:12:01.355045 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m19:12:01.369968 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m19:12:01.372518 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m19:12:01.388176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:02.304373 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m19:12:02.305632 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:12:03.056848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:c1eed5d4-0b45-4782-b857-c302047c5918&page=queryresults
[0m19:12:04.164379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377017a6e0>]}
[0m19:12:04.165796 [info ] [Thread-2 (]: 3 of 16 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 5.55s]
[0m19:12:04.167919 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m19:12:04.169961 [debug] [Thread-2 (]: Began running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:12:04.171719 [info ] [Thread-2 (]: 6 of 16 SKIP test accepted_range_exchanges_cleaning_calculated_night_count__365__0  [[33mSKIP[0m]
[0m19:12:04.174137 [debug] [Thread-2 (]: Finished running node test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee
[0m19:12:04.175223 [debug] [Thread-2 (]: Began running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:12:04.176827 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_range_exchanges_cleaning_calculated_night_count__365__0.ba743a46ee' to be skipped because of status 'skipped'. 
[0m19:12:04.181891 [info ] [Thread-2 (]: 7 of 16 SKIP test accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [[33mSKIP[0m]
[0m19:12:04.184136 [debug] [Thread-2 (]: Finished running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:12:04.185397 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:12:04.186517 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b' to be skipped because of status 'skipped'. 
[0m19:12:04.187469 [info ] [Thread-2 (]: 8 of 16 SKIP test not_null_exchanges_cleaning_conversation_id .................. [[33mSKIP[0m]
[0m19:12:04.189736 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:12:04.192102 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:12:04.194520 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21' to be skipped because of status 'skipped'. 
[0m19:12:04.198099 [info ] [Thread-2 (]: 9 of 16 SKIP test not_null_exchanges_cleaning_end_on ........................... [[33mSKIP[0m]
[0m19:12:04.204379 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:12:04.206150 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:12:04.207505 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59' to be skipped because of status 'skipped'. 
[0m19:12:04.208889 [info ] [Thread-2 (]: 10 of 16 SKIP test not_null_exchanges_cleaning_start_on ........................ [[33mSKIP[0m]
[0m19:12:04.214646 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:12:04.217567 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:12:04.218827 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' to be skipped because of status 'skipped'. 
[0m19:12:04.220370 [info ] [Thread-2 (]: 11 of 16 SKIP test unique_exchanges_cleaning_conversation_id ................... [[33mSKIP[0m]
[0m19:12:04.223461 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:12:04.231392 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' to be skipped because of status 'skipped'. 
[0m19:12:04.232685 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:12:04.242467 [info ] [Thread-2 (]: 12 of 16 START test not_null_my_first_dbt_model_id ............................. [RUN]
[0m19:12:04.251863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:12:04.253765 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:12:04.314601 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:12:04.320325 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:12:04.377150 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:12:04.380339 [debug] [Thread-2 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:12:04.382309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:12:05.677358 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:c20b44c5-f22c-45eb-a2e6-ed782f2683cb&page=queryresults
[0m19:12:06.653342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74df59d-2bdc-4175-90c2-f7d18076357d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376372ada0>]}
[0m19:12:06.661236 [info ] [Thread-1 (]: 5 of 16 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.30s]
[0m19:12:06.664974 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m19:12:06.666636 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:12:06.668339 [info ] [Thread-1 (]: 13 of 16 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m19:12:06.670493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m19:12:06.675327 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:12:06.725909 [error] [Thread-2 (]: 12 of 16 FAIL 1 not_null_my_first_dbt_model_id ................................. [[31mFAIL 1[0m in 2.48s]
[0m19:12:06.752147 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:12:06.762490 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m19:12:06.758205 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:12:06.768082 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:12:06.786327 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:12:06.788519 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:12:06.790656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:12:08.421006 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:f667c92a-11cd-4516-b2b1-7a2ac64ffc87&page=queryresults
[0m19:12:09.335326 [info ] [Thread-1 (]: 13 of 16 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 2.66s]
[0m19:12:09.342012 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:12:09.352769 [debug] [Thread-2 (]: Began running node model.home_exchange.my_second_dbt_model
[0m19:12:09.357174 [info ] [Thread-2 (]: 14 of 16 SKIP relation home_exchange.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m19:12:09.361150 [debug] [Thread-2 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m19:12:09.363186 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m19:12:09.365304 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:12:09.366223 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:12:09.367535 [info ] [Thread-1 (]: 15 of 16 SKIP test not_null_my_second_dbt_model_id ............................. [[33mSKIP[0m]
[0m19:12:09.369524 [info ] [Thread-2 (]: 16 of 16 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m19:12:09.372799 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:12:09.374586 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:12:09.381726 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m19:12:09.385374 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m19:12:09.395390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:09.399021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:09.400631 [debug] [MainThread]: Connection 'test.home_exchange.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:12:09.401478 [debug] [MainThread]: Connection 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m19:12:09.402600 [info ] [MainThread]: 
[0m19:12:09.406004 [info ] [MainThread]: Finished running 3 table models, 10 data tests, 3 view models in 0 hours 0 minutes and 16.66 seconds (16.66s).
[0m19:12:09.413662 [debug] [MainThread]: Command end result
[0m19:12:09.568677 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:12:09.572292 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:12:09.589863 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:12:09.591036 [info ] [MainThread]: 
[0m19:12:09.593777 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:12:09.596309 [info ] [MainThread]: 
[0m19:12:09.597898 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [33:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:12:09.598958 [info ] [MainThread]: 
[0m19:12:09.600470 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:12:09.601904 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:12:09.602980 [info ] [MainThread]: 
[0m19:12:09.605731 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m19:12:09.607257 [info ] [MainThread]: 
[0m19:12:09.609042 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=9 TOTAL=16
[0m19:12:09.611839 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 20.311949, "process_in_blocks": "0", "process_kernel_time": 0.637638, "process_mem_max_rss": "220516", "process_out_blocks": "2408", "process_user_time": 8.390512}
[0m19:12:09.612903 [debug] [MainThread]: Command `dbt build` failed at 19:12:09.612634 after 20.31 seconds
[0m19:12:09.613731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d75f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3771c52500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d6c8c70>]}
[0m19:12:09.614547 [debug] [MainThread]: Flushing usage events
[0m19:12:10.640108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:23.895180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16782f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff166c6e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff166c6d120>]}


============================== 19:17:23.899921 | 69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4 ==============================
[0m19:17:23.899921 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:17:23.901710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select exchanges_cleaning', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:17:25.378768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1677882b0>]}
[0m19:17:25.532071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff166c6c4c0>]}
[0m19:17:25.533956 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:17:25.832855 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:17:26.232486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:26.233373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:26.350667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1507b93c0>]}
[0m19:17:26.655507 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:17:26.660444 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:17:26.683612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff150939930>]}
[0m19:17:26.684765 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:17:26.686348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff15093acb0>]}
[0m19:17:26.689949 [info ] [MainThread]: 
[0m19:17:26.691276 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:17:26.692342 [info ] [MainThread]: 
[0m19:17:26.693645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:17:26.697836 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:17:26.699465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:27.487748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:17:27.489063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:28.140604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1687974f0>]}
[0m19:17:28.142155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:28.149666 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:17:28.151275 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:17:28.153549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:17:28.154736 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:17:28.195077 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:17:28.196804 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:17:28.303730 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:17:28.305291 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- Column renaming and handling
        COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
    WHERE
        -- Basic data validation
        created_at IS NOT NULL
        AND start_on IS NOT NULL
        AND end_on IS NOT NULL
),

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:17:28.306467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:28.938642 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:d66eb588-fdaf-4b0b-8dbd-12f1bd6b9d2c&page=queryresults
[0m19:17:28.940645 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:d66eb588-fdaf-4b0b-8dbd-12f1bd6b9d2c&page=queryresults
[0m19:17:28.946595 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [87:1]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:17:28.950183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69ecefff-c3ef-41f5-aaab-6cfbdf15f6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1679fefb0>]}
[0m19:17:28.951836 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.exchanges_cleaning ......... [[31mERROR[0m in 0.79s]
[0m19:17:28.953344 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:17:28.954613 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [87:1]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:17:28.960444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:28.966058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:28.966941 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:17:28.967889 [info ] [MainThread]: 
[0m19:17:28.969114 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m19:17:28.973118 [debug] [MainThread]: Command end result
[0m19:17:29.088954 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:17:29.092638 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:17:29.117119 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:17:29.117977 [info ] [MainThread]: 
[0m19:17:29.119527 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:17:29.121466 [info ] [MainThread]: 
[0m19:17:29.122775 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [87:1]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:17:29.123828 [info ] [MainThread]: 
[0m19:17:29.125282 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:17:29.131635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.363435, "process_in_blocks": "0", "process_kernel_time": 0.301008, "process_mem_max_rss": "210988", "process_out_blocks": "2240", "process_user_time": 6.311136}
[0m19:17:29.136369 [debug] [MainThread]: Command `dbt run` failed at 19:17:29.135793 after 5.37 seconds
[0m19:17:29.138005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16782f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16778a830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1509d9f00>]}
[0m19:17:29.139206 [debug] [MainThread]: Flushing usage events
[0m19:17:29.983225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:13.357706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7afbcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7af2ba1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7af2bbb80>]}


============================== 19:18:13.362464 | 0549627e-3c8b-496d-abb1-17fd0859e747 ==============================
[0m19:18:13.362464 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:18:13.363961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select exchanges_cleaning', 'send_anonymous_usage_stats': 'True'}
[0m19:18:14.793653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0549627e-3c8b-496d-abb1-17fd0859e747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb799225f30>]}
[0m19:18:14.923902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0549627e-3c8b-496d-abb1-17fd0859e747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79918ab00>]}
[0m19:18:14.925196 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:18:15.287908 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:18:15.738806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:15.739815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:15.856259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0549627e-3c8b-496d-abb1-17fd0859e747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb798d38e80>]}
[0m19:18:16.100674 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:18:16.105813 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:18:16.127119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0549627e-3c8b-496d-abb1-17fd0859e747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb798d39870>]}
[0m19:18:16.128181 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:18:16.131414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0549627e-3c8b-496d-abb1-17fd0859e747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb798d393c0>]}
[0m19:18:16.135121 [info ] [MainThread]: 
[0m19:18:16.136702 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:18:16.137946 [info ] [MainThread]: 
[0m19:18:16.140094 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:18:16.145825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:18:16.147139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:16.780707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:18:16.782203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:17.416516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0549627e-3c8b-496d-abb1-17fd0859e747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b0f45720>]}
[0m19:18:17.418067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:17.434184 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:18:17.436510 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:18:17.439137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:18:17.451538 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:18:17.535270 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:18:17.537756 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:18:17.668648 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:18:17.671739 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- Column renaming and handling
        COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
    WHERE
        -- Basic data validation
        created_at IS NOT NULL
        AND start_on IS NOT NULL
        AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:18:17.673450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:18.866995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:800245f6-b61f-42f6-b325-8c9039114585&page=queryresults
[0m19:18:19.144828 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:800245f6-b61f-42f6-b325-8c9039114585&page=queryresults
[0m19:18:19.150933 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [31:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:18:19.159247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0549627e-3c8b-496d-abb1-17fd0859e747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb798d3cdf0>]}
[0m19:18:19.162305 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.exchanges_cleaning ......... [[31mERROR[0m in 1.71s]
[0m19:18:19.164294 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:18:19.165717 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [31:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:18:19.169970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:19.178119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:19.191618 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:18:19.193415 [info ] [MainThread]: 
[0m19:18:19.195339 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m19:18:19.198858 [debug] [MainThread]: Command end result
[0m19:18:19.382357 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:18:19.387575 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:18:19.425505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:18:19.427009 [info ] [MainThread]: 
[0m19:18:19.438647 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:18:19.441834 [info ] [MainThread]: 
[0m19:18:19.444493 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: created_at at [31:9]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:18:19.446526 [info ] [MainThread]: 
[0m19:18:19.448776 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:18:19.452291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2109103, "process_in_blocks": "0", "process_kernel_time": 0.400487, "process_mem_max_rss": "211804", "process_out_blocks": "2240", "process_user_time": 6.187525}
[0m19:18:19.453853 [debug] [MainThread]: Command `dbt run` failed at 19:18:19.453153 after 6.21 seconds
[0m19:18:19.459638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7afbcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79918ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7afb39750>]}
[0m19:18:19.465620 [debug] [MainThread]: Flushing usage events
[0m19:18:20.160866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:26.415159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c508f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5faf070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5fad030>]}


============================== 19:20:26.419602 | 8d8ff69b-0a06-4e5e-97be-68f4c12666bb ==============================
[0m19:20:26.419602 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:20:26.421791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select exchanges_cleaning', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:20:27.842738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d8ff69b-0a06-4e5e-97be-68f4c12666bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aa53fb80>]}
[0m19:20:27.979463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d8ff69b-0a06-4e5e-97be-68f4c12666bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c4914bb0>]}
[0m19:20:27.981061 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:20:28.287102 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:20:28.662021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:28.662869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:28.788086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d8ff69b-0a06-4e5e-97be-68f4c12666bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aa53c880>]}
[0m19:20:29.035302 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:20:29.041198 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:20:29.064163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d8ff69b-0a06-4e5e-97be-68f4c12666bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aa169900>]}
[0m19:20:29.065445 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:20:29.066739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8ff69b-0a06-4e5e-97be-68f4c12666bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aa16abf0>]}
[0m19:20:29.070444 [info ] [MainThread]: 
[0m19:20:29.071889 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:20:29.072899 [info ] [MainThread]: 
[0m19:20:29.074137 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:20:29.075931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:20:29.076942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:29.751586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:20:29.753755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:30.356692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d8ff69b-0a06-4e5e-97be-68f4c12666bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5ff7fa0>]}
[0m19:20:30.358177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:30.369900 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:20:30.373308 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:20:30.375213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:20:30.376480 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:20:30.414356 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:20:30.416150 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:20:30.537523 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:20:30.539479 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- Column renaming and handling
        COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
    WHERE
        -- Basic data validation
        created_at IS NOT NULL
        AND start_on IS NOT NULL
        AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:20:30.540840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:31.756729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:9c1cf45a-fd80-4d97-ac79-aa7a18ff552d&page=queryresults
[0m19:20:31.943250 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:9c1cf45a-fd80-4d97-ac79-aa7a18ff552d&page=queryresults
[0m19:20:31.953817 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: guest_count; Did you mean night_count? at [23:42]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:20:31.958575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d8ff69b-0a06-4e5e-97be-68f4c12666bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aa18ad70>]}
[0m19:20:31.960960 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.exchanges_cleaning ......... [[31mERROR[0m in 1.58s]
[0m19:20:31.967063 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:20:31.968719 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: guest_count; Did you mean night_count? at [23:42]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:20:31.973748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:31.976935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:31.979075 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:20:31.981462 [info ] [MainThread]: 
[0m19:20:31.990334 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m19:20:31.994314 [debug] [MainThread]: Command end result
[0m19:20:32.094669 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:20:32.099541 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:20:32.115989 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:20:32.116740 [info ] [MainThread]: 
[0m19:20:32.117865 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:20:32.119100 [info ] [MainThread]: 
[0m19:20:32.120308 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: guest_count; Did you mean night_count? at [23:42]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:20:32.121585 [info ] [MainThread]: 
[0m19:20:32.122632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:20:32.124449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.826626, "process_in_blocks": "0", "process_kernel_time": 0.270344, "process_mem_max_rss": "213924", "process_out_blocks": "2240", "process_user_time": 6.017668}
[0m19:20:32.125401 [debug] [MainThread]: Command `dbt run` failed at 19:20:32.125160 after 5.83 seconds
[0m19:20:32.126188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c508f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5aa1a5cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c4ffad40>]}
[0m19:20:32.127164 [debug] [MainThread]: Flushing usage events
[0m19:20:33.068337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:15.605916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31d46b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31e11a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31e11a6b0>]}


============================== 19:23:15.610695 | 9ea684ad-ab84-4b1e-920f-37b7367561f4 ==============================
[0m19:23:15.610695 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:23:15.613305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select exchanges_cleaning', 'send_anonymous_usage_stats': 'True'}
[0m19:23:17.087577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ea684ad-ab84-4b1e-920f-37b7367561f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb302667ac0>]}
[0m19:23:17.229317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ea684ad-ab84-4b1e-920f-37b7367561f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31cfcf160>]}
[0m19:23:17.230817 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:23:17.529779 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:23:17.937969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:17.938751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:18.058810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ea684ad-ab84-4b1e-920f-37b7367561f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3028360b0>]}
[0m19:23:18.316057 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:23:18.322162 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:23:18.343500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ea684ad-ab84-4b1e-920f-37b7367561f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3022eb2e0>]}
[0m19:23:18.344571 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:23:18.345595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea684ad-ab84-4b1e-920f-37b7367561f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3022e8d30>]}
[0m19:23:18.350184 [info ] [MainThread]: 
[0m19:23:18.351907 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:23:18.353628 [info ] [MainThread]: 
[0m19:23:18.355310 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:23:18.357382 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:23:18.358566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:19.161883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:23:19.163458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:23:19.792397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea684ad-ab84-4b1e-920f-37b7367561f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31d550340>]}
[0m19:23:19.793422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:19.799829 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:23:19.801281 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:23:19.802920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:23:19.804016 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:23:19.828725 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:23:19.830786 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:23:20.000045 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:23:20.004059 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,
        *

        -- -- Column renaming and handling
        -- COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- -- Preserve other columns
        -- * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
    -- WHERE
    --     -- Basic data validation
    --     created_at IS NOT NULL
    --     AND start_on IS NOT NULL
    --     AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:23:20.008172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:21.247163 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:3383289f-4062-4c6b-a257-77bd40af2862&page=queryresults
[0m19:23:21.437479 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:3383289f-4062-4c6b-a257-77bd40af2862&page=queryresults
[0m19:23:21.443248 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  CREATE TABLE has columns with duplicate name created_at at [15:1]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:23:21.450585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ea684ad-ab84-4b1e-920f-37b7367561f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3023697b0>]}
[0m19:23:21.452957 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.exchanges_cleaning ......... [[31mERROR[0m in 1.64s]
[0m19:23:21.455097 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:23:21.456503 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  CREATE TABLE has columns with duplicate name created_at at [15:1]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:23:21.461497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:21.471926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:21.473836 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:23:21.477050 [info ] [MainThread]: 
[0m19:23:21.479812 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m19:23:21.485846 [debug] [MainThread]: Command end result
[0m19:23:21.599440 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:23:21.602494 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:23:21.618677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:23:21.620726 [info ] [MainThread]: 
[0m19:23:21.622614 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:23:21.623684 [info ] [MainThread]: 
[0m19:23:21.624835 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  CREATE TABLE has columns with duplicate name created_at at [15:1]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:23:21.625704 [info ] [MainThread]: 
[0m19:23:21.626691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:23:21.632662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.142818, "process_in_blocks": "0", "process_kernel_time": 0.289595, "process_mem_max_rss": "212088", "process_out_blocks": "2240", "process_user_time": 6.001609}
[0m19:23:21.634564 [debug] [MainThread]: Command `dbt run` failed at 19:23:21.634147 after 6.15 seconds
[0m19:23:21.636286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31d46b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3022ff4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb302271000>]}
[0m19:23:21.637825 [debug] [MainThread]: Flushing usage events
[0m19:23:22.360519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:11.848087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bc023640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bb462110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bb461120>]}


============================== 19:24:11.853463 | 7dbdda50-8f72-413b-9ba1-527a81cd2bad ==============================
[0m19:24:11.853463 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:24:11.854970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select exchanges_cleaning', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:13.394639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dbdda50-8f72-413b-9ba1-527a81cd2bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bd101810>]}
[0m19:24:13.536727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dbdda50-8f72-413b-9ba1-527a81cd2bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a166ee30>]}
[0m19:24:13.537925 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:24:13.855720 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:24:14.246339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:14.247122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:14.369079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dbdda50-8f72-413b-9ba1-527a81cd2bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a0fa8ac0>]}
[0m19:24:14.668235 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:24:14.673778 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:24:14.702769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dbdda50-8f72-413b-9ba1-527a81cd2bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a0fa94b0>]}
[0m19:24:14.703912 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:24:14.705020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbdda50-8f72-413b-9ba1-527a81cd2bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bc57a740>]}
[0m19:24:14.708389 [info ] [MainThread]: 
[0m19:24:14.709856 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:24:14.710759 [info ] [MainThread]: 
[0m19:24:14.712370 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:24:14.714641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:24:14.715635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:15.321604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:24:15.322965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:15.912475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dbdda50-8f72-413b-9ba1-527a81cd2bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bcf45ab0>]}
[0m19:24:15.913575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:15.920265 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:24:15.921721 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:24:15.923351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:24:15.924450 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:24:15.948168 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:24:15.949424 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:24:16.093715 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:24:16.095075 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on

        -- -- Column renaming and handling
        -- COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- -- Preserve other columns
        -- * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
    -- WHERE
    --     -- Basic data validation
    --     created_at IS NOT NULL
    --     AND start_on IS NOT NULL
    --     AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:24:16.096200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:17.305975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:c273bde6-d237-46cb-b661-09d974044ee9&page=queryresults
[0m19:24:24.627021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dbdda50-8f72-413b-9ba1-527a81cd2bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a0fb5990>]}
[0m19:24:24.629715 [info ] [Thread-1 (]: 1 of 1 OK created sql table model home_exchange.exchanges_cleaning ............. [[32mCREATE TABLE (12.0m rows, 253.5 MiB processed)[0m in 8.70s]
[0m19:24:24.631912 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:24:24.635689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:24.639196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:24.640151 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:24:24.641080 [info ] [MainThread]: 
[0m19:24:24.642202 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.93 seconds (9.93s).
[0m19:24:24.647964 [debug] [MainThread]: Command end result
[0m19:24:24.763191 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:24:24.765997 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:24:24.786099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:24:24.786978 [info ] [MainThread]: 
[0m19:24:24.788282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:24.790175 [info ] [MainThread]: 
[0m19:24:24.791368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:24:24.795192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.069557, "process_in_blocks": "0", "process_kernel_time": 0.373015, "process_mem_max_rss": "216636", "process_out_blocks": "2232", "process_user_time": 6.532806}
[0m19:24:24.799795 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:24.796723 after 13.07 seconds
[0m19:24:24.802472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bc023640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5bbf7a830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a162d330>]}
[0m19:24:24.806136 [debug] [MainThread]: Flushing usage events
[0m19:24:25.626824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:32.960765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cc27f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cb302650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cb3026b0>]}


============================== 19:27:32.965922 | a10bc96d-ec53-4b20-b32d-b31557191112 ==============================
[0m19:27:32.965922 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:27:32.967592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select exchanges_cleaning', 'send_anonymous_usage_stats': 'True'}
[0m19:27:34.357850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a10bc96d-ec53-4b20-b32d-b31557191112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cd361840>]}
[0m19:27:34.487995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a10bc96d-ec53-4b20-b32d-b31557191112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cb87b4c0>]}
[0m19:27:34.489188 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:27:34.777375 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:27:35.171669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:35.172642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:35.287126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a10bc96d-ec53-4b20-b32d-b31557191112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b13e1480>]}
[0m19:27:35.551123 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:27:35.556748 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:27:35.581213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a10bc96d-ec53-4b20-b32d-b31557191112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b13687c0>]}
[0m19:27:35.582576 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:27:35.584214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10bc96d-ec53-4b20-b32d-b31557191112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b136b550>]}
[0m19:27:35.588254 [info ] [MainThread]: 
[0m19:27:35.590150 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:27:35.591872 [info ] [MainThread]: 
[0m19:27:35.594072 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:27:35.595884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:27:35.597167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:36.288601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:27:36.289951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:36.983009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10bc96d-ec53-4b20-b32d-b31557191112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cb6be380>]}
[0m19:27:36.984042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:36.993369 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:27:36.994562 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:27:36.996150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:27:36.997274 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:27:37.030116 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:27:37.031218 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:27:37.078438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:37.767558 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:27:37.769035 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- -- Column renaming and handling
        -- COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
    -- WHERE
    --     -- Basic data validation
    --     created_at IS NOT NULL
    --     AND start_on IS NOT NULL
    --     AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:27:38.650989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8e5a7678-85ff-4c3d-8a0f-b3393d0dd210&page=queryresults
[0m19:27:38.821186 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8e5a7678-85ff-4c3d-8a0f-b3393d0dd210&page=queryresults
[0m19:27:38.826630 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Column guest_count in SELECT * EXCEPT list does not exist at [26:72]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:27:38.830073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10bc96d-ec53-4b20-b32d-b31557191112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cc44c340>]}
[0m19:27:38.831422 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.exchanges_cleaning ......... [[31mERROR[0m in 1.83s]
[0m19:27:38.833644 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:27:38.838200 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Column guest_count in SELECT * EXCEPT list does not exist at [26:72]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:27:38.843114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:38.845946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:38.846671 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:27:38.847736 [info ] [MainThread]: 
[0m19:27:38.848729 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m19:27:38.853446 [debug] [MainThread]: Command end result
[0m19:27:39.009214 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:27:39.013185 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:27:39.027020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:27:39.027891 [info ] [MainThread]: 
[0m19:27:39.029138 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:27:39.030919 [info ] [MainThread]: 
[0m19:27:39.032359 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Column guest_count in SELECT * EXCEPT list does not exist at [26:72]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:27:39.034031 [info ] [MainThread]: 
[0m19:27:39.036514 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:27:39.042185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.195703, "process_in_blocks": "0", "process_kernel_time": 0.270728, "process_mem_max_rss": "211944", "process_out_blocks": "2232", "process_user_time": 5.865794}
[0m19:27:39.043298 [debug] [MainThread]: Command `dbt run` failed at 19:27:39.043000 after 6.20 seconds
[0m19:27:39.044078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cc27f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55cc44c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55b097f4c0>]}
[0m19:27:39.044936 [debug] [MainThread]: Flushing usage events
[0m19:27:39.885073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:28.307043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490de6b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490ddfeb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d2aa800>]}


============================== 19:28:28.312282 | f98cf0d4-0d28-4cb9-bf09-4a36341f18f2 ==============================
[0m19:28:28.312282 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:28:28.314172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'warn_error': 'None', 'log_path': '/root/home_exchange/home_exchange/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select exchanges_cleaning', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:29.791697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f98cf0d4-0d28-4cb9-bf09-4a36341f18f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490ddfd2a0>]}
[0m19:28:29.928550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f98cf0d4-0d28-4cb9-bf09-4a36341f18f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d2a8490>]}
[0m19:28:29.929940 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:28:30.243027 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:28:30.631578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:30.632589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:30.805059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f98cf0d4-0d28-4cb9-bf09-4a36341f18f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48f2fd1420>]}
[0m19:28:31.075444 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:28:31.080274 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:28:31.104001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f98cf0d4-0d28-4cb9-bf09-4a36341f18f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48f2f547f0>]}
[0m19:28:31.105081 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:28:31.106542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f98cf0d4-0d28-4cb9-bf09-4a36341f18f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48f2f559f0>]}
[0m19:28:31.109682 [info ] [MainThread]: 
[0m19:28:31.113111 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:28:31.114631 [info ] [MainThread]: 
[0m19:28:31.116214 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:28:31.120320 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:28:31.121710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:31.868221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:28:31.869778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:32.430330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f98cf0d4-0d28-4cb9-bf09-4a36341f18f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48f333c7f0>]}
[0m19:28:32.431585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:32.438295 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:28:32.440047 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:28:32.441629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:28:32.443971 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:28:32.474386 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:28:32.476908 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:28:32.514641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:33.138695 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:28:33.140635 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- -- Column renaming and handling
        -- COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
    -- WHERE
    --     -- Basic data validation
    --     created_at IS NOT NULL
    --     AND start_on IS NOT NULL
    --     AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:28:33.936557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:b180a0a4-54e2-4c17-8b8d-05db0cbb7bdd&page=queryresults
[0m19:28:42.144299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98cf0d4-0d28-4cb9-bf09-4a36341f18f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48f2f75f60>]}
[0m19:28:42.146084 [info ] [Thread-1 (]: 1 of 1 OK created sql table model home_exchange.exchanges_cleaning ............. [[32mCREATE TABLE (12.0m rows, 1.7 GiB processed)[0m in 9.70s]
[0m19:28:42.148203 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:28:42.153217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:42.156188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:42.156976 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:28:42.157782 [info ] [MainThread]: 
[0m19:28:42.158736 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.04 seconds (11.04s).
[0m19:28:42.160672 [debug] [MainThread]: Command end result
[0m19:28:42.277116 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:28:42.280294 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:28:42.297032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:28:42.297966 [info ] [MainThread]: 
[0m19:28:42.299857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:42.305872 [info ] [MainThread]: 
[0m19:28:42.308675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:28:42.311442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.137731, "process_in_blocks": "0", "process_kernel_time": 0.371762, "process_mem_max_rss": "215288", "process_out_blocks": "2232", "process_user_time": 6.541005}
[0m19:28:42.313070 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:42.312684 after 14.14 seconds
[0m19:28:42.314663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490de6b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490f1dc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48f2551630>]}
[0m19:28:42.316152 [debug] [MainThread]: Flushing usage events
[0m19:28:43.146947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:58.630644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6b877670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6a8fa650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6a8fa6b0>]}


============================== 19:30:58.635290 | fc15436e-cae8-48fb-bcd8-1e9d9a197c5b ==============================
[0m19:30:58.635290 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:30:58.636771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'warn_error': 'None', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select exchanges_cleaning', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:31:00.101203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc15436e-cae8-48fb-bcd8-1e9d9a197c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6c959840>]}
[0m19:31:00.240346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc15436e-cae8-48fb-bcd8-1e9d9a197c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6b6b3160>]}
[0m19:31:00.241564 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:31:00.535959 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:31:00.943135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:31:00.943974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:31:01.061205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc15436e-cae8-48fb-bcd8-1e9d9a197c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d54d21510>]}
[0m19:31:01.315067 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:31:01.320505 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:31:01.343007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc15436e-cae8-48fb-bcd8-1e9d9a197c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d54966b60>]}
[0m19:31:01.344112 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:31:01.345051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc15436e-cae8-48fb-bcd8-1e9d9a197c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d54964760>]}
[0m19:31:01.350301 [info ] [MainThread]: 
[0m19:31:01.354258 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:31:01.356005 [info ] [MainThread]: 
[0m19:31:01.357284 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:31:01.360520 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:31:01.361799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:01.955130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:31:01.956287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:31:02.530483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc15436e-cae8-48fb-bcd8-1e9d9a197c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6c7de6e0>]}
[0m19:31:02.531602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:02.537475 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:31:02.538838 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:31:02.541085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:31:02.542241 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:31:02.576670 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:31:02.577836 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:31:02.637962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:03.319847 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:31:03.321425 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,

        -- -- Column renaming and handling
        COALESCE(guest_countguest_count, guest_count) AS guest_count,

        -- -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
    -- WHERE
    --     -- Basic data validation
    --     created_at IS NOT NULL
    --     AND start_on IS NOT NULL
    --     AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:31:04.152943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a2b012eb-270f-4b35-91bc-4efccaf6a7a8&page=queryresults
[0m19:31:04.334871 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a2b012eb-270f-4b35-91bc-4efccaf6a7a8&page=queryresults
[0m19:31:04.353982 [debug] [Thread-1 (]: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: guest_count; Did you mean night_count? at [23:42]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:31:04.357494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc15436e-cae8-48fb-bcd8-1e9d9a197c5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6ba44340>]}
[0m19:31:04.358798 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.exchanges_cleaning ......... [[31mERROR[0m in 1.82s]
[0m19:31:04.362789 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:31:04.365295 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.exchanges_cleaning' to be skipped because of status 'error'.  Reason: Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: guest_count; Did you mean night_count? at [23:42]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql.
[0m19:31:04.378074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:31:04.387496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:04.389063 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:31:04.391435 [info ] [MainThread]: 
[0m19:31:04.393257 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m19:31:04.398199 [debug] [MainThread]: Command end result
[0m19:31:04.537325 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:31:04.542175 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:31:04.564363 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:31:04.565740 [info ] [MainThread]: 
[0m19:31:04.567078 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:31:04.568711 [info ] [MainThread]: 
[0m19:31:04.569882 [error] [MainThread]:   Database Error in model exchanges_cleaning (models/example/exchanges_cleaning.sql)
  Unrecognized name: guest_count; Did you mean night_count? at [23:42]
  compiled code at target/run/home_exchange/models/example/exchanges_cleaning.sql
[0m19:31:04.571117 [info ] [MainThread]: 
[0m19:31:04.572786 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:31:04.574731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.0610657, "process_in_blocks": "0", "process_kernel_time": 0.383429, "process_mem_max_rss": "210920", "process_out_blocks": "2240", "process_user_time": 5.872524}
[0m19:31:04.575711 [debug] [MainThread]: Command `dbt run` failed at 19:31:04.575468 after 6.06 seconds
[0m19:31:04.576577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6b877670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6b6b3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6b7e0130>]}
[0m19:31:04.577556 [debug] [MainThread]: Flushing usage events
[0m19:31:05.511968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:00.335930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0867ba3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0866c2a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0866c2a6b0>]}


============================== 19:34:00.340431 | cf6d4228-4e4f-4b20-a77d-5c7d030489e4 ==============================
[0m19:34:00.340431 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:34:00.342196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select exchanges_cleaning', 'send_anonymous_usage_stats': 'True'}
[0m19:34:01.817129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf6d4228-4e4f-4b20-a77d-5c7d030489e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0867aed480>]}
[0m19:34:01.947800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf6d4228-4e4f-4b20-a77d-5c7d030489e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0866c287f0>]}
[0m19:34:01.948980 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:34:02.496734 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:34:02.946368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:02.947085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:03.061738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6d4228-4e4f-4b20-a77d-5c7d030489e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0851089660>]}
[0m19:34:03.322733 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:34:03.327758 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:34:03.350173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6d4228-4e4f-4b20-a77d-5c7d030489e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0850b33220>]}
[0m19:34:03.351514 [info ] [MainThread]: Found 6 models, 10 data tests, 2 sources, 489 macros
[0m19:34:03.353477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf6d4228-4e4f-4b20-a77d-5c7d030489e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0850b30ee0>]}
[0m19:34:03.356929 [info ] [MainThread]: 
[0m19:34:03.357955 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:34:03.358818 [info ] [MainThread]: 
[0m19:34:03.360176 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:03.362233 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:34:03.363507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:04.158531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:34:04.160571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:04.789018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf6d4228-4e4f-4b20-a77d-5c7d030489e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0868b0a6e0>]}
[0m19:34:04.790357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:04.797421 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:34:04.798804 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m19:34:04.800844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.exchanges_cleaning)
[0m19:34:04.802663 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:34:04.890205 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:34:04.892573 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:34:05.057826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:05.747040 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:34:05.748613 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,
        guest_countguest_count AS guest_count,

        -- -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count)


    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
    -- WHERE
    --     -- Basic data validation
    --     created_at IS NOT NULL
    --     AND start_on IS NOT NULL
    --     AND end_on IS NOT NULL
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:34:06.527662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:b5cd0d97-ad2a-4aa7-8af9-c40b07514a79&page=queryresults
[0m19:34:18.261790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6d4228-4e4f-4b20-a77d-5c7d030489e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08511c7940>]}
[0m19:34:18.266350 [info ] [Thread-1 (]: 1 of 1 OK created sql table model home_exchange.exchanges_cleaning ............. [[32mCREATE TABLE (12.0m rows, 1.8 GiB processed)[0m in 13.45s]
[0m19:34:18.269870 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:34:18.273820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:18.277338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:18.278136 [debug] [MainThread]: Connection 'model.home_exchange.exchanges_cleaning' was properly closed.
[0m19:34:18.278964 [info ] [MainThread]: 
[0m19:34:18.279969 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.92 seconds (14.92s).
[0m19:34:18.281756 [debug] [MainThread]: Command end result
[0m19:34:18.392966 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:34:18.396933 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:34:18.414885 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:34:18.415710 [info ] [MainThread]: 
[0m19:34:18.417114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:34:18.418869 [info ] [MainThread]: 
[0m19:34:18.421068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:34:18.429677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.210533, "process_in_blocks": "0", "process_kernel_time": 0.341625, "process_mem_max_rss": "216416", "process_out_blocks": "2240", "process_user_time": 6.500936}
[0m19:34:18.431323 [debug] [MainThread]: Command `dbt run` succeeded at 19:34:18.430860 after 18.21 seconds
[0m19:34:18.432649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0867ba3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0850cb4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0850cb63e0>]}
[0m19:34:18.433974 [debug] [MainThread]: Flushing usage events
[0m19:34:19.293008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:05.706071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5913f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae581c2f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae581c2ec0>]}


============================== 19:39:05.716410 | 4ee6a942-4400-4955-9800-640ba28dcb3b ==============================
[0m19:39:05.716410 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:39:05.718941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:07.119253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e6215d0>]}
[0m19:39:07.252821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5873b3d0>]}
[0m19:39:07.254427 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:39:07.583571 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:39:07.978392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:07.979135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:08.095760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e7aa9e0>]}
[0m19:39:08.333276 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:39:08.338295 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:39:08.383984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e29cd30>]}
[0m19:39:08.385122 [info ] [MainThread]: Found 6 models, 9 data tests, 2 sources, 489 macros
[0m19:39:08.392377 [info ] [MainThread]: 
[0m19:39:08.393776 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:39:08.395597 [info ] [MainThread]: 
[0m19:39:08.397198 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:39:08.408688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m19:39:08.417356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:09.269957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m19:39:09.271101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:09.869525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae588242e0>]}
[0m19:39:09.870646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:09.877649 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m19:39:09.878753 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m19:39:09.879925 [info ] [Thread-1 (]: 1 of 15 START sql view model home_exchange.base_bigquery_exchanges ............. [RUN]
[0m19:39:09.883660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m19:39:09.881547 [info ] [Thread-2 (]: 2 of 15 START sql view model home_exchange.base_bigquery_subscriptions ......... [RUN]
[0m19:39:09.885401 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m19:39:09.886755 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m19:39:09.906389 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m19:39:09.964021 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:39:09.974878 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m19:39:09.977108 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m19:39:09.990665 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m19:39:10.134095 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m19:39:10.139310 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m19:39:10.144085 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:39:10.145547 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:39:10.146770 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m19:39:10.191869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:10.974549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:6b091820-88fc-47de-9698-f25311feaaba&page=queryresults
[0m19:39:11.189110 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:c389409b-b64f-4948-830b-e5125dc6aaaf&page=queryresults
[0m19:39:11.408152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e71db70>]}
[0m19:39:11.409598 [info ] [Thread-1 (]: 1 of 15 OK created sql view model home_exchange.base_bigquery_exchanges ........ [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m19:39:11.411399 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m19:39:11.413779 [debug] [Thread-1 (]: Began running node model.home_exchange.my_first_dbt_model
[0m19:39:11.415395 [info ] [Thread-1 (]: 3 of 15 START sql table model home_exchange.my_first_dbt_model ................. [RUN]
[0m19:39:11.417117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.my_first_dbt_model)
[0m19:39:11.417993 [debug] [Thread-1 (]: Began compiling node model.home_exchange.my_first_dbt_model
[0m19:39:11.430155 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.my_first_dbt_model"
[0m19:39:11.432455 [debug] [Thread-1 (]: Began executing node model.home_exchange.my_first_dbt_model
[0m19:39:11.478522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:11.580274 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3c5e29e0>]}
[0m19:39:11.581939 [info ] [Thread-2 (]: 2 of 15 OK created sql view model home_exchange.base_bigquery_subscriptions .... [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m19:39:11.585325 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m19:39:11.586547 [debug] [Thread-2 (]: Began running node model.home_exchange.exchanges_cleaning
[0m19:39:11.589244 [info ] [Thread-2 (]: 4 of 15 START sql table model home_exchange.exchanges_cleaning ................. [RUN]
[0m19:39:11.590803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.exchanges_cleaning)
[0m19:39:11.591901 [debug] [Thread-2 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m19:39:11.598863 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m19:39:11.600592 [debug] [Thread-2 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m19:39:11.617889 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:12.199941 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.my_first_dbt_model"
[0m19:39:12.201695 [debug] [Thread-1 (]: On model.home_exchange.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.my_first_dbt_model"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:39:12.265887 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m19:39:12.267324 [debug] [Thread-2 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,
        guest_countguest_count AS guest_count,

        -- -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m19:39:12.657481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:1b46d91d-b4e4-4285-aed6-029917a95132&page=queryresults
[0m19:39:12.995500 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:e3712880-f574-46eb-932f-a031f6824091&page=queryresults
[0m19:39:15.930423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3c20ad40>]}
[0m19:39:15.932260 [info ] [Thread-1 (]: 3 of 15 OK created sql table model home_exchange.my_first_dbt_model ............ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 4.51s]
[0m19:39:15.934272 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_first_dbt_model
[0m19:39:15.935727 [debug] [Thread-1 (]: Began running node model.home_exchange.test
[0m19:39:15.937657 [info ] [Thread-1 (]: 5 of 15 START sql table model home_exchange.test ............................... [RUN]
[0m19:39:15.939004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.my_first_dbt_model, now model.home_exchange.test)
[0m19:39:15.939966 [debug] [Thread-1 (]: Began compiling node model.home_exchange.test
[0m19:39:15.947443 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.test"
[0m19:39:15.952080 [debug] [Thread-1 (]: Began executing node model.home_exchange.test
[0m19:39:15.959182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:16.574632 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.test"
[0m19:39:16.575919 [debug] [Thread-1 (]: On model.home_exchange.test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.test"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`test`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_exchange as (

    select exchange_id as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`

),
source_subs as (

    select subscription_date as id
    from `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`

)


select *
from source_subs

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m19:39:17.408851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:19b039d3-f15e-4d44-a083-49f1b964bc82&page=queryresults
[0m19:39:20.604342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3e0b6080>]}
[0m19:39:20.605815 [info ] [Thread-1 (]: 5 of 15 OK created sql table model home_exchange.test .......................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.67s]
[0m19:39:20.607632 [debug] [Thread-1 (]: Finished running node model.home_exchange.test
[0m19:39:20.609807 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:20.611433 [info ] [Thread-1 (]: 6 of 15 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m19:39:20.613328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.test, now test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:39:20.615326 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:20.657505 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:39:20.659300 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:20.706652 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:39:20.708252 [debug] [Thread-1 (]: On test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m19:39:20.709483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:21.688817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:ca662d50-25d3-4424-961d-f2c1ce618280&page=queryresults
[0m19:39:22.267756 [error] [Thread-1 (]: 6 of 15 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 1.65s]
[0m19:39:22.270201 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:22.271474 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:39:22.272634 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m19:39:22.274551 [info ] [Thread-1 (]: 7 of 15 START test unique_my_first_dbt_model_id ................................ [RUN]
[0m19:39:22.278483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_my_first_dbt_model_id.5fb22c2710, now test.home_exchange.unique_my_first_dbt_model_id.16e066b321)
[0m19:39:22.279604 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:39:22.303069 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:39:22.312758 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:39:22.320214 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"
[0m19:39:22.321568 [debug] [Thread-1 (]: On test.home_exchange.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `mywagon-445720`.`home_exchange`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:22.322835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:22.695592 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ee6a942-4400-4955-9800-640ba28dcb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3c1f8bb0>]}
[0m19:39:22.696937 [info ] [Thread-2 (]: 4 of 15 OK created sql table model home_exchange.exchanges_cleaning ............ [[32mCREATE TABLE (12.0m rows, 1.8 GiB processed)[0m in 11.10s]
[0m19:39:22.699126 [debug] [Thread-2 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m19:39:22.703593 [debug] [Thread-2 (]: Began running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:39:22.705269 [info ] [Thread-2 (]: 8 of 15 START test accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [RUN]
[0m19:39:22.709889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b)
[0m19:39:22.714364 [debug] [Thread-2 (]: Began compiling node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:39:22.748233 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b"
[0m19:39:22.749540 [debug] [Thread-2 (]: Began executing node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:39:22.755690 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b"
[0m19:39:22.757720 [debug] [Thread-2 (]: On test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        exchange_type as value_field,
        count(*) as n_records

    from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
    group by exchange_type

)

select *
from all_values
where value_field not in (
    'RECIPROCAL','NON_RECIPROCAL'
)



      
    ) dbt_internal_test
[0m19:39:22.759631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:23.308227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:440ae157-ee9d-490f-81eb-84abafb2f269&page=queryresults
[0m19:39:23.865662 [info ] [Thread-1 (]: 7 of 15 PASS unique_my_first_dbt_model_id ...................................... [[32mPASS[0m in 1.59s]
[0m19:39:23.868636 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_first_dbt_model_id.16e066b321
[0m19:39:23.870506 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:39:23.877740 [info ] [Thread-1 (]: 9 of 15 START test not_null_exchanges_cleaning_conversation_id ................. [RUN]
[0m19:39:23.880396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.home_exchange.unique_my_first_dbt_model_id.16e066b321, now test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21)
[0m19:39:23.882112 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:39:23.919200 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21"
[0m19:39:23.921909 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:39:23.938355 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21"
[0m19:39:23.940771 [debug] [Thread-1 (]: On test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select conversation_id
from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
where conversation_id is null



      
    ) dbt_internal_test
[0m19:39:23.942713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:24.225870 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8732216a-43b5-4501-bb25-a8752599c7ee&page=queryresults
[0m19:39:24.774790 [info ] [Thread-2 (]: 8 of 15 PASS accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [[32mPASS[0m in 2.07s]
[0m19:39:24.776393 [debug] [Thread-2 (]: Finished running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:39:24.777898 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:39:24.779171 [info ] [Thread-2 (]: 10 of 15 START test not_null_exchanges_cleaning_end_on ......................... [RUN]
[0m19:39:24.781009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b, now test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59)
[0m19:39:24.782101 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:39:24.795305 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59"
[0m19:39:24.797106 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:39:24.802233 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59"
[0m19:39:24.803895 [debug] [Thread-2 (]: On test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select end_on
from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
where end_on is null



      
    ) dbt_internal_test
[0m19:39:24.806179 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:25.129589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:bc8c716c-a8ee-4bd0-b1b2-5743088d5043&page=queryresults
[0m19:39:25.652869 [info ] [Thread-1 (]: 9 of 15 PASS not_null_exchanges_cleaning_conversation_id ....................... [[32mPASS[0m in 1.77s]
[0m19:39:25.655271 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:39:25.656366 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:39:25.657483 [info ] [Thread-1 (]: 11 of 15 START test not_null_exchanges_cleaning_start_on ....................... [RUN]
[0m19:39:25.658720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21, now test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624)
[0m19:39:25.659697 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:39:25.668700 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624"
[0m19:39:25.670283 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:39:25.678035 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624"
[0m19:39:25.679812 [debug] [Thread-1 (]: On test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select start_on
from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
where start_on is null



      
    ) dbt_internal_test
[0m19:39:25.680862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:26.030713 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:5e05e540-ad72-4fe3-afdf-6c14539d903d&page=queryresults
[0m19:39:26.616191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a8590876-9336-4f4c-98df-fd259bc766e4&page=queryresults
[0m19:39:26.651190 [error] [Thread-2 (]: 10 of 15 FAIL 1346820 not_null_exchanges_cleaning_end_on ....................... [[31mFAIL 1346820[0m in 1.87s]
[0m19:39:26.653461 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:39:26.655232 [debug] [Thread-2 (]: Began running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:39:26.656646 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59' to be skipped because of status 'fail'.  Reason: Got 1346820 results, configured to fail if != 0.
[0m19:39:26.658032 [info ] [Thread-2 (]: 12 of 15 START test unique_exchanges_cleaning_conversation_id .................. [RUN]
[0m19:39:26.661063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59, now test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68)
[0m19:39:26.663091 [debug] [Thread-2 (]: Began compiling node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:39:26.683676 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68"
[0m19:39:26.684991 [debug] [Thread-2 (]: Began executing node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:39:26.700401 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68"
[0m19:39:26.711820 [debug] [Thread-2 (]: On test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select conversation_id as unique_field
  from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
  where conversation_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:26.713640 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:27.191369 [error] [Thread-1 (]: 11 of 15 FAIL 1335625 not_null_exchanges_cleaning_start_on ..................... [[31mFAIL 1335625[0m in 1.53s]
[0m19:39:27.194063 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:39:27.196260 [debug] [Thread-1 (]: Began running node model.home_exchange.my_second_dbt_model
[0m19:39:27.197999 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' to be skipped because of status 'fail'.  Reason: Got 1335625 results, configured to fail if != 0.
[0m19:39:27.199298 [info ] [Thread-1 (]: 13 of 15 SKIP relation home_exchange.my_second_dbt_model ....................... [[33mSKIP[0m]
[0m19:39:27.202273 [debug] [Thread-1 (]: Finished running node model.home_exchange.my_second_dbt_model
[0m19:39:27.206990 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.my_second_dbt_model' to be skipped because of status 'skipped'. 
[0m19:39:27.209638 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:39:27.210756 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_my_second_dbt_model_id ............................. [[33mSKIP[0m]
[0m19:39:27.212501 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_my_second_dbt_model_id.151b76d778
[0m19:39:27.213750 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:39:27.214816 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'skipped'. 
[0m19:39:27.215726 [info ] [Thread-1 (]: 15 of 15 SKIP test unique_my_second_dbt_model_id ............................... [[33mSKIP[0m]
[0m19:39:27.217689 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493
[0m19:39:27.220759 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'skipped'. 
[0m19:39:28.824805 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:e1a967b8-89a5-4c4b-8350-1f492b5a1d80&page=queryresults
[0m19:39:30.385025 [error] [Thread-2 (]: 12 of 15 FAIL 1068436 unique_exchanges_cleaning_conversation_id ................ [[31mFAIL 1068436[0m in 3.72s]
[0m19:39:30.387043 [debug] [Thread-2 (]: Finished running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:39:30.388584 [debug] [Thread-5 (]: Marking all children of 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' to be skipped because of status 'fail'.  Reason: Got 1068436 results, configured to fail if != 0.
[0m19:39:30.391995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:30.395503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:30.396376 [debug] [MainThread]: Connection 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' was properly closed.
[0m19:39:30.397104 [debug] [MainThread]: Connection 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' was properly closed.
[0m19:39:30.398101 [info ] [MainThread]: 
[0m19:39:30.402708 [info ] [MainThread]: Finished running 3 table models, 9 data tests, 3 view models in 0 hours 0 minutes and 22.00 seconds (22.00s).
[0m19:39:30.409588 [debug] [MainThread]: Command end result
[0m19:39:30.529924 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:39:30.535682 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:39:30.551566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:39:30.552546 [info ] [MainThread]: 
[0m19:39:30.554362 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m19:39:30.556004 [info ] [MainThread]: 
[0m19:39:30.557099 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m19:39:30.558175 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:39:30.559157 [info ] [MainThread]: 
[0m19:39:30.560296 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m19:39:30.561193 [info ] [MainThread]: 
[0m19:39:30.562333 [error] [MainThread]: [31mFailure in test not_null_exchanges_cleaning_end_on (models/example/schema.yml)[0m
[0m19:39:30.564197 [error] [MainThread]:   Got 1346820 results, configured to fail if != 0
[0m19:39:30.568256 [info ] [MainThread]: 
[0m19:39:30.570286 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_exchanges_cleaning_end_on.sql
[0m19:39:30.571791 [info ] [MainThread]: 
[0m19:39:30.573166 [error] [MainThread]: [31mFailure in test not_null_exchanges_cleaning_start_on (models/example/schema.yml)[0m
[0m19:39:30.574441 [error] [MainThread]:   Got 1335625 results, configured to fail if != 0
[0m19:39:30.575377 [info ] [MainThread]: 
[0m19:39:30.576442 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_exchanges_cleaning_start_on.sql
[0m19:39:30.577335 [info ] [MainThread]: 
[0m19:39:30.579113 [error] [MainThread]: [31mFailure in test unique_exchanges_cleaning_conversation_id (models/example/schema.yml)[0m
[0m19:39:30.580559 [error] [MainThread]:   Got 1068436 results, configured to fail if != 0
[0m19:39:30.581869 [info ] [MainThread]: 
[0m19:39:30.584875 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/unique_exchanges_cleaning_conversation_id.sql
[0m19:39:30.586839 [info ] [MainThread]: 
[0m19:39:30.588542 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=4 SKIP=3 TOTAL=15
[0m19:39:30.600856 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 25.01224, "process_in_blocks": "0", "process_kernel_time": 0.471144, "process_mem_max_rss": "220728", "process_out_blocks": "2504", "process_user_time": 8.450532}
[0m19:39:30.604275 [debug] [MainThread]: Command `dbt build` failed at 19:39:30.603899 after 25.02 seconds
[0m19:39:30.605283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5913f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae590a5d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae3c1abfa0>]}
[0m19:39:30.606625 [debug] [MainThread]: Flushing usage events
[0m19:39:31.543942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:51.867564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0ceb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a012a800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a012a8f0>]}


============================== 19:43:51.872574 | 5b3709eb-3181-49cc-9d39-042b0770ae42 ==============================
[0m19:43:51.872574 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:43:51.875050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:43:53.458301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b3709eb-3181-49cc-9d39-042b0770ae42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a1dcd7e0>]}
[0m19:43:53.594020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b3709eb-3181-49cc-9d39-042b0770ae42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0128490>]}
[0m19:43:53.596128 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:43:53.885228 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:43:54.229029 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading home_exchange: example/schema.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |         tests:
    8  |           - unique
    9  |           - not_null
    10 |           +store_failures: true
    11 | 
    12 |       - name: start_on
    13 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 8, column 11
    did not find expected '-' indicator
      in "<unicode string>", line 10, column 11
[0m19:43:54.237779 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.478784, "process_in_blocks": "0", "process_kernel_time": 0.298475, "process_mem_max_rss": "206260", "process_out_blocks": "16", "process_user_time": 4.974588}
[0m19:43:54.239998 [debug] [MainThread]: Command `dbt test` failed at 19:43:54.239518 after 2.49 seconds
[0m19:43:54.241850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45a0ceb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4585d9dc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4585d9dc30>]}
[0m19:43:54.243950 [debug] [MainThread]: Flushing usage events
[0m19:43:54.966545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:37.401809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb22bf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb13471c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb1347160>]}


============================== 19:45:37.406917 | 962c5f02-4782-43c0-8a00-fd7e43bb0acd ==============================
[0m19:45:37.406917 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:45:37.408455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:45:38.906000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '962c5f02-4782-43c0-8a00-fd7e43bb0acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef9776cb50>]}
[0m19:45:39.116404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '962c5f02-4782-43c0-8a00-fd7e43bb0acd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb1b72c80>]}
[0m19:45:39.117751 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:45:39.517919 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:45:39.948834 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading home_exchange: example/schema.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |       - name: conversation_id
    7  |         tests:
    8  |           +store_failures: true
    9  |           - unique
    10 |           - not_null
    11 | 
    12 | 
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 8, column 11
    did not find expected key
      in "<unicode string>", line 9, column 11
[0m19:45:39.952068 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.663817, "process_in_blocks": "0", "process_kernel_time": 0.309496, "process_mem_max_rss": "206192", "process_out_blocks": "16", "process_user_time": 5.091724}
[0m19:45:39.955893 [debug] [MainThread]: Command `dbt test` failed at 19:45:39.955366 after 2.67 seconds
[0m19:45:39.957135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb22bf5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef978f9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef97352410>]}
[0m19:45:39.958103 [debug] [MainThread]: Flushing usage events
[0m19:45:40.724606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:17.442337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69747f35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697387f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697387f160>]}


============================== 19:46:17.447145 | a9863841-841f-4f4b-8c7f-541840b521d1 ==============================
[0m19:46:17.447145 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:46:17.448767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:46:18.899498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9863841-841f-4f4b-8c7f-541840b521d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6975755de0>]}
[0m19:46:19.028834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9863841-841f-4f4b-8c7f-541840b521d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6959dcebc0>]}
[0m19:46:19.030054 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:46:19.332924 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:46:19.709903 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading home_exchange: example/schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |       - name: exchange_type
    24 |         tests:
    25 |         +store_failures: true
    26 |           - accepted_values:
    27 |               values: ['RECIPROCAL', 'NON_RECIPROCAL']
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 26, column 28
[0m19:46:19.712783 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.384075, "process_in_blocks": "0", "process_kernel_time": 0.209704, "process_mem_max_rss": "206060", "process_out_blocks": "8", "process_user_time": 4.953021}
[0m19:46:19.713990 [debug] [MainThread]: Command `dbt test` failed at 19:46:19.713703 after 2.39 seconds
[0m19:46:19.715927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69747f35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69598e20b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69598e1c60>]}
[0m19:46:19.716856 [debug] [MainThread]: Flushing usage events
[0m19:46:20.431405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:11.534654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaef5cf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaeea12800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaef5602e0>]}


============================== 19:47:11.540775 | 68d99db7-01fc-44de-a904-d4a10209dda0 ==============================
[0m19:47:11.540775 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:47:11.542511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:47:13.383981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68d99db7-01fc-44de-a904-d4a10209dda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf06a1810>]}
[0m19:47:13.580788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68d99db7-01fc-44de-a904-d4a10209dda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffad8ba2bc0>]}
[0m19:47:13.583122 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:47:13.902191 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:47:14.299597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:14.300364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:14.432855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68d99db7-01fc-44de-a904-d4a10209dda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffad8548130>]}
[0m19:47:14.958606 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:47:14.964743 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:47:15.007437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68d99db7-01fc-44de-a904-d4a10209dda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffad854a6b0>]}
[0m19:47:15.008651 [info ] [MainThread]: Found 6 models, 5 data tests, 2 sources, 489 macros
[0m19:47:15.009985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d99db7-01fc-44de-a904-d4a10209dda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffad8f812d0>]}
[0m19:47:15.018076 [info ] [MainThread]: 
[0m19:47:15.019064 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m19:47:15.019994 [info ] [MainThread]: 
[0m19:47:15.021288 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:15.035404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720_home_exchange'
[0m19:47:15.036920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:15.955478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d99db7-01fc-44de-a904-d4a10209dda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaef904ac0>]}
[0m19:47:15.956674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:15.962987 [debug] [Thread-1 (]: Began running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:47:15.964284 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:47:15.965786 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [RUN]
[0m19:47:15.967679 [info ] [Thread-2 (]: 2 of 5 START test not_null_exchanges_cleaning_conversation_id .................. [RUN]
[0m19:47:15.970192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b)
[0m19:47:15.971895 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21'
[0m19:47:15.973131 [debug] [Thread-1 (]: Began compiling node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:47:15.974355 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:47:16.084410 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b"
[0m19:47:16.087398 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21"
[0m19:47:16.089146 [debug] [Thread-1 (]: Began executing node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:47:16.096414 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:47:16.173313 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b"
[0m19:47:16.170366 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21"
[0m19:47:16.176194 [debug] [Thread-2 (]: On test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select conversation_id
from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
where conversation_id is null



      
    ) dbt_internal_test
[0m19:47:16.177436 [debug] [Thread-1 (]: On test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        exchange_type as value_field,
        count(*) as n_records

    from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
    group by exchange_type

)

select *
from all_values
where value_field not in (
    'RECIPROCAL','NON_RECIPROCAL'
)



      
    ) dbt_internal_test
[0m19:47:16.178343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:47:16.179407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:17.220228 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:d4e31b01-f352-4360-814a-a12efbff851e&page=queryresults
[0m19:47:17.225981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:f039ca0b-e05e-4b63-a945-e646857bf00d&page=queryresults
[0m19:47:17.826545 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL  [[32mPASS[0m in 1.86s]
[0m19:47:17.828320 [debug] [Thread-1 (]: Finished running node test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b
[0m19:47:17.829868 [debug] [Thread-1 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:47:17.831216 [info ] [Thread-1 (]: 3 of 5 START test not_null_exchanges_cleaning_end_on ........................... [RUN]
[0m19:47:17.832843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.home_exchange.accepted_values_exchanges_cleaning_exchange_type__RECIPROCAL__NON_RECIPROCAL.b5fb8bd54b, now test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59)
[0m19:47:17.833843 [debug] [Thread-1 (]: Began compiling node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:47:17.843621 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59"
[0m19:47:17.848132 [debug] [Thread-1 (]: Began executing node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:47:17.856930 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59"
[0m19:47:17.858243 [debug] [Thread-1 (]: On test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select end_on
from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
where end_on is null



      
    ) dbt_internal_test
[0m19:47:17.859605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:17.948797 [info ] [Thread-2 (]: 2 of 5 PASS not_null_exchanges_cleaning_conversation_id ........................ [[32mPASS[0m in 1.98s]
[0m19:47:17.951226 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21
[0m19:47:17.952554 [debug] [Thread-2 (]: Began running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:47:17.954058 [info ] [Thread-2 (]: 4 of 5 START test not_null_exchanges_cleaning_start_on ......................... [RUN]
[0m19:47:17.956100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_exchanges_cleaning_conversation_id.bbafab5b21, now test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624)
[0m19:47:17.957241 [debug] [Thread-2 (]: Began compiling node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:47:17.972192 [debug] [Thread-2 (]: Writing injected SQL for node "test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624"
[0m19:47:17.973379 [debug] [Thread-2 (]: Began executing node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:47:17.989136 [debug] [Thread-2 (]: Writing runtime sql for node "test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624"
[0m19:47:17.991899 [debug] [Thread-2 (]: On test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select start_on
from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
where start_on is null



      
    ) dbt_internal_test
[0m19:47:17.994045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:18.735179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a86556a4-f8f8-4a2b-ab21-8e02c9b85a7b&page=queryresults
[0m19:47:18.890296 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:7ea6048e-4897-4952-9713-02fb720d42d1&page=queryresults
[0m19:47:19.314603 [error] [Thread-1 (]: 3 of 5 FAIL 1346820 not_null_exchanges_cleaning_end_on ......................... [[31mFAIL 1346820[0m in 1.48s]
[0m19:47:19.316713 [debug] [Thread-1 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59
[0m19:47:19.318293 [debug] [Thread-1 (]: Began running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:47:19.319640 [info ] [Thread-1 (]: 5 of 5 START test unique_exchanges_cleaning_conversation_id .................... [RUN]
[0m19:47:19.320832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.home_exchange.not_null_exchanges_cleaning_end_on.70b084bf59, now test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68)
[0m19:47:19.321727 [debug] [Thread-1 (]: Began compiling node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:47:19.344933 [debug] [Thread-1 (]: Writing injected SQL for node "test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68"
[0m19:47:19.348166 [debug] [Thread-1 (]: Began executing node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:47:19.360925 [debug] [Thread-1 (]: Writing runtime sql for node "test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68"
[0m19:47:19.366549 [debug] [Thread-1 (]: On test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select conversation_id as unique_field
  from `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
  where conversation_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:47:19.367670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:19.447365 [error] [Thread-2 (]: 4 of 5 FAIL 1335625 not_null_exchanges_cleaning_start_on ....................... [[31mFAIL 1335625[0m in 1.49s]
[0m19:47:19.449898 [debug] [Thread-2 (]: Finished running node test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624
[0m19:47:20.252562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:0239593b-27d0-4af0-8043-994af16dd7a0&page=queryresults
[0m19:47:20.840826 [error] [Thread-1 (]: 5 of 5 FAIL 1068436 unique_exchanges_cleaning_conversation_id .................. [[31mFAIL 1068436[0m in 1.52s]
[0m19:47:20.843081 [debug] [Thread-1 (]: Finished running node test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68
[0m19:47:20.847383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:20.850585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:20.851384 [debug] [MainThread]: Connection 'test.home_exchange.unique_exchanges_cleaning_conversation_id.a4491b8e68' was properly closed.
[0m19:47:20.852075 [debug] [MainThread]: Connection 'test.home_exchange.not_null_exchanges_cleaning_start_on.92f343c624' was properly closed.
[0m19:47:20.853017 [info ] [MainThread]: 
[0m19:47:20.854006 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m19:47:20.859266 [debug] [MainThread]: Command end result
[0m19:47:20.978207 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:47:20.981240 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:47:20.998393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:47:20.999459 [info ] [MainThread]: 
[0m19:47:21.001785 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:47:21.003396 [info ] [MainThread]: 
[0m19:47:21.005018 [error] [MainThread]: [31mFailure in test not_null_exchanges_cleaning_end_on (models/example/schema.yml)[0m
[0m19:47:21.006142 [error] [MainThread]:   Got 1346820 results, configured to fail if != 0
[0m19:47:21.007276 [info ] [MainThread]: 
[0m19:47:21.009648 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_exchanges_cleaning_end_on.sql
[0m19:47:21.010996 [info ] [MainThread]: 
[0m19:47:21.012445 [error] [MainThread]: [31mFailure in test not_null_exchanges_cleaning_start_on (models/example/schema.yml)[0m
[0m19:47:21.014571 [error] [MainThread]:   Got 1335625 results, configured to fail if != 0
[0m19:47:21.015925 [info ] [MainThread]: 
[0m19:47:21.017087 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/not_null_exchanges_cleaning_start_on.sql
[0m19:47:21.017992 [info ] [MainThread]: 
[0m19:47:21.019618 [error] [MainThread]: [31mFailure in test unique_exchanges_cleaning_conversation_id (models/example/schema.yml)[0m
[0m19:47:21.020713 [error] [MainThread]:   Got 1068436 results, configured to fail if != 0
[0m19:47:21.021582 [info ] [MainThread]: 
[0m19:47:21.022951 [info ] [MainThread]:   compiled code at target/compiled/home_exchange/models/example/schema.yml/unique_exchanges_cleaning_conversation_id.sql
[0m19:47:21.026675 [info ] [MainThread]: 
[0m19:47:21.032114 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m19:47:21.040253 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 9.691732, "process_in_blocks": "0", "process_kernel_time": 0.379177, "process_mem_max_rss": "217876", "process_out_blocks": "2256", "process_user_time": 7.393963}
[0m19:47:21.043787 [debug] [MainThread]: Command `dbt test` failed at 19:47:21.041875 after 9.69 seconds
[0m19:47:21.046659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaef5cf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf0757a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffad854b250>]}
[0m19:47:21.047721 [debug] [MainThread]: Flushing usage events
[0m19:47:21.831975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:42.280681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17081f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16fc5e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16fc5d120>]}


============================== 19:57:42.285684 | 625453cf-162a-4763-b0b9-a076ba33db40 ==============================
[0m19:57:42.285684 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:57:42.288115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_subscriptions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:43.684502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '625453cf-162a-4763-b0b9-a076ba33db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1718fd810>]}
[0m19:57:43.854793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '625453cf-162a-4763-b0b9-a076ba33db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff16fc5ce20>]}
[0m19:57:43.856298 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:57:44.309256 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:57:44.735279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:44.736385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:44.853150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '625453cf-162a-4763-b0b9-a076ba33db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1559841f0>]}
[0m19:57:45.105928 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:57:45.111272 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:57:45.132981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '625453cf-162a-4763-b0b9-a076ba33db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff155992aa0>]}
[0m19:57:45.134208 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 489 macros
[0m19:57:45.135273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625453cf-162a-4763-b0b9-a076ba33db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff155992260>]}
[0m19:57:45.137236 [warn ] [MainThread]: The selection criterion 'stg_subscriptions' does not match any enabled nodes
[0m19:57:45.139693 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:57:45.143615 [debug] [MainThread]: Command end result
[0m19:57:45.229558 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m19:57:45.232765 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m19:57:45.240586 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m19:57:45.242379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0805185, "process_in_blocks": "0", "process_kernel_time": 0.452803, "process_mem_max_rss": "207456", "process_out_blocks": "2136", "process_user_time": 5.534269}
[0m19:57:45.243391 [debug] [MainThread]: Command `dbt run` succeeded at 19:57:45.243109 after 3.08 seconds
[0m19:57:45.245278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17081f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17076bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1559303d0>]}
[0m19:57:45.246440 [debug] [MainThread]: Flushing usage events
[0m19:57:46.029133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:58.703437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49243fb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49240b93f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49250aa6e0>]}


============================== 19:59:58.709550 | b24a093f-d8ff-4a96-9c3b-2074a808387a ==============================
[0m19:59:58.709550 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:59:58.710882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/home_exchange/home_exchange', 'log_path': '/root/home_exchange/home_exchange/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:00:00.199505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49095e7670>]}
[0m20:00:00.345838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4924073cd0>]}
[0m20:00:00.348958 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:00:00.671570 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:00:01.071918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:01.072683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:01.190469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4909260130>]}
[0m20:00:01.448453 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:00:01.453540 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:00:01.479373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490920e1a0>]}
[0m20:00:01.480480 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 489 macros
[0m20:00:01.481560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4924e1ace0>]}
[0m20:00:01.485364 [info ] [MainThread]: 
[0m20:00:01.488606 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m20:00:01.495835 [info ] [MainThread]: 
[0m20:00:01.499610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:01.515838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m20:00:01.517646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:02.367638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m20:00:02.369124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:02.947400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49250634f0>]}
[0m20:00:02.948538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:00:02.967842 [debug] [Thread-1 (]: Began running node model.home_exchange.base_bigquery_exchanges
[0m20:00:02.969895 [debug] [Thread-2 (]: Began running node model.home_exchange.base_bigquery_subscriptions
[0m20:00:02.971206 [info ] [Thread-1 (]: 1 of 5 START sql view model home_exchange.base_bigquery_exchanges .............. [RUN]
[0m20:00:02.973981 [info ] [Thread-2 (]: 2 of 5 START sql view model home_exchange.base_bigquery_subscriptions .......... [RUN]
[0m20:00:02.976004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.base_bigquery_exchanges)
[0m20:00:02.977510 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.home_exchange.base_bigquery_subscriptions'
[0m20:00:02.978741 [debug] [Thread-1 (]: Began compiling node model.home_exchange.base_bigquery_exchanges
[0m20:00:02.981295 [debug] [Thread-2 (]: Began compiling node model.home_exchange.base_bigquery_subscriptions
[0m20:00:03.116848 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_subscriptions"
[0m20:00:03.121079 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.base_bigquery_exchanges"
[0m20:00:03.127203 [debug] [Thread-1 (]: Began executing node model.home_exchange.base_bigquery_exchanges
[0m20:00:03.130633 [debug] [Thread-2 (]: Began executing node model.home_exchange.base_bigquery_subscriptions
[0m20:00:03.360187 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_subscriptions"
[0m20:00:03.369727 [debug] [Thread-2 (]: On model.home_exchange.base_bigquery_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_subscriptions"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`subscriptions`
),
renamed as (
    select
        `subscription_date`,
        `user_id`,
        `renew`,
        `first_subscription_date`,
        `first_subscription`,
        `referral`,
        `promotion`,
        `payment3x`,
        `payment2`,
        `payment3`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m20:00:03.371669 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:00:03.358706 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.base_bigquery_exchanges"
[0m20:00:03.466655 [debug] [Thread-1 (]: On model.home_exchange.base_bigquery_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.base_bigquery_exchanges"} */


  create or replace view `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
  OPTIONS()
  as with source as (
      select * from `mywagon-445720`.`home_exchange`.`exchanges`
),
renamed as (
    select
        `conversation_id`,
        `exchange_id`,
        `created_at`,
        `creator_id`,
        `guest_user_id`,
        `host_user_id`,
        `finalized_at`,
        `canceled_at`,
        `start_on`,
        `end_on`,
        `guest_countguest_count`,
        `night_count`,
        `user_cancellation_id`,
        `exchange_type`,
        `home_type`,
        `residence_type`,
        `capacity`,
        `country`,
        `region`,
        `department`,
        `city`

    from source
)
select * from renamed;


[0m20:00:03.469203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:04.484089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:9b0e18e5-1d46-4855-856e-7254421a66a6&page=queryresults
[0m20:00:04.640950 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:a2601b1d-5bf7-4fc0-bffe-4df7f4f202a3&page=queryresults
[0m20:00:05.476911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490927d7b0>]}
[0m20:00:05.478632 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490927d6c0>]}
[0m20:00:05.483150 [info ] [Thread-1 (]: 1 of 5 OK created sql view model home_exchange.base_bigquery_exchanges ......... [[32mCREATE VIEW (0 processed)[0m in 2.50s]
[0m20:00:05.487320 [info ] [Thread-2 (]: 2 of 5 OK created sql view model home_exchange.base_bigquery_subscriptions ..... [[32mCREATE VIEW (0 processed)[0m in 2.50s]
[0m20:00:05.494203 [debug] [Thread-1 (]: Finished running node model.home_exchange.base_bigquery_exchanges
[0m20:00:05.497628 [debug] [Thread-2 (]: Finished running node model.home_exchange.base_bigquery_subscriptions
[0m20:00:05.506527 [debug] [Thread-1 (]: Began running node model.home_exchange.exchanges_cleaning
[0m20:00:05.510945 [debug] [Thread-2 (]: Began running node model.home_exchange.stg_exchanges
[0m20:00:05.509676 [info ] [Thread-1 (]: 3 of 5 START sql table model home_exchange.exchanges_cleaning .................. [RUN]
[0m20:00:05.514086 [info ] [Thread-2 (]: 4 of 5 START sql table model home_exchange.stg_exchanges ....................... [RUN]
[0m20:00:05.516617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_exchanges, now model.home_exchange.exchanges_cleaning)
[0m20:00:05.528917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.home_exchange.base_bigquery_subscriptions, now model.home_exchange.stg_exchanges)
[0m20:00:05.531753 [debug] [Thread-1 (]: Began compiling node model.home_exchange.exchanges_cleaning
[0m20:00:05.540388 [debug] [Thread-2 (]: Began compiling node model.home_exchange.stg_exchanges
[0m20:00:05.609069 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.exchanges_cleaning"
[0m20:00:05.615237 [debug] [Thread-1 (]: Began executing node model.home_exchange.exchanges_cleaning
[0m20:00:05.633368 [debug] [Thread-2 (]: Writing injected SQL for node "model.home_exchange.stg_exchanges"
[0m20:00:05.675681 [debug] [Thread-2 (]: Began executing node model.home_exchange.stg_exchanges
[0m20:00:05.731733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:05.839606 [debug] [Thread-2 (]: Writing runtime sql for node "model.home_exchange.stg_exchanges"
[0m20:00:05.843422 [debug] [Thread-2 (]: On model.home_exchange.stg_exchanges: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.stg_exchanges"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`stg_exchanges`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,
        guest_countguest_count AS guest_count,

        -- -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
)
SELECT * FROM cleaned_exchanges
    );
  
[0m20:00:05.844705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:00:06.371860 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.exchanges_cleaning"
[0m20:00:06.374515 [debug] [Thread-1 (]: On model.home_exchange.exchanges_cleaning: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.exchanges_cleaning"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`exchanges_cleaning`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,
        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,
        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,
        guest_countguest_count AS guest_count,

        -- -- Preserve other columns
        * EXCEPT(created_at, start_on, end_on, guest_countguest_count)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`
)

-- -- Conversation count analysis
-- conversation_counts AS (
--     SELECT
--         conversation_id,
--         COUNT(*) AS conversation_count
--     FROM cleaned_exchanges
--     GROUP BY conversation_id
-- ),

-- -- Advanced filtering
-- filtered_exchanges AS (
--     SELECT e.*
--     FROM cleaned_exchanges e
--     LEFT JOIN conversation_counts cc
--         ON e.conversation_id = cc.conversation_id
--     WHERE
--         -- Cancellation logic
--         NOT (
--             (e.canceled_at IS NOT NULL AND e.user_cancellation_id IS NULL) OR
--             (e.canceled_at IS NULL AND e.user_cancellation_id IS NOT NULL) OR
--             (e.finalized_at IS NULL AND e.canceled_at IS NOT NULL)
--         )

--         -- Date range validation
--         AND e.start_on < e.end_on

--         -- Conversation filtering
--         AND NOT (
--             (cc.conversation_count = 3) OR
--             (cc.conversation_count = 2 AND e.exchange_type = 'NON_RECIPROCAL') OR
--             (cc.conversation_count = 1 AND e.exchange_type = 'RECIPROCAL')
--         )
-- ),

-- -- Final transformations
-- final_exchanges AS (
--     SELECT
--         *,
--         -- Night count calculation
--         DATE_DIFF(end_on, start_on, DAY) AS calculated_night_count,

--         -- Optional: Validate existing night_count
--         CASE
--             WHEN night_count != DATE_DIFF(end_on, start_on, DAY)
--             THEN DATE_DIFF(end_on, start_on, DAY)
--             ELSE night_count
--         END AS corrected_night_count

--     FROM filtered_exchanges
-- )

SELECT * FROM cleaned_exchanges
    );
  
[0m20:00:06.841030 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:d2b9eb40-7f39-4c9b-b862-5e6625be2362&page=queryresults
[0m20:00:07.102422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:3a734415-8835-4a95-a2f2-1298323ee4ed&page=queryresults
[0m20:00:16.283658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4902347520>]}
[0m20:00:16.285963 [info ] [Thread-1 (]: 3 of 5 OK created sql table model home_exchange.exchanges_cleaning ............. [[32mCREATE TABLE (12.0m rows, 1.8 GiB processed)[0m in 10.77s]
[0m20:00:16.290939 [debug] [Thread-1 (]: Finished running node model.home_exchange.exchanges_cleaning
[0m20:00:16.294976 [debug] [Thread-1 (]: Began running node model.home_exchange.stg_subsciptions
[0m20:00:16.298220 [info ] [Thread-1 (]: 5 of 5 START sql table model home_exchange.stg_subsciptions .................... [RUN]
[0m20:00:16.300402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.home_exchange.exchanges_cleaning, now model.home_exchange.stg_subsciptions)
[0m20:00:16.302201 [debug] [Thread-1 (]: Began compiling node model.home_exchange.stg_subsciptions
[0m20:00:16.323233 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.stg_subsciptions"
[0m20:00:16.332089 [debug] [Thread-1 (]: Began executing node model.home_exchange.stg_subsciptions
[0m20:00:16.344832 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.stg_subsciptions"
[0m20:00:16.347371 [debug] [Thread-1 (]: On model.home_exchange.stg_subsciptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.stg_subsciptions"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`stg_subsciptions`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned_exchanges AS (
    SELECT
        -- Correct date parsing
        first_subscription_date = STR_TO_DATE(first_subscription_date, '%Y-%m-%d'),
        subscription_date = STR_TO_DATE(subscription_date, '%Y-%m-%d'),
        MODIFY COLUMN user_id VARCHAR(255),
        -- -- Preserve other columns
        * EXCEPT(first_subscription_date, subscription_date, user_id)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
)
SELECT * FROM cleaned_exchanges
    );
  
[0m20:00:16.348667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:17.071670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:ce44a107-1a3f-4264-971b-eb3f34dd5f10&page=queryresults
[0m20:00:17.072808 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:ce44a107-1a3f-4264-971b-eb3f34dd5f10&page=queryresults
[0m20:00:17.078910 [debug] [Thread-1 (]: Database Error in model stg_subsciptions (models/staging/stg_subsciptions.sql)
  Syntax error: Expected ")" but got identifier "user_id" at [20:23]
  compiled code at target/run/home_exchange/models/staging/stg_subsciptions.sql
[0m20:00:17.080410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49023f9ff0>]}
[0m20:00:17.081702 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model home_exchange.stg_subsciptions ........... [[31mERROR[0m in 0.78s]
[0m20:00:17.083211 [debug] [Thread-1 (]: Finished running node model.home_exchange.stg_subsciptions
[0m20:00:17.084563 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.stg_subsciptions' to be skipped because of status 'error'.  Reason: Database Error in model stg_subsciptions (models/staging/stg_subsciptions.sql)
  Syntax error: Expected ")" but got identifier "user_id" at [20:23]
  compiled code at target/run/home_exchange/models/staging/stg_subsciptions.sql.
[0m20:00:17.506399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a093f-d8ff-4a96-9c3b-2074a808387a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49023dbd60>]}
[0m20:00:17.507815 [info ] [Thread-2 (]: 4 of 5 OK created sql table model home_exchange.stg_exchanges .................. [[32mCREATE TABLE (12.0m rows, 1.8 GiB processed)[0m in 11.98s]
[0m20:00:17.509504 [debug] [Thread-2 (]: Finished running node model.home_exchange.stg_exchanges
[0m20:00:17.513679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:00:17.517105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:17.517993 [debug] [MainThread]: Connection 'model.home_exchange.stg_subsciptions' was properly closed.
[0m20:00:17.519314 [debug] [MainThread]: Connection 'model.home_exchange.stg_exchanges' was properly closed.
[0m20:00:17.523585 [info ] [MainThread]: 
[0m20:00:17.525219 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 16.02 seconds (16.02s).
[0m20:00:17.528985 [debug] [MainThread]: Command end result
[0m20:00:17.620590 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:00:17.623707 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:00:17.639244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m20:00:17.641615 [info ] [MainThread]: 
[0m20:00:17.642789 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:00:17.643719 [info ] [MainThread]: 
[0m20:00:17.644825 [error] [MainThread]:   Database Error in model stg_subsciptions (models/staging/stg_subsciptions.sql)
  Syntax error: Expected ")" but got identifier "user_id" at [20:23]
  compiled code at target/run/home_exchange/models/staging/stg_subsciptions.sql
[0m20:00:17.645674 [info ] [MainThread]: 
[0m20:00:17.647069 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:00:17.649126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.069021, "process_in_blocks": "0", "process_kernel_time": 0.560684, "process_mem_max_rss": "219252", "process_out_blocks": "2264", "process_user_time": 7.584535}
[0m20:00:17.650127 [debug] [MainThread]: Command `dbt run` failed at 20:00:17.649881 after 19.07 seconds
[0m20:00:17.650926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49243fb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4909277bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4924091570>]}
[0m20:00:17.652184 [debug] [MainThread]: Flushing usage events
[0m20:00:18.565549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:49.142583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91258d3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9126582650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91265826b0>]}


============================== 20:02:49.147640 | 16b2fb14-9ded-4429-9842-f121db67ed3e ==============================
[0m20:02:49.147640 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:02:49.149154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_subscriptions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:02:50.633486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b2fb14-9ded-4429-9842-f121db67ed3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f910ac44730>]}
[0m20:02:50.773345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b2fb14-9ded-4429-9842-f121db67ed3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f910abd64d0>]}
[0m20:02:50.774686 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:02:51.083086 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:02:51.457551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:02:51.458304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:02:51.599195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16b2fb14-9ded-4429-9842-f121db67ed3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f910a734130>]}
[0m20:02:51.827640 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:02:51.833103 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:02:51.858024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16b2fb14-9ded-4429-9842-f121db67ed3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f910a73bca0>]}
[0m20:02:51.859159 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 489 macros
[0m20:02:51.860285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b2fb14-9ded-4429-9842-f121db67ed3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f910a739480>]}
[0m20:02:51.862693 [warn ] [MainThread]: The selection criterion 'stg_subscriptions' does not match any enabled nodes
[0m20:02:51.865363 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:02:51.871375 [debug] [MainThread]: Command end result
[0m20:02:51.956369 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:02:51.959162 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:02:51.966208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m20:02:51.968374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9402757, "process_in_blocks": "0", "process_kernel_time": 0.320441, "process_mem_max_rss": "207320", "process_out_blocks": "2128", "process_user_time": 5.457521}
[0m20:02:51.969456 [debug] [MainThread]: Command `dbt run` succeeded at 20:02:51.969122 after 2.94 seconds
[0m20:02:51.970367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91258d3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912554be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f910a6f4340>]}
[0m20:02:51.972251 [debug] [MainThread]: Flushing usage events
[0m20:02:52.721256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:03.264028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc29f1b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc29362110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc29361120>]}


============================== 20:05:03.268975 | 66b5e078-0581-4349-9945-0415a104db6b ==============================
[0m20:05:03.268975 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:05:03.270519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_subscriptions', 'send_anonymous_usage_stats': 'True'}
[0m20:05:04.741626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66b5e078-0581-4349-9945-0415a104db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2ae8b3a0>]}
[0m20:05:04.870603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66b5e078-0581-4349-9945-0415a104db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0f4e9b40>]}
[0m20:05:04.871825 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:05:05.173831 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:05:05.552574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:05:05.553336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:05:05.681273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66b5e078-0581-4349-9945-0415a104db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0f050130>]}
[0m20:05:05.943734 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:05:05.949290 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:05:05.976767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66b5e078-0581-4349-9945-0415a104db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0f057df0>]}
[0m20:05:05.978160 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 489 macros
[0m20:05:05.979640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b5e078-0581-4349-9945-0415a104db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0f057910>]}
[0m20:05:05.982714 [info ] [MainThread]: 
[0m20:05:05.983743 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m20:05:05.984784 [info ] [MainThread]: 
[0m20:05:05.986200 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:05.988337 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m20:05:05.989485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:06.824703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m20:05:06.826236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:07.460583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b5e078-0581-4349-9945-0415a104db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2a46cd30>]}
[0m20:05:07.461640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:07.467519 [debug] [Thread-1 (]: Began running node model.home_exchange.stg_subscriptions
[0m20:05:07.468911 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.stg_subscriptions ................... [RUN]
[0m20:05:07.470573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.stg_subscriptions)
[0m20:05:07.471643 [debug] [Thread-1 (]: Began compiling node model.home_exchange.stg_subscriptions
[0m20:05:07.503831 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.stg_subscriptions"
[0m20:05:07.505111 [debug] [Thread-1 (]: Began executing node model.home_exchange.stg_subscriptions
[0m20:05:07.607837 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.stg_subscriptions"
[0m20:05:07.609441 [debug] [Thread-1 (]: On model.home_exchange.stg_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.stg_subscriptions"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`stg_subscriptions`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned AS (
    SELECT
        -- Correct date parsing
        first_subscription_date = STR_TO_DATE(first_subscription_date, '%Y-%m-%d'),
        subscription_date = STR_TO_DATE(subscription_date, '%Y-%m-%d'),
        CAST(user_id AS VARCHAR) AS user_id,
        -- -- Preserve other columns
        * EXCEPT(first_subscription_date, subscription_date, user_id)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
)
SELECT * FROM cleaned
    );
  
[0m20:05:07.610489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:08.813387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:de9aa622-5b49-4e78-8827-6d1000bd3e1a&page=queryresults
[0m20:05:08.982681 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:de9aa622-5b49-4e78-8827-6d1000bd3e1a&page=queryresults
[0m20:05:08.988312 [debug] [Thread-1 (]: Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Function not found: STR_TO_DATE at [18:35]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql
[0m20:05:08.992760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b5e078-0581-4349-9945-0415a104db6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2a0eefb0>]}
[0m20:05:08.994220 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.stg_subscriptions .......... [[31mERROR[0m in 1.52s]
[0m20:05:08.996985 [debug] [Thread-1 (]: Finished running node model.home_exchange.stg_subscriptions
[0m20:05:08.998507 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.stg_subscriptions' to be skipped because of status 'error'.  Reason: Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Function not found: STR_TO_DATE at [18:35]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql.
[0m20:05:09.002520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:05:09.007324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:05:09.014147 [debug] [MainThread]: Connection 'model.home_exchange.stg_subscriptions' was properly closed.
[0m20:05:09.016110 [info ] [MainThread]: 
[0m20:05:09.018334 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m20:05:09.020613 [debug] [MainThread]: Command end result
[0m20:05:09.118048 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:05:09.121075 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:05:09.133854 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m20:05:09.134653 [info ] [MainThread]: 
[0m20:05:09.136318 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:05:09.138636 [info ] [MainThread]: 
[0m20:05:09.139943 [error] [MainThread]:   Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Function not found: STR_TO_DATE at [18:35]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql
[0m20:05:09.140842 [info ] [MainThread]: 
[0m20:05:09.141866 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:05:09.143695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.992247, "process_in_blocks": "0", "process_kernel_time": 0.301696, "process_mem_max_rss": "210320", "process_out_blocks": "2160", "process_user_time": 5.852902}
[0m20:05:09.144713 [debug] [MainThread]: Command `dbt run` failed at 20:05:09.144419 after 5.99 seconds
[0m20:05:09.146054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc29f1b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc0f010a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc29e6fd90>]}
[0m20:05:09.147250 [debug] [MainThread]: Flushing usage events
[0m20:05:09.943027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:28.160833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29432ff670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2942382650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29423826b0>]}


============================== 20:06:28.165314 | c62b342f-07d8-4e5c-a6d7-73c0e926e35d ==============================
[0m20:06:28.165314 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:06:28.166774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'profiles_dir': '/root/home_exchange/home_exchange', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_subscriptions', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:06:29.576342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62b342f-07d8-4e5c-a6d7-73c0e926e35d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c808c10>]}
[0m20:06:29.705874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62b342f-07d8-4e5c-a6d7-73c0e926e35d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c915ba0>]}
[0m20:06:29.707820 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:06:30.036680 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:06:30.403341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:06:30.404124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:06:30.528505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62b342f-07d8-4e5c-a6d7-73c0e926e35d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c474130>]}
[0m20:06:30.782076 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:06:30.787342 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:06:30.809450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62b342f-07d8-4e5c-a6d7-73c0e926e35d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c293e80>]}
[0m20:06:30.810556 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 489 macros
[0m20:06:30.811509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62b342f-07d8-4e5c-a6d7-73c0e926e35d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c292950>]}
[0m20:06:30.814695 [info ] [MainThread]: 
[0m20:06:30.816004 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m20:06:30.817784 [info ] [MainThread]: 
[0m20:06:30.821824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:06:30.824706 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m20:06:30.825875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:06:31.475710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m20:06:31.477008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:06:32.048664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62b342f-07d8-4e5c-a6d7-73c0e926e35d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c292b00>]}
[0m20:06:32.049687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:32.055126 [debug] [Thread-1 (]: Began running node model.home_exchange.stg_subscriptions
[0m20:06:32.056901 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.stg_subscriptions ................... [RUN]
[0m20:06:32.059870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.stg_subscriptions)
[0m20:06:32.060792 [debug] [Thread-1 (]: Began compiling node model.home_exchange.stg_subscriptions
[0m20:06:32.089900 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.stg_subscriptions"
[0m20:06:32.092243 [debug] [Thread-1 (]: Began executing node model.home_exchange.stg_subscriptions
[0m20:06:32.201682 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.stg_subscriptions"
[0m20:06:32.203092 [debug] [Thread-1 (]: On model.home_exchange.stg_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.stg_subscriptions"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`stg_subscriptions`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(first_subscription_date AS STRING)) AS first_subscription_date,
        PARSE_DATE('%Y-%m-%d', CAST(subscription_date AS STRING)) AS subscription_date,

        CAST(user_id AS VARCHAR) AS user_id,
        -- -- Preserve other columns
        * EXCEPT(first_subscription_date, subscription_date, user_id)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
)
SELECT * FROM cleaned
    );
  
[0m20:06:32.204251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:33.385994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8308c42b-dc1b-4df5-9b2f-fb2ed8145ac7&page=queryresults
[0m20:06:33.559113 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:8308c42b-dc1b-4df5-9b2f-fb2ed8145ac7&page=queryresults
[0m20:06:33.565814 [debug] [Thread-1 (]: Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Type not found: VARCHAR at [21:25]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql
[0m20:06:33.570689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62b342f-07d8-4e5c-a6d7-73c0e926e35d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29434cc340>]}
[0m20:06:33.572034 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.stg_subscriptions .......... [[31mERROR[0m in 1.51s]
[0m20:06:33.573914 [debug] [Thread-1 (]: Finished running node model.home_exchange.stg_subscriptions
[0m20:06:33.575245 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.stg_subscriptions' to be skipped because of status 'error'.  Reason: Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Type not found: VARCHAR at [21:25]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql.
[0m20:06:33.579867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:33.586359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:33.588684 [debug] [MainThread]: Connection 'model.home_exchange.stg_subscriptions' was properly closed.
[0m20:06:33.589654 [info ] [MainThread]: 
[0m20:06:33.590655 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m20:06:33.592275 [debug] [MainThread]: Command end result
[0m20:06:33.692013 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:06:33.697729 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:06:33.713179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m20:06:33.716485 [info ] [MainThread]: 
[0m20:06:33.718730 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:06:33.721476 [info ] [MainThread]: 
[0m20:06:33.722776 [error] [MainThread]:   Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Type not found: VARCHAR at [21:25]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql
[0m20:06:33.724124 [info ] [MainThread]: 
[0m20:06:33.725493 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:06:33.727402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6845064, "process_in_blocks": "0", "process_kernel_time": 0.398149, "process_mem_max_rss": "210768", "process_out_blocks": "2152", "process_user_time": 5.70349}
[0m20:06:33.728704 [debug] [MainThread]: Command `dbt run` failed at 20:06:33.728435 after 5.69 seconds
[0m20:06:33.730352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29432ff670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2943268130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292c282200>]}
[0m20:06:33.732982 [debug] [MainThread]: Flushing usage events
[0m20:06:34.638138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:09.005997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d60935e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d51126b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d5112710>]}


============================== 20:07:09.010804 | 7d9e09e9-7159-498d-a166-45371ba8e331 ==============================
[0m20:07:09.010804 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:07:09.012313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/home_exchange/home_exchange', 'log_path': '/root/home_exchange/home_exchange/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_subscriptions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:07:10.464446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d9e09e9-7159-498d-a166-45371ba8e331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb6d4b50>]}
[0m20:07:10.600352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d9e09e9-7159-498d-a166-45371ba8e331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d54ccee0>]}
[0m20:07:10.601573 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:07:10.910412 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:07:11.283211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:11.283980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:11.408719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d9e09e9-7159-498d-a166-45371ba8e331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb1cc130>]}
[0m20:07:11.707901 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:07:11.715078 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:07:11.744324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d9e09e9-7159-498d-a166-45371ba8e331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb1e5390>]}
[0m20:07:11.745859 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 489 macros
[0m20:07:11.748343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9e09e9-7159-498d-a166-45371ba8e331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb1e4b80>]}
[0m20:07:11.751839 [info ] [MainThread]: 
[0m20:07:11.752966 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m20:07:11.754072 [info ] [MainThread]: 
[0m20:07:11.756114 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:07:11.762797 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m20:07:11.764296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:12.552879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m20:07:12.554094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:13.158944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9e09e9-7159-498d-a166-45371ba8e331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d72147c0>]}
[0m20:07:13.160124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:13.165794 [debug] [Thread-1 (]: Began running node model.home_exchange.stg_subscriptions
[0m20:07:13.167357 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.stg_subscriptions ................... [RUN]
[0m20:07:13.169024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.stg_subscriptions)
[0m20:07:13.170303 [debug] [Thread-1 (]: Began compiling node model.home_exchange.stg_subscriptions
[0m20:07:13.190916 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.stg_subscriptions"
[0m20:07:13.192378 [debug] [Thread-1 (]: Began executing node model.home_exchange.stg_subscriptions
[0m20:07:13.339455 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.stg_subscriptions"
[0m20:07:13.341651 [debug] [Thread-1 (]: On model.home_exchange.stg_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.stg_subscriptions"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`stg_subscriptions`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(first_subscription_date AS STRING)) AS first_subscription_date,
        PARSE_DATE('%Y-%m-%d', CAST(subscription_date AS STRING)) AS subscription_date,

        CAST(user_id AS TEXT) AS user_id,
        -- -- Preserve other columns
        * EXCEPT(first_subscription_date, subscription_date, user_id)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
)
SELECT * FROM cleaned
    );
  
[0m20:07:13.342846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:14.586958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:deccf140-b0b3-4ddd-97c6-80e80f91f836&page=queryresults
[0m20:07:14.760123 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:deccf140-b0b3-4ddd-97c6-80e80f91f836&page=queryresults
[0m20:07:14.766428 [debug] [Thread-1 (]: Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Type not found: TEXT at [21:25]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql
[0m20:07:14.773473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9e09e9-7159-498d-a166-45371ba8e331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb1e5360>]}
[0m20:07:14.775476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model home_exchange.stg_subscriptions .......... [[31mERROR[0m in 1.60s]
[0m20:07:14.778155 [debug] [Thread-1 (]: Finished running node model.home_exchange.stg_subscriptions
[0m20:07:14.780376 [debug] [Thread-5 (]: Marking all children of 'model.home_exchange.stg_subscriptions' to be skipped because of status 'error'.  Reason: Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Type not found: TEXT at [21:25]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql.
[0m20:07:14.785334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:14.795468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:14.798318 [debug] [MainThread]: Connection 'model.home_exchange.stg_subscriptions' was properly closed.
[0m20:07:14.800127 [info ] [MainThread]: 
[0m20:07:14.801360 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m20:07:14.806214 [debug] [MainThread]: Command end result
[0m20:07:14.909995 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:07:14.912865 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:07:14.927946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m20:07:14.928830 [info ] [MainThread]: 
[0m20:07:14.929983 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:07:14.931003 [info ] [MainThread]: 
[0m20:07:14.932093 [error] [MainThread]:   Database Error in model stg_subscriptions (models/staging/stg_subscriptions.sql)
  Type not found: TEXT at [21:25]
  compiled code at target/run/home_exchange/models/staging/stg_subscriptions.sql
[0m20:07:14.933175 [info ] [MainThread]: 
[0m20:07:14.934802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:07:14.943444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.05315, "process_in_blocks": "0", "process_kernel_time": 0.319026, "process_mem_max_rss": "210680", "process_out_blocks": "2160", "process_user_time": 5.95184}
[0m20:07:14.945879 [debug] [MainThread]: Command `dbt run` failed at 20:07:14.944281 after 6.06 seconds
[0m20:07:14.948212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1d60935e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb6d4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb184100>]}
[0m20:07:14.949502 [debug] [MainThread]: Flushing usage events
[0m20:07:15.602897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:04.259938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d013640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1c351c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1c3510f0>]}


============================== 20:08:04.264318 | 6b9e458c-db12-4a18-80b5-a93851144850 ==============================
[0m20:08:04.264318 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:08:04.266121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/home_exchange/home_exchange', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/home_exchange/home_exchange/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_subscriptions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:08:05.764350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b9e458c-db12-4a18-80b5-a93851144850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cc942b0>]}
[0m20:08:06.036723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b9e458c-db12-4a18-80b5-a93851144850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1c350490>]}
[0m20:08:06.038352 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m20:08:06.330424 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:08:06.712945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:08:06.713747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:08:06.826387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b9e458c-db12-4a18-80b5-a93851144850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d01e90130>]}
[0m20:08:07.072108 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:08:07.077581 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:08:07.098652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b9e458c-db12-4a18-80b5-a93851144850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d01e95330>]}
[0m20:08:07.099825 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 489 macros
[0m20:08:07.101228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b9e458c-db12-4a18-80b5-a93851144850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d01e94c70>]}
[0m20:08:07.104291 [info ] [MainThread]: 
[0m20:08:07.105422 [info ] [MainThread]: Concurrency: 2 threads (target='bigquery')
[0m20:08:07.106307 [info ] [MainThread]: 
[0m20:08:07.107819 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:08:07.109824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_mywagon-445720'
[0m20:08:07.111005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:07.808122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mywagon-445720, now list_mywagon-445720_home_exchange)
[0m20:08:07.809303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:08.429636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b9e458c-db12-4a18-80b5-a93851144850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1dc7d810>]}
[0m20:08:08.430639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:08.436815 [debug] [Thread-1 (]: Began running node model.home_exchange.stg_subscriptions
[0m20:08:08.438621 [info ] [Thread-1 (]: 1 of 1 START sql table model home_exchange.stg_subscriptions ................... [RUN]
[0m20:08:08.440175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_mywagon-445720_home_exchange, now model.home_exchange.stg_subscriptions)
[0m20:08:08.441426 [debug] [Thread-1 (]: Began compiling node model.home_exchange.stg_subscriptions
[0m20:08:08.471635 [debug] [Thread-1 (]: Writing injected SQL for node "model.home_exchange.stg_subscriptions"
[0m20:08:08.474345 [debug] [Thread-1 (]: Began executing node model.home_exchange.stg_subscriptions
[0m20:08:08.580839 [debug] [Thread-1 (]: Writing runtime sql for node "model.home_exchange.stg_subscriptions"
[0m20:08:08.584675 [debug] [Thread-1 (]: On model.home_exchange.stg_subscriptions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "home_exchange", "target_name": "bigquery", "node_id": "model.home_exchange.stg_subscriptions"} */

  
    

    create or replace table `mywagon-445720`.`home_exchange`.`stg_subscriptions`
      
    
    

    OPTIONS()
    as (
      

WITH cleaned AS (
    SELECT
        -- Correct date parsing
        PARSE_DATE('%Y-%m-%d', CAST(first_subscription_date AS STRING)) AS first_subscription_date,
        PARSE_DATE('%Y-%m-%d', CAST(subscription_date AS STRING)) AS subscription_date,

        CAST(user_id AS STRING) AS user_id,
        -- -- Preserve other columns
        * EXCEPT(first_subscription_date, subscription_date, user_id)

    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`
)
SELECT * FROM cleaned
    );
  
[0m20:08:08.586599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:08:09.683663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=mywagon-445720&j=bq:EU:5b694963-e445-427d-9b66-dc00fbb65d28&page=queryresults
[0m20:08:14.123435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b9e458c-db12-4a18-80b5-a93851144850', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d0231d750>]}
[0m20:08:14.125480 [info ] [Thread-1 (]: 1 of 1 OK created sql table model home_exchange.stg_subscriptions .............. [[32mCREATE TABLE (100.0k rows, 11.4 MiB processed)[0m in 5.68s]
[0m20:08:14.129836 [debug] [Thread-1 (]: Finished running node model.home_exchange.stg_subscriptions
[0m20:08:14.133267 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:14.144000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:14.145291 [debug] [MainThread]: Connection 'model.home_exchange.stg_subscriptions' was properly closed.
[0m20:08:14.146493 [info ] [MainThread]: 
[0m20:08:14.147866 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.04 seconds (7.04s).
[0m20:08:14.149743 [debug] [MainThread]: Command end result
[0m20:08:14.285777 [debug] [MainThread]: Wrote artifact WritableManifest to /root/home_exchange/home_exchange/target/manifest.json
[0m20:08:14.296065 [debug] [MainThread]: Wrote artifact SemanticManifest to /root/home_exchange/home_exchange/target/semantic_manifest.json
[0m20:08:14.314508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /root/home_exchange/home_exchange/target/run_results.json
[0m20:08:14.316295 [info ] [MainThread]: 
[0m20:08:14.318017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:14.319482 [info ] [MainThread]: 
[0m20:08:14.320945 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:08:14.323876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.183684, "process_in_blocks": "0", "process_kernel_time": 0.318978, "process_mem_max_rss": "215772", "process_out_blocks": "2152", "process_user_time": 6.080531}
[0m20:08:14.327304 [debug] [MainThread]: Command `dbt run` succeeded at 20:08:14.325560 after 10.19 seconds
[0m20:08:14.330756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d013640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d01e48280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cc942b0>]}
[0m20:08:14.332833 [debug] [MainThread]: Flushing usage events
[0m20:08:15.204062 [debug] [MainThread]: An error was encountered while trying to flush usage events
