{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2025-01-14T20:34:11.572081Z", "invocation_id": "c656e3ed-d462-48d7-98ed-a17faa27a9e8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-14T20:34:05.681791Z", "completed_at": "2025-01-14T20:34:05.783269Z"}, {"name": "execute", "started_at": "2025-01-14T20:34:05.784939Z", "completed_at": "2025-01-14T20:34:07.881811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.218308925628662, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "mywagon-445720", "job_id": "e3c53f66-c80b-4c46-912e-a4e201e0c2f7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.home_exchange.base_bigquery_exchanges", "compiled": true, "compiled_code": "with source as (\n      select * from `mywagon-445720`.`home_exchange`.`exchanges`\n),\nrenamed as (\n    select\n        `conversation_id`,\n        `exchange_id`,\n        `created_at`,\n        `creator_id`,\n        `guest_user_id`,\n        `host_user_id`,\n        `finalized_at`,\n        `canceled_at`,\n        `start_on`,\n        `end_on`,\n        `guest_countguest_count`,\n        `night_count`,\n        `user_cancellation_id`,\n        `exchange_type`,\n        `home_type`,\n        `residence_type`,\n        `capacity`,\n        `country`,\n        `region`,\n        `department`,\n        `city`\n\n    from source\n)\nselect * from renamed", "relation_name": "`mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-14T20:34:05.711458Z", "completed_at": "2025-01-14T20:34:05.795705Z"}, {"name": "execute", "started_at": "2025-01-14T20:34:05.802768Z", "completed_at": "2025-01-14T20:34:07.880547Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.224172592163086, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "mywagon-445720", "job_id": "8f6ba25a-f6b0-4236-89d9-ce28830168ee", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.home_exchange.base_bigquery_subscriptions", "compiled": true, "compiled_code": "with source as (\n      select * from `mywagon-445720`.`home_exchange`.`subscriptions`\n),\nrenamed as (\n    select\n        `subscription_date`,\n        `user_id`,\n        `renew`,\n        `first_subscription_date`,\n        `first_subscription`,\n        `referral`,\n        `promotion`,\n        `payment3x`,\n        `payment2`,\n        `payment3`,\n        `country`,\n        `region`,\n        `department`,\n        `city`\n\n    from source\n)\nselect * from renamed", "relation_name": "`mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-14T20:34:07.984309Z", "completed_at": "2025-01-14T20:34:08.010629Z"}, {"name": "execute", "started_at": "2025-01-14T20:34:08.115580Z", "completed_at": "2025-01-14T20:34:09.767710Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.8028616905212402, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "mywagon-445720", "job_id": "eead27b5-7bf8-4b8f-96bb-33d31ceebc6e", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.home_exchange.stg_subscriptions", "compiled": true, "compiled_code": "WITH cleaned AS (\n    SELECT\n        -- Correct date parsing\n        PARSE_DATE('%Y-%m-%d', CAST(first_subscription_date AS STRING)) AS first_subscription_date,\n        PARSE_DATE('%Y-%m-%d', CAST(subscription_date AS STRING)) AS subscription_date,\n        country AS sub_country,\n        region AS sub_region,\n        department AS sub_department,\n        city AS sub_city,\n        -- -- Preserve other columns\n        * EXCEPT(first_subscription_date, subscription_date,country, region, department, city),\n        ROW_NUMBER() OVER (PARTITION BY user_id, subscription_date ) AS row_num\n\n    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_subscriptions`\n)\nSELECT *\nEXCEPT(row_num)\nFROM cleaned\nWHERE row_num = 1", "relation_name": "`mywagon-445720`.`home_exchange`.`stg_subscriptions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-14T20:34:07.932256Z", "completed_at": "2025-01-14T20:34:07.954168Z"}, {"name": "execute", "started_at": "2025-01-14T20:34:07.956438Z", "completed_at": "2025-01-14T20:34:09.810868Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.885376214981079, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "mywagon-445720", "job_id": "92c109eb-952c-4295-8ea4-cdb5450ee92d", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.home_exchange.stg_exchanges", "compiled": true, "compiled_code": "WITH cleaned_exchanges AS (\n    SELECT\n        -- Correct date parsing\n        PARSE_DATE('%Y-%m-%d', CAST(created_at AS STRING)) AS created_at,\n        PARSE_DATE('%Y-%m-%d', CAST(start_on AS STRING)) AS start_on,\n        PARSE_DATE('%Y-%m-%d', CAST(end_on AS STRING)) AS end_on,\n        guest_countguest_count AS guest_count,\n        country AS ex_country,\n        region AS ex_region,\n        department AS ex_department,\n        city AS ex_city,\n        -- -- Preserve othe\n\n        -- -- Preserve other columns\n        * EXCEPT(created_at, start_on, end_on, guest_countguest_count, country, region, department, city)\n\n    FROM `mywagon-445720`.`home_exchange`.`base_bigquery_exchanges`\n)\nSELECT * FROM cleaned_exchanges", "relation_name": "`mywagon-445720`.`home_exchange`.`stg_exchanges`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-14T20:34:09.790794Z", "completed_at": "2025-01-14T20:34:09.816938Z"}, {"name": "execute", "started_at": "2025-01-14T20:34:09.818790Z", "completed_at": "2025-01-14T20:34:11.492699Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7097585201263428, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "mywagon-445720", "job_id": "1798033a-6b7d-4b66-ba31-90ac49b96c5f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.home_exchange.monthy_sub", "compiled": true, "compiled_code": "\n\nSELECT\n\nDATE_TRUNC(subscription_date, MONTH) AS sub_month,\n*\n FROM `mywagon-445720`.`home_exchange`.`stg_subscriptions`\n WHERE subscription_date between '2019-01-01' and '2021-12-31'", "relation_name": "`mywagon-445720`.`home_exchange`.`monthy_sub`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-01-14T20:34:09.863932Z", "completed_at": "2025-01-14T20:34:09.963033Z"}, {"name": "execute", "started_at": "2025-01-14T20:34:09.964553Z", "completed_at": "2025-01-14T20:34:11.533023Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6887409687042236, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "mywagon-445720", "job_id": "803c698b-1e7b-4de8-8882-b978a1135c47", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.home_exchange.merged_tab", "compiled": true, "compiled_code": "with\nstg_exchanges as (\n    select * from `mywagon-445720`.`home_exchange`.`stg_exchanges`\n),\nstg_subscriptions as (\n    select * from `mywagon-445720`.`home_exchange`.`stg_subscriptions`\n)\nSELECT * FROM stg_exchanges\nleft join stg_subscriptions on stg_exchanges.creator_id = stg_subscriptions.user_id", "relation_name": "`mywagon-445720`.`home_exchange`.`merged_tab`", "batch_results": null}], "elapsed_time": 7.352831602096558, "args": {"skip_nodes_if_on_run_start_fails": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "project_dir": "/root/home_exchange/home_exchange", "log_path": "/root/home_exchange/home_exchange/logs", "partial_parse": true, "require_yaml_configuration_for_mf_time_spines": false, "select": [], "use_colors_file": true, "strict_mode": false, "profiles_dir": "/root/home_exchange/home_exchange", "exclude": [], "printer_width": 80, "indirect_selection": "eager", "cache_selected_only": false, "populate_cache": true, "log_level_file": "debug", "version_check": true, "partial_parse_file_diff": true, "static_parser": true, "vars": {}, "macro_debugging": false, "log_format_file": "debug", "log_level": "info", "send_anonymous_usage_stats": true, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "which": "run", "log_file_max_bytes": 10485760, "print": true, "require_nested_cumulative_type_params": false, "source_freshness_run_project_hooks": false, "state_modified_compare_vars": false, "favor_state": false, "introspect": true, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "invocation_command": "dbt run", "show_resource_report": false, "empty": false, "quiet": false}}